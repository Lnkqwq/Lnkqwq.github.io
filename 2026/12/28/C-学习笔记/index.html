<!DOCTYPE html><html lang="en" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>C++学习笔记 | Hexo</title><meta name="keywords" content="C++"><meta name="description" content="main函数 12345int main(int argc, char** argv, char** envp)#argc：命令行参数个数#argv：命令行参数字符串数组#envp：环境变量数组 一、情况 1234int main() &#123;    &#x2F;&#x2F; 无法获取命令行参数    &#x2F;&#x2F; 适用于不需要输入的程序&#125; 12345int main(int argc, char** arg">
<meta property="og:type" content="article">
<meta property="og:title" content="C++学习笔记">
<meta property="og:url" content="http://example.com/2026/12/28/C-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="main函数 12345int main(int argc, char** argv, char** envp)#argc：命令行参数个数#argv：命令行参数字符串数组#envp：环境变量数组 一、情况 1234int main() &#123;    &#x2F;&#x2F; 无法获取命令行参数    &#x2F;&#x2F; 适用于不需要输入的程序&#125; 12345int main(int argc, char** arg">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2026-12-28T07:44:07.000Z">
<meta property="article:modified_time" content="2026-03-01T11:59:14.350Z">
<meta property="article:author" content="Lnk">
<meta property="article:tag" content="C++">
<meta name="twitter:card" content="summary"><link rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="preload" as="font" crossorigin="anonymous" href="/font/Bender.ttf"><link rel="preload" as="font" crossorigin="anonymous" href="/font/BenderLight.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="/font/JetBrainsMono-Regular.woff2"><link rel="stylesheet" href="/css/arknights.css"><style>@font-face {
  font-family: Bender;
  src: local('Bender'), url("/font/Bender.ttf"), url("/font/Bender.otf");
}
@font-face {
  font-family: BenderLight;
  src: local('BenderLight'), url("/font/BenderLight.woff2") format('woff2');
}
@font-face {
  font-family: 'JetBrains Mono';
  src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}
</style><meta name="page-config" content="{&quot;code_fold&quot;:null}"><script class="pjax-js">var config = {"root":"/","code_fold":15,"search":{"preload":false,"activeHolder":"Enter here","blurHolder":"Search","noResult":"Data \"$0\" not found"},"code":{"codeInfo":"$0 - $1 lines","copy":"copy"}};
var page_config = {
  code_fold: null
};
function updatePageConfig() {
  var newPageConfig = document.querySelector('meta[name="page-config"]');
  if (newPageConfig) {
    page_config = JSON.parse(newPageConfig.content);
  }
}
document.addEventListener('pjax:complete', function() { updatePageConfig(); });
updatePageConfig();</script><link type="text/css" rel="stylesheet" href="/lib/encrypt/hbe.style.css"><script src="//unpkg.com/mermaid@11.12.2/dist/mermaid.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/MathJax.js"></script><script>MathJax.Hub.Config({
 menuSettings: {
   zoom: "None"
 },
 showMathMenu: false,
 jax: ["input/TeX","output/CommonHTML"],
 extensions: ["tex2jax.js"],
 TeX: {
   extensions: ["AMSmath.js","AMSsymbols.js"],
   equationNumbers: {
     autoNumber: "AMS"
   }
 },
 tex2jax: {
   inlineMath: [["\\(", "\\)"]],
   displayMath: [["\\[", "\\]"]]
 }
});</script><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/css/all.min.css"><script>if (window.localStorage.getItem('theme-mode') === 'light')
 document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark')
 document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.woff2") format('woff2');
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><style>:root {
 --dark-background: url('/images/BK.PNG');
 --light-background: url('/images/BK.PNG');
 --theme-encrypt-confirm: 'confirm'
}</style><script defer src="/js/arknights.js"></script><script defer src="/js/search.js"></script><script defer type="module">import mermaid from '//unpkg.com/mermaid@11.12.2/dist/mermaid.esm.min.mjs';
window.mermaid = mermaid;
code.paintMermaid();
</script><script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/MathJax.js"></script><script>MathJax.Hub.Config({
  menuSettings: {
    zoom: "None"
  },
  showMathMenu: false,
  jax: ["input/TeX","output/CommonHTML"],
  extensions: ["tex2jax.js"],
  TeX: {
    extensions: ["AMSmath.js","AMSsymbols.js"],
    equationNumbers: {
      autoNumber: "AMS"
    }
  },
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]]
  }
});
</script><script async src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script async src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script async src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script async src="/lib/encrypt/hbe.js"></script><script async src="/js/pjax.js"></script><script class="pjax-js">reset= () => {document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js','data-pjax','.vercount','meta[name=page-config]'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script><script class="pjax-js">reset= () => {window.giscusSettings = {
 repo: 'Lnkqwq/Lnkqwq.github.io',
 repoId: 'R_kgDORZSSAA',
 category: '',
 categoryId: '',
 mapping: 'pathname',
 strict: '0',
 reactionsEnabled: '1',
 emitMetadata: '0',
 inputPosition: 'bottom',
 lang: 'zh-CN',
 crossorigin: 'anonymous' , loading: 'lazy'};window.giscusThemeConfig = { theme: 'preferred_color_scheme' };MathJax.Hub.Queue(["Typeset", MathJax.Hub]);document.querySelector('.lg-container')?.remove()
const postBg = document.querySelector('#post-bg');
if (postBg) lightGallery(postBg, {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js','data-pjax','.vercount','meta[name=page-config]'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body><div class="loading" style="opacity: 0;"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><div class="navBtn"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><nav><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="Search" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup" tabindex="0"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li></ol></nav></header><article><div id="post-bg"><div id="post-title"><h1>C++学习笔记</h1><div id="post-info"><span>First Post: <div class="control"><time datetime="2026-12-28T07:44:07.000Z" id="date"> 2026-12-28</time></div></span><br><span>Last Update: <div class="control"><time datetime="2026-03-01T11:59:14.350Z" id="updated"> 2026-03-01</time></div></span></div></div><hr><div id="post-content"><h1 id="main函数"><a href="#main函数" class="headerlink" title="main函数"></a><a class="markdownIt-Anchor" href="#main函数"></a> main函数</h1>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">char</span>** argv, <span class="hljs-type">char</span>** envp)</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-meta">#argc：命令行参数个数</span></span><br><span class="hljs-function"><span class="hljs-meta">#argv：命令行参数字符串数组</span></span><br><span class="hljs-function"><span class="hljs-meta">#envp：环境变量数组</span></span><br></code></pre></td></tr></table></figure>
<p>一、情况</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-comment">// 无法获取命令行参数</span><br>    <span class="hljs-comment">// 适用于不需要输入的程序</span><br>&#125;<br></code></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">char</span>** argv)</span> </span>&#123;<br>    <span class="hljs-comment">// 这是最常见的写法</span><br>    <span class="hljs-comment">// 可以获取命令行参数，但无法直接访问环境变量</span><br>    <span class="hljs-comment">// 但可以用 getenv(&quot;PATH&quot;) 等函数获取</span><br>&#125;<br></code></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">char</span>** argv, <span class="hljs-type">char</span>** envp)</span> </span>&#123;<br>    <span class="hljs-comment">// 可以获取所有信息</span><br>    <span class="hljs-comment">// envp 是以NULL结尾的字符串数组</span><br>    <span class="hljs-comment">// 每个字符串格式： &quot;NAME=VALUE&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>二、参数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">argc = 程序名 + 用户输入的参数个数<br><br>你输入的：     [./vulnerable]  [&quot;AAAAA&quot;]<br>操作系统解析为： argv[0]         argv[1]<br>                 ↓              ↓<br>               程序名          第一个用户参数<br></code></pre></td></tr></table></figure>
<h1 id="条件控制"><a href="#条件控制" class="headerlink" title="条件控制"></a><a class="markdownIt-Anchor" href="#条件控制"></a> 条件控制</h1>
<h2 id="一-基础选择结构"><a href="#一-基础选择结构" class="headerlink" title="一-基础选择结构"></a><a class="markdownIt-Anchor" href="#一-基础选择结构"></a> 一、基础选择结构</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">if</span> </span><br><span class="hljs-function"><span class="hljs-title">if</span> <span class="hljs-params">(条件)</span> </span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-comment">// 条件为真时执行</span><br>&#125;<br>​<br><span class="hljs-keyword">if</span>-<span class="hljs-keyword">else</span> <br><span class="hljs-keyword">if</span> (条件) <br>&#123;<br>    <span class="hljs-comment">// 条件为真时执行</span><br>&#125; <br><span class="hljs-keyword">else</span> <br>&#123;<br>    <span class="hljs-comment">// 条件为假时执行</span><br>&#125;<br>​<br><span class="hljs-keyword">if</span>-<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>-<span class="hljs-keyword">else</span> <br><span class="hljs-keyword">if</span> (条件<span class="hljs-number">1</span>) <br>&#123;<br>    <span class="hljs-comment">// 条件1为真</span><br>&#125; <br><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (条件<span class="hljs-number">2</span>) <br>&#123;<br>    <span class="hljs-comment">// 条件2为真</span><br>&#125; <br><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (条件<span class="hljs-number">3</span>)<br> &#123;<br>    <span class="hljs-comment">// 条件3为真</span><br>&#125; <br><span class="hljs-keyword">else</span> <br>&#123;<br>    <span class="hljs-comment">// 以上都不为真</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="二-循环结构"><a href="#二-循环结构" class="headerlink" title="二-循环结构"></a><a class="markdownIt-Anchor" href="#二-循环结构"></a> 二、循环结构</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">while</span> </span><br><span class="hljs-function"><span class="hljs-title">while</span> <span class="hljs-params">(条件)</span> </span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-comment">// 条件为真时重复执行</span><br>    <span class="hljs-comment">// 记得在循环内改变条件，否则会无限循环！</span><br>&#125;<br>​<br><span class="hljs-keyword">do</span>-<span class="hljs-keyword">while</span> <br><span class="hljs-keyword">do</span> <br>&#123;<br>    <span class="hljs-comment">// 至少执行一次</span><br>    <span class="hljs-comment">// 然后检查条件</span><br>&#125; <br><span class="hljs-keyword">while</span> (条件);  <span class="hljs-comment">// 注意分号！</span><br>​<br><span class="hljs-keyword">for</span> 循环 - 最常用的计数循环<br><span class="hljs-keyword">for</span> (初始化; 条件; 更新) <br>&#123;<br>    <span class="hljs-comment">// 循环体</span><br>&#125;<br>​<br>范围 <span class="hljs-keyword">for</span> 循环 (C+<span class="hljs-number">+11</span>) - 遍历容器<br><span class="hljs-keyword">for</span> (类型 变量 : 容器)<br> &#123;<br>    <span class="hljs-comment">// 使用变量</span><br> &#125;<br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="三-分支结构"><a href="#三-分支结构" class="headerlink" title="三-分支结构"></a><a class="markdownIt-Anchor" href="#三-分支结构"></a> 三、分支结构</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">switch</span> 语句 - 多路分支<br><span class="hljs-keyword">switch</span> (表达式)<br> &#123;<br>    <span class="hljs-keyword">case</span> 值<span class="hljs-number">1</span>:<br>        <span class="hljs-comment">// 代码</span><br>        <span class="hljs-keyword">break</span>;  <span class="hljs-comment">// 重要！不加会继续执行下一个case</span><br>    <span class="hljs-keyword">case</span> 值<span class="hljs-number">2</span>:<br>        <span class="hljs-comment">// 代码</span><br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> 值<span class="hljs-number">3</span>:<br>        <span class="hljs-comment">// 代码</span><br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">default</span>:    <span class="hljs-comment">// 可选，相当于else</span><br>        <span class="hljs-comment">// 代码</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="四-流程控制关键字"><a href="#四-流程控制关键字" class="headerlink" title="四-流程控制关键字"></a><a class="markdownIt-Anchor" href="#四-流程控制关键字"></a> 四、流程控制关键字</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">break</span> - 跳出当前循环或<span class="hljs-function"><span class="hljs-keyword">switch</span></span><br><span class="hljs-function"><span class="hljs-title">for</span> <span class="hljs-params">(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++)</span> </span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span> (i == <span class="hljs-number">5</span>) <br>    &#123;<br>        <span class="hljs-keyword">break</span>;  <span class="hljs-comment">// 当i==5时跳出整个循环</span><br>    &#125;<br>    cout &lt;&lt; i &lt;&lt; endl;<br>&#125;<br>​<br><span class="hljs-keyword">continue</span> - 跳过本次循环剩余部分<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) <br>&#123;<br>    <span class="hljs-keyword">if</span> (i % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>) <br>    &#123;<br>        <span class="hljs-keyword">continue</span>;  <span class="hljs-comment">// 跳过偶数</span><br>    &#125;<br>    cout &lt;&lt; i &lt;&lt; endl;  <span class="hljs-comment">// 只打印奇数</span><br>&#125;<br>​<br><span class="hljs-keyword">return</span> - 从函数返回<br><span class="hljs-type">int</span> <span class="hljs-built_in">max</span>(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b) <br>&#123;<br>    <span class="hljs-keyword">if</span> (a &gt; b) <br>    &#123;<br>        <span class="hljs-keyword">return</span> a;  <span class="hljs-comment">// 提前返回</span><br>    &#125;<br>    <span class="hljs-keyword">return</span> b;  <span class="hljs-comment">// 默认返回</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="五-条件表达式技巧"><a href="#五-条件表达式技巧" class="headerlink" title="五-条件表达式技巧"></a><a class="markdownIt-Anchor" href="#五-条件表达式技巧"></a> 五、条件表达式技巧</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs cpp">常用条件写法：<br><span class="hljs-comment">// 1. 比较</span><br><span class="hljs-keyword">if</span> (a == b)    <span class="hljs-comment">// 等于</span><br><span class="hljs-keyword">if</span> (a != b)    <span class="hljs-comment">// 不等于</span><br><span class="hljs-keyword">if</span> (a &gt; b)     <span class="hljs-comment">// 大于</span><br><span class="hljs-keyword">if</span> (a &lt; b)     <span class="hljs-comment">// 小于</span><br><span class="hljs-keyword">if</span> (a &gt;= b)    <span class="hljs-comment">// 大于等于</span><br><span class="hljs-keyword">if</span> (a &lt;= b)    <span class="hljs-comment">// 小于等于</span><br><br><span class="hljs-comment">// 2. 逻辑组合</span><br><span class="hljs-keyword">if</span> (a &amp;&amp; b)    <span class="hljs-comment">// 与：两者都为真</span><br><span class="hljs-keyword">if</span> (a || b)    <span class="hljs-comment">// 或：至少一个为真</span><br><span class="hljs-keyword">if</span> (!a)        <span class="hljs-comment">// 非：a为假</span><br><br><span class="hljs-comment">// 3. 简洁写法</span><br><span class="hljs-keyword">if</span> (ptr)       <span class="hljs-comment">// 检查指针非空（ptr != nullptr）</span><br><span class="hljs-keyword">if</span> (!str.<span class="hljs-built_in">empty</span>())  <span class="hljs-comment">// 检查字符串非空</span><br><span class="hljs-keyword">if</span> (count)     <span class="hljs-comment">// 检查非零（count != 0）</span><br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="六-bool"><a href="#六-bool" class="headerlink" title="六-bool"></a><a class="markdownIt-Anchor" href="#六-bool"></a> 六、bool</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><code class="hljs cpp">基本声明与初始化<br><span class="hljs-comment">// 声明并初始化</span><br><span class="hljs-type">bool</span> isReady = <span class="hljs-literal">true</span>;     <span class="hljs-comment">// true</span><br><span class="hljs-type">bool</span> isEmpty = <span class="hljs-literal">false</span>;    <span class="hljs-comment">// false</span><br><br><span class="hljs-comment">// C++11 统一初始化</span><br><span class="hljs-type">bool</span> isValid&#123;<span class="hljs-literal">true</span>&#125;;<br><span class="hljs-type">bool</span> isDone&#123;<span class="hljs-literal">false</span>&#125;;<br><br><span class="hljs-comment">// 自动推断（C++17）</span><br><span class="hljs-keyword">auto</span> isFound = <span class="hljs-literal">true</span>;     <span class="hljs-comment">// bool 类型</span><br><br><br><span class="hljs-type">bool</span> 定义的完整分类<br><br><span class="hljs-number">1.</span> 直接 <span class="hljs-literal">true</span>/<span class="hljs-literal">false</span>（字面值）<br><br><span class="hljs-type">bool</span> flag1 = <span class="hljs-literal">true</span>;     <span class="hljs-comment">// 直接 true</span><br><span class="hljs-type">bool</span> flag2 = <span class="hljs-literal">false</span>;    <span class="hljs-comment">// 直接 false</span><br><span class="hljs-type">bool</span> flag3&#123;<span class="hljs-literal">true</span>&#125;;      <span class="hljs-comment">// C++11 统一初始化</span><br><br><br><span class="hljs-number">2.</span> 数字转换（隐式转换）<br><br><span class="hljs-type">bool</span> flag4 = <span class="hljs-number">1</span>;        <span class="hljs-comment">// true（非0 → true）</span><br><span class="hljs-type">bool</span> flag5 = <span class="hljs-number">0</span>;        <span class="hljs-comment">// false（0 → false）</span><br><span class="hljs-type">bool</span> flag6 = <span class="hljs-number">100</span>;      <span class="hljs-comment">// true</span><br><span class="hljs-type">bool</span> flag7 = <span class="hljs-number">-5</span>;       <span class="hljs-comment">// true（负数也是非0）</span><br><span class="hljs-type">bool</span> flag8 = <span class="hljs-number">3.14</span>;     <span class="hljs-comment">// true（小数也是非0）</span><br><br><br><span class="hljs-number">3.</span> 条件表达式（最常见）<br><br><span class="hljs-type">int</span> age = <span class="hljs-number">20</span>;<br><span class="hljs-type">int</span> score = <span class="hljs-number">85</span>;<br><br><span class="hljs-type">bool</span> flag9 = (age &gt;= <span class="hljs-number">18</span>);              <span class="hljs-comment">// 简单条件</span><br><span class="hljs-type">bool</span> flag10 = (score &gt; <span class="hljs-number">90</span>);            <span class="hljs-comment">// 比较条件</span><br><span class="hljs-type">bool</span> flag11 = (!name.<span class="hljs-built_in">empty</span>());         <span class="hljs-comment">// 函数调用条件</span><br><span class="hljs-type">bool</span> flag12 = (x &gt; <span class="hljs-number">0</span> &amp;&amp; y &lt; <span class="hljs-number">100</span>);      <span class="hljs-comment">// 组合条件</span><br><br><br><span class="hljs-number">4.</span> 函数返回值（本质也是条件）<br><br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">isEven</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span> </span>&#123; <span class="hljs-keyword">return</span> n % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>; &#125;<br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">isPrime</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span> </span>&#123; <span class="hljs-comment">/* 判断质数 */</span> &#125;<br><br><span class="hljs-type">bool</span> flag13 = <span class="hljs-built_in">isEven</span>(<span class="hljs-number">4</span>);        <span class="hljs-comment">// 调用返回 bool 的函数</span><br><span class="hljs-type">bool</span> flag14 = <span class="hljs-built_in">checkFile</span>(<span class="hljs-string">&quot;a.txt&quot;</span>); <span class="hljs-comment">// 返回 bool 的任意函数</span><br>​<br>输入输出<br><span class="hljs-type">bool</span> flag;<br>cin &gt;&gt; flag;           <span class="hljs-comment">// 输入 1 或 0</span><br>cin &gt;&gt; boolalpha &gt;&gt; flag;  <span class="hljs-comment">// 输入 true 或 false</span><br><br><span class="hljs-type">bool</span> flag = <span class="hljs-literal">true</span>;<br>cout &lt;&lt; flag;               <span class="hljs-comment">// 输出：1</span><br>cout &lt;&lt; boolalpha &lt;&lt; flag;  <span class="hljs-comment">// 输出：true</span><br>cout &lt;&lt; noboolalpha &lt;&lt; flag;<span class="hljs-comment">// 输出：1</span><br>​<br>常见使用场景<br>标志变量<br><span class="hljs-type">bool</span> found = <span class="hljs-literal">false</span>;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> num : numbers) &#123;<br>    <span class="hljs-keyword">if</span> (num == target) &#123;<br>        found = <span class="hljs-literal">true</span>;<br>        <span class="hljs-keyword">break</span>;<br>    &#125;<br>&#125;<br>​<br>状态检查<br><span class="hljs-type">bool</span> isLoggedIn = <span class="hljs-literal">false</span>;<br><span class="hljs-type">bool</span> isValidInput = <span class="hljs-literal">true</span>;<br><span class="hljs-type">bool</span> hasPermission = <span class="hljs-literal">false</span>;<br>​<br>条件控制<br><span class="hljs-type">bool</span> shouldContinue = <span class="hljs-literal">true</span>;<br><br><span class="hljs-keyword">while</span> (shouldContinue) &#123;<br>    <span class="hljs-comment">// 处理逻辑</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-comment">/* 满足条件 */</span>) &#123;<br>        shouldContinue = <span class="hljs-literal">false</span>;  <span class="hljs-comment">// 改变状态</span><br>    &#125;<br>&#125;<br><br>​<br>函数中的 <span class="hljs-type">bool</span><br>返回值<br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">isEven</span><span class="hljs-params">(<span class="hljs-type">int</span> number)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> (number % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">isPrime</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span> </span>&#123;<br>    <span class="hljs-keyword">if</span> (n &lt;= <span class="hljs-number">1</span>) <br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">2</span>; i*i &lt;= n; i++) &#123;<br>        <span class="hljs-keyword">if</span> (n % i == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br>​<br>参数<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">printMessage</span><span class="hljs-params">(<span class="hljs-type">const</span> string&amp; msg, <span class="hljs-type">bool</span> verbose = <span class="hljs-literal">false</span>)</span> </span>&#123;<br>    cout &lt;&lt; msg;<br>    <span class="hljs-keyword">if</span> (verbose) &#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot; [详细信息]&quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 使用</span><br><span class="hljs-built_in">printMessage</span>(<span class="hljs-string">&quot;完成&quot;</span>, <span class="hljs-literal">true</span>);   <span class="hljs-comment">// 输出：完成 [详细信息]</span><br><span class="hljs-built_in">printMessage</span>(<span class="hljs-string">&quot;完成&quot;</span>);         <span class="hljs-comment">// 输出：完成</span><br>​<br>数组与容器中的 <span class="hljs-type">bool</span><br><span class="hljs-type">bool</span> 数组<br><span class="hljs-type">bool</span> flags[<span class="hljs-number">3</span>] = &#123;<span class="hljs-literal">true</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>&#125;;<br><br><span class="hljs-comment">// 常用于标记状态</span><br><span class="hljs-type">bool</span> visited[<span class="hljs-number">100</span>] = &#123;<span class="hljs-literal">false</span>&#125;;  <span class="hljs-comment">// 全部初始化为 false</span><br>​<br>vector&lt;<span class="hljs-type">bool</span>&gt; 特例<br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br>vector&lt;<span class="hljs-type">bool</span>&gt; bits = &#123;<span class="hljs-literal">true</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>, <span class="hljs-literal">true</span>&#125;;<br><br><span class="hljs-comment">// 注意：vector&lt;bool&gt; 是特化版本，节省空间</span><br>bits[<span class="hljs-number">1</span>] = <span class="hljs-literal">true</span>;  <span class="hljs-comment">// 修改</span><br></code></pre></td></tr></table></figure>
<h1 id="算法"><a href="#算法" class="headerlink" title="算法"></a><a class="markdownIt-Anchor" href="#算法"></a> 算法</h1>
<h2 id="排序"><a href="#排序" class="headerlink" title="排序"></a><a class="markdownIt-Anchor" href="#排序"></a> 排序</h2>
<h3 id="冒泡排序"><a href="#冒泡排序" class="headerlink" title="冒泡排序"></a><a class="markdownIt-Anchor" href="#冒泡排序"></a> 冒泡排序</h3>
<hr />
<p>一、基本思想</p>
<p>冒泡排序就是模拟这个过程：</p>
<ol>
<li>从数组的第一个元素开始，依次比较相邻的两个元素。</li>
<li>如果它们的顺序错了（比如前一个比后一个大，而我们想升序排序），就交换它们。</li>
<li>这样 一轮比较下来，最大的元素就会“冒”到数组的最后一位。</li>
<li>重复这个过程，每次忽略已经排好序的尾部元素，直到整个数组有序。</li>
</ol>
<hr />
<p>二、核心操作：比较与交换</p>
<p>这是冒泡排序的灵魂：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">if</span> (arr[j] &gt; arr[j + <span class="hljs-number">1</span>]) &#123;<br>    <span class="hljs-comment">// 交换它们</span><br>    <span class="hljs-type">int</span> temp = arr[j];<br>    arr[j] = arr[j + <span class="hljs-number">1</span>];<br>    arr[j + <span class="hljs-number">1</span>] = temp;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<hr />
<p>三、C++ 代码实现（基础版）</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">bubbleSort</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; arr)</span> </span>&#123;<br>    <span class="hljs-type">int</span> n = arr.<span class="hljs-built_in">size</span>();<br><br>    <span class="hljs-comment">// 外层循环：控制需要多少轮冒泡</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; n - <span class="hljs-number">1</span>; i++) &#123;<br>        <span class="hljs-comment">// 内层循环：进行相邻元素的比较和交换</span><br>        <span class="hljs-comment">// 注意：j &lt; n - 1 - i，因为最后i个元素已经排好了</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; n - <span class="hljs-number">1</span> - i; j++) &#123;<br>            <span class="hljs-keyword">if</span> (arr[j] &gt; arr[j + <span class="hljs-number">1</span>]) &#123;<br>                <span class="hljs-comment">// 交换arr[j]和arr[j+1]</span><br>                <span class="hljs-built_in">swap</span>(arr[j], arr[j + <span class="hljs-number">1</span>]);<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 测试</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vector&lt;<span class="hljs-type">int</span>&gt; arr = &#123;<span class="hljs-number">64</span>, <span class="hljs-number">34</span>, <span class="hljs-number">25</span>, <span class="hljs-number">12</span>, <span class="hljs-number">22</span>, <span class="hljs-number">11</span>, <span class="hljs-number">90</span>&#125;;<br><br>    cout &lt;&lt; <span class="hljs-string">&quot;排序前: &quot;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> num : arr) cout &lt;&lt; num &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;<br>    cout &lt;&lt; endl;<br><br>    <span class="hljs-built_in">bubbleSort</span>(arr);<br><br>    cout &lt;&lt; <span class="hljs-string">&quot;排序后: &quot;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> num : arr) cout &lt;&lt; num &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;<br>    cout &lt;&lt; endl;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">排序前: 64 34 25 12 22 11 90<br>排序后: 11 12 22 25 34 64 90<br><br></code></pre></td></tr></table></figure>
<hr />
<p>四、优化版本</p>
<p>基础版本即使数组已经有序，也会完整执行所有轮次。我们可以添加一个标志来优化：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">bubbleSortOptimized</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; arr)</span> </span>&#123;<br>    <span class="hljs-type">int</span> n = arr.<span class="hljs-built_in">size</span>();<br>    <span class="hljs-type">bool</span> swapped; <span class="hljs-comment">// 记录本轮是否发生过交换</span><br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; n - <span class="hljs-number">1</span>; i++) &#123;<br>        swapped = <span class="hljs-literal">false</span>;<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; n - <span class="hljs-number">1</span> - i; j++) &#123;<br>            <span class="hljs-keyword">if</span> (arr[j] &gt; arr[j + <span class="hljs-number">1</span>]) &#123;<br>                <span class="hljs-built_in">swap</span>(arr[j], arr[j + <span class="hljs-number">1</span>]);<br>                swapped = <span class="hljs-literal">true</span>; <span class="hljs-comment">// 发生了交换</span><br>            &#125;<br>        &#125;<br><br>        <span class="hljs-comment">// 如果本轮没有发生任何交换，说明数组已经有序</span><br>        <span class="hljs-keyword">if</span> (!swapped) &#123;<br>            <span class="hljs-keyword">break</span>; <span class="hljs-comment">// 提前结束</span><br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<p>优化效果：</p>
<p>· 对于已经有序的数组，只需要一轮扫描（O(n)）<br />
· 基础版则固定需要 O(n²) 次比较</p>
<h3 id="选择排序"><a href="#选择排序" class="headerlink" title="选择排序"></a><a class="markdownIt-Anchor" href="#选择排序"></a> 选择排序</h3>
<hr />
<p>一、基本思想</p>
<p>选择排序的核心思想是 “选择最小（或最大）的元素，放到它应该在的位置”。</p>
<p>想象一下在整理一副扑克牌：</p>
<ol>
<li>先扫描所有牌，找到最小的一张</li>
<li>把这张牌放到最左边</li>
<li>在剩下的牌中继续找最小的</li>
<li>放到已排序部分的后面</li>
<li>重复直到所有牌都排好</li>
</ol>
<hr />
<p>二、算法步骤（升序排序）</p>
<ol>
<li>将数组分为两部分：<br />
· 已排序部分（初始为空，在左边）<br />
· 未排序部分（初始为整个数组，在右边）</li>
<li>在未排序部分中找到最小元素的索引</li>
<li>将这个最小元素与未排序部分的第一个元素交换</li>
<li>这时，未排序部分的第一个元素就加入了已排序部分</li>
<li>重复步骤2-4，直到未排序部分为空</li>
</ol>
<hr />
<p>三、C++ 代码实现</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">selectionSort</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; arr)</span> </span>&#123;<br>    <span class="hljs-type">int</span> n = arr.<span class="hljs-built_in">size</span>();<br><br>    <span class="hljs-comment">// 外层循环：控制已排序部分的边界</span><br>    <span class="hljs-comment">// i 表示：arr[0...i-1] 是已排序的，arr[i...n-1] 是未排序的</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; n - <span class="hljs-number">1</span>; i++) &#123;<br>        <span class="hljs-comment">// 假设当前位置 i 就是最小元素的位置</span><br>        <span class="hljs-type">int</span> minIndex = i;<br><br>        <span class="hljs-comment">// 内层循环：在未排序部分中寻找真正的最小元素</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = i + <span class="hljs-number">1</span>; j &lt; n; j++) &#123;<br>            <span class="hljs-keyword">if</span> (arr[j] &lt; arr[minIndex]) &#123;<br>                minIndex = j;  <span class="hljs-comment">// 更新最小元素的索引</span><br>            &#125;<br>        &#125;<br><br>        <span class="hljs-comment">// 将找到的最小元素交换到正确位置 i</span><br>        <span class="hljs-keyword">if</span> (minIndex != i) &#123;<br>            <span class="hljs-built_in">swap</span>(arr[i], arr[minIndex]);<br>        &#125;<br><br>        <span class="hljs-comment">// 此时，arr[i] 已排好，加入到已排序部分</span><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 测试</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vector&lt;<span class="hljs-type">int</span>&gt; arr = &#123;<span class="hljs-number">64</span>, <span class="hljs-number">25</span>, <span class="hljs-number">12</span>, <span class="hljs-number">22</span>, <span class="hljs-number">11</span>&#125;;<br><br>    cout &lt;&lt; <span class="hljs-string">&quot;排序前: &quot;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> num : arr) cout &lt;&lt; num &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;<br>    cout &lt;&lt; endl;<br><br>    <span class="hljs-built_in">selectionSort</span>(arr);<br><br>    cout &lt;&lt; <span class="hljs-string">&quot;排序后: &quot;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> num : arr) cout &lt;&lt; num &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;<br>    cout &lt;&lt; endl;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">排序前: 64 25 12 22 11<br>排序后: 11 12 22 25 64<br><br></code></pre></td></tr></table></figure>
<hr />
<p>四、优化版本</p>
<p>虽然选择排序时间复杂度固定，但我们可以优化交换操作：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">selectionSortOptimized</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; arr)</span> </span>&#123;<br>    <span class="hljs-type">int</span> n = arr.<span class="hljs-built_in">size</span>();<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; n - <span class="hljs-number">1</span>; i++) &#123;<br>        <span class="hljs-type">int</span> minIndex = i;<br><br>        <span class="hljs-comment">// 找到最小元素的索引</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = i + <span class="hljs-number">1</span>; j &lt; n; j++) &#123;<br>            <span class="hljs-keyword">if</span> (arr[j] &lt; arr[minIndex]) &#123;<br>                minIndex = j;<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-comment">// 只有当最小元素不在当前位置时才交换</span><br>        <span class="hljs-keyword">if</span> (minIndex != i) &#123;<br>            <span class="hljs-comment">// 使用三次异或交换（无临时变量）</span><br>            arr[i] = arr[i] ^ arr[minIndex];<br>            arr[minIndex] = arr[i] ^ arr[minIndex];<br>            arr[i] = arr[i] ^ arr[minIndex];<br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<p>注意：异或交换虽然酷，但在实际工程中不推荐使用（可读性差，且对相同元素会出错）。</p>
<hr />
<p>五、变体：双向选择排序（鸡尾酒选择排序）</p>
<hr />
<p>优化思路：同时找最小值和最大值，最小值放左边，最大值放右边，从两头向中间推进。</p>
<hr />
<p>版本1：最直观但错误的版本</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 版本1：直观但有问题</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">bidirectional_v1</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; arr)</span> </span>&#123;<br>    <span class="hljs-type">int</span> left = <span class="hljs-number">0</span>, right = arr.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>;<br><br>    <span class="hljs-keyword">while</span> (left &lt; right) &#123;<br>        <span class="hljs-type">int</span> minIndex = left, maxIndex = right;  <span class="hljs-comment">// ❌ 问题1：maxIndex初始化为right</span><br><br>        <span class="hljs-comment">// 找最小值和最大值</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = left; i &lt;= right; i++) &#123;<br>            <span class="hljs-keyword">if</span> (arr[i] &lt; arr[minIndex]) minIndex = i;<br>            <span class="hljs-keyword">if</span> (arr[i] &gt; arr[maxIndex]) maxIndex = i;  <span class="hljs-comment">// ❌ 可能找不到真正的最大值</span><br>        &#125;<br><br>        <span class="hljs-comment">// 交换最小值到左边</span><br>        <span class="hljs-keyword">if</span> (minIndex != left) <span class="hljs-built_in">swap</span>(arr[left], arr[minIndex]);<br><br>        <span class="hljs-comment">// 交换最大值到右边</span><br>        <span class="hljs-keyword">if</span> (maxIndex != right) <span class="hljs-built_in">swap</span>(arr[right], arr[maxIndex]);<br><br>        left++;<br>        right--;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>问题1：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">//交换最小值时最大值位置变了</span><br></code></pre></td></tr></table></figure>
<hr />
<p>版本2 两次交换之间插入说明</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 版本3：考虑交换最小值对最大值位置的影响</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">bidirectional_v3</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; arr)</span> </span>&#123;<br>    <span class="hljs-type">int</span> left = <span class="hljs-number">0</span>, right = arr.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>;<br><br>    <span class="hljs-keyword">while</span> (left &lt; right) &#123;<br>        <span class="hljs-type">int</span> minIndex = left, maxIndex = left;<br><br>        <span class="hljs-comment">// 找最小值和最大值</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = left; i &lt;= right; i++) &#123;<br>            <span class="hljs-keyword">if</span> (arr[i] &lt; arr[minIndex]) minIndex = i;<br>            <span class="hljs-keyword">if</span> (arr[i] &gt; arr[maxIndex]) maxIndex = i;<br>        &#125;<br><br>        <span class="hljs-comment">// 交换最小值到左边</span><br>        <span class="hljs-keyword">if</span> (minIndex != left) <span class="hljs-built_in">swap</span>(arr[left], arr[minIndex]);<br><br>        <span class="hljs-comment">// 关键修复：如果最大值在left，它现在在minIndex</span><br>        <span class="hljs-keyword">if</span> (maxIndex == left) &#123;<br>            maxIndex = minIndex;<br>        &#125;<br><br>        <span class="hljs-comment">// 交换最大值到右边</span><br>        <span class="hljs-keyword">if</span> (maxIndex != right) <span class="hljs-built_in">swap</span>(arr[right], arr[maxIndex]);<br><br>        left++;<br>        right--;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<p>问题2:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><br><span class="hljs-comment">//边界重叠问题：</span><br><span class="hljs-comment">//// 第一步：if (minIndex != left) → 1 != 0 成立</span><br><span class="hljs-built_in">swap</span>(arr[<span class="hljs-number">0</span>], arr[<span class="hljs-number">1</span>]) → [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]<br><br><span class="hljs-comment">// 第二步：if (maxIndex == left) → 0 == 0 成立</span><br>maxIndex = minIndex = <span class="hljs-number">1</span><br><br><span class="hljs-comment">// 第三步：if (maxIndex != right) → 1 != 1 ❌ 不成立！</span><br><span class="hljs-comment">// 不执行交换！maxIndex现在是1，right也是1</span><br><span class="hljs-comment">// 但问题是：最大值2已经在正确位置了吗？</span><br><span class="hljs-comment">// 查看数组：[1, 2] ✓ 2确实在最后，但这是巧合！</span><br><br>问题：当 maxIndex 被更新为 minIndex，而 minIndex == right 时，版本<span class="hljs-number">2</span>的 <span class="hljs-keyword">if</span> (maxIndex != right) 会阻止交换，但有时这是需要的！<br></code></pre></td></tr></table></figure>
<hr />
<p>版本3：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">bidirectional_v4</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; arr)</span> </span>&#123;<br>    <span class="hljs-type">int</span> left = <span class="hljs-number">0</span>, right = arr.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>;<br><br>    <span class="hljs-keyword">while</span> (left &lt; right) &#123;<br>        <span class="hljs-type">int</span> minIndex = left, maxIndex = left;<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = left; i &lt;= right; i++) &#123;<br>            <span class="hljs-keyword">if</span> (arr[i] &lt; arr[minIndex]) minIndex = i;<br>            <span class="hljs-keyword">if</span> (arr[i] &gt; arr[maxIndex]) maxIndex = i;<br>        &#125;<br><br>        <span class="hljs-comment">// 交换最小值</span><br>        <span class="hljs-built_in">swap</span>(arr[left], arr[minIndex]);  <span class="hljs-comment">// 移除了if判断</span><br><br>        <span class="hljs-comment">// 更新最大值位置</span><br>        <span class="hljs-keyword">if</span> (maxIndex == left) &#123;<br>            maxIndex = minIndex;<br>        &#125;<br><br>        <span class="hljs-comment">// 交换最大值</span><br>        <span class="hljs-built_in">swap</span>(arr[right], arr[maxIndex]);  <span class="hljs-comment">// 移除了if判断</span><br><br>        left++;<br>        right--;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<hr />
<p>版本4：最终修复版（处理所有边界）<br />
// 版本5：最终正确版本</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">bidirectionalSelectionSort</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; arr)</span> </span>&#123;<br>    <span class="hljs-keyword">if</span> (arr.<span class="hljs-built_in">empty</span>()) <span class="hljs-keyword">return</span>;<br><br>    <span class="hljs-type">int</span> left = <span class="hljs-number">0</span>, right = arr.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>;<br><br>    <span class="hljs-keyword">while</span> (left &lt; right) &#123;<br>        <span class="hljs-comment">// 初始化</span><br>        <span class="hljs-type">int</span> minIndex = left, maxIndex = left;<br><br>        <span class="hljs-comment">// 查找最小值和最大值的索引</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = left; i &lt;= right; i++) &#123;<br>            <span class="hljs-keyword">if</span> (arr[i] &lt; arr[minIndex]) &#123;<br>                minIndex = i;<br>            &#125;<br>            <span class="hljs-keyword">if</span> (arr[i] &gt; arr[maxIndex]) &#123;<br>                maxIndex = i;<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-comment">// 交换最小值到left位置</span><br>        <span class="hljs-built_in">swap</span>(arr[left], arr[minIndex]);<br><br>        <span class="hljs-comment">// 关键：如果最大值在left，它现在在minIndex</span><br>        <span class="hljs-comment">// 但如果minIndex == right，会有问题！</span><br>        <span class="hljs-keyword">if</span> (maxIndex == left) &#123;<br>            maxIndex = minIndex;<br>        &#125;<br><br>        <span class="hljs-comment">// 交换最大值到right位置</span><br>        <span class="hljs-built_in">swap</span>(arr[right], arr[maxIndex]);<br><br>        <span class="hljs-comment">// 收缩边界</span><br>        left++;<br>        right--;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="插入排序"><a href="#插入排序" class="headerlink" title="插入排序"></a><a class="markdownIt-Anchor" href="#插入排序"></a> 插入排序</h3>
<hr />
<p>一、基本思想</p>
<p>插入排序模拟了整理扑克牌的过程：</p>
<p>想象手里有一堆乱序的牌：</p>
<ol>
<li>从第二张牌开始（假设第一张已经在&quot;手&quot;里了）</li>
<li>拿起一张新牌</li>
<li>从右向左与手中的牌比较</li>
<li>找到合适的位置插入</li>
<li>重复直到所有牌都插入</li>
</ol>
<p>一句话总结：将每个新元素插入到已排序部分的正确位置。</p>
<hr />
<p>二、算法步骤</p>
<ol>
<li>将数组分为两部分：<br />
· 已排序部分（初始只有第一个元素）<br />
· 未排序部分（其余元素）</li>
<li>依次从未排序部分取元素</li>
<li>在已排序部分中从后往前扫描，找到插入位置</li>
<li>将大于该元素的都向右移动一位</li>
<li>插入该元素到正确位置</li>
</ol>
<hr />
<p>三、C++ 代码实现</p>
<p>基础版本</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">insertionSort</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; arr)</span> </span>&#123;<br>    <span class="hljs-type">int</span> n = arr.<span class="hljs-built_in">size</span>();<br><br>    <span class="hljs-comment">// 从第二个元素开始（下标1）</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt; n; i++) &#123;<br>        <span class="hljs-type">int</span> key = arr[i];  <span class="hljs-comment">// 当前要插入的元素</span><br>        <span class="hljs-type">int</span> j = i - <span class="hljs-number">1</span>;     <span class="hljs-comment">// 从已排序部分的最后一个开始比较</span><br><br>        <span class="hljs-comment">// 将比key大的元素都向右移动一位</span><br>        <span class="hljs-keyword">while</span> (j &gt;= <span class="hljs-number">0</span> &amp;&amp; arr[j] &gt; key) &#123;<br>            arr[j + <span class="hljs-number">1</span>] = arr[j];<br>            j--;<br>        &#125;<br><br>        <span class="hljs-comment">// 插入key到正确位置</span><br>        arr[j + <span class="hljs-number">1</span>] = key;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 测试</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vector&lt;<span class="hljs-type">int</span>&gt; arr = &#123;<span class="hljs-number">12</span>, <span class="hljs-number">11</span>, <span class="hljs-number">13</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>&#125;;<br><br>    cout &lt;&lt; <span class="hljs-string">&quot;排序前: &quot;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> num : arr) cout &lt;&lt; num &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;<br>    cout &lt;&lt; endl;<br><br>    <span class="hljs-built_in">insertionSort</span>(arr);<br><br>    cout &lt;&lt; <span class="hljs-string">&quot;排序后: &quot;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> num : arr) cout &lt;&lt; num &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;<br>    cout &lt;&lt; endl;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">排序前: 12 11 13 5 6<br>排序后: 5 6 11 12 13<br><br></code></pre></td></tr></table></figure>
<hr />
<h3 id="快速排序"><a href="#快速排序" class="headerlink" title="快速排序"></a><a class="markdownIt-Anchor" href="#快速排序"></a> 快速排序</h3>
<hr />
<p>一、核心思想：分而治之</p>
<p>快速排序的核心是 “Divide and Conquer”：</p>
<ol>
<li>分解：选一个&quot;基准&quot;元素，将数组分成两个子数组<br />
· 左边：所有比基准小的元素<br />
· 右边：所有比基准大的元素<br />
· 基准在中间正确位置</li>
<li>解决：递归地对左右子数组进行快速排序</li>
<li>合并：不需要！因为原址排序，排完后自然有序</li>
</ol>
<hr />
<p>二、基本步骤（Partition操作是关键）</p>
<p>以最经典的 Lomuto分区方案 为例：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// Partition的直观理解：像整理书架</span><br><span class="hljs-comment">// [比pivot小的书] pivot [比pivot大的书]</span><br><br></code></pre></td></tr></table></figure>
<hr />
<p>三、C++代码实现（Lomuto分区）</p>
<p>基础版本（每次取最后一个做基准，小的放左大的放右，基准归位，左右递归！）</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-comment">// 分区函数：返回pivot的最终位置</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">partition</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; arr, <span class="hljs-type">int</span> low, <span class="hljs-type">int</span> high)</span> </span>&#123;<br>    <span class="hljs-type">int</span> pivot = arr[high];  <span class="hljs-comment">// 选择最后一个元素作为pivot</span><br>    <span class="hljs-type">int</span> i = low - <span class="hljs-number">1</span>;        <span class="hljs-comment">// i指向小于pivot区域的边界</span><br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = low; j &lt; high; j++) &#123;<br>        <span class="hljs-comment">// 如果当前元素小于等于pivot</span><br>        <span class="hljs-keyword">if</span> (arr[j] &lt;= pivot) &#123;<br>            i++;  <span class="hljs-comment">// 扩大小于pivot的区域</span><br>            <span class="hljs-built_in">swap</span>(arr[i], arr[j]);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// 将pivot放到正确位置</span><br>    <span class="hljs-built_in">swap</span>(arr[i + <span class="hljs-number">1</span>], arr[high]);<br>    <span class="hljs-keyword">return</span> i + <span class="hljs-number">1</span>;  <span class="hljs-comment">// 返回pivot的位置</span><br>&#125;<br><br><span class="hljs-comment">// 快速排序主函数</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">quickSort</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; arr, <span class="hljs-type">int</span> low, <span class="hljs-type">int</span> high)</span> </span>&#123;<br>    <span class="hljs-keyword">if</span> (low &lt; high) &#123;<br>        <span class="hljs-comment">// pi是pivot的正确位置</span><br>        <span class="hljs-type">int</span> pi = <span class="hljs-built_in">partition</span>(arr, low, high);<br><br>        <span class="hljs-comment">// 递归排序左半部分和右半部分</span><br>        <span class="hljs-built_in">quickSort</span>(arr, low, pi - <span class="hljs-number">1</span>);<br>        <span class="hljs-built_in">quickSort</span>(arr, pi + <span class="hljs-number">1</span>, high);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 包装函数</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">quickSort</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; arr)</span> </span>&#123;<br>    <span class="hljs-keyword">if</span> (arr.<span class="hljs-built_in">empty</span>()) <span class="hljs-keyword">return</span>;<br>    <span class="hljs-built_in">quickSort</span>(arr, <span class="hljs-number">0</span>, arr.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>);<br>&#125;<br><br><span class="hljs-comment">// 测试</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vector&lt;<span class="hljs-type">int</span>&gt; arr = &#123;<span class="hljs-number">10</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>&#125;;<br><br>    cout &lt;&lt; <span class="hljs-string">&quot;原始数组: &quot;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> num : arr) cout &lt;&lt; num &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;<br>    cout &lt;&lt; endl;<br><br>    <span class="hljs-built_in">quickSort</span>(arr);<br><br>    cout &lt;&lt; <span class="hljs-string">&quot;排序后: &quot;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> num : arr) cout &lt;&lt; num &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;<br>    cout &lt;&lt; endl;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">原始数组: 10 7 8 9 1 5<br>排序后: 1 5 7 8 9 10<br><br></code></pre></td></tr></table></figure>
<hr />
<p>四、更高效的Hoare分区方案</p>
<p>Lomuto方案简单但交换次数多。Hoare方案更高效：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// Hoare分区 - 更少的交换，更高效</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">partitionHoare</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; arr, <span class="hljs-type">int</span> low, <span class="hljs-type">int</span> high)</span> </span>&#123;<br>    <span class="hljs-type">int</span> pivot = arr[low];  <span class="hljs-comment">// 选择第一个元素作为pivot</span><br>    <span class="hljs-type">int</span> i = low - <span class="hljs-number">1</span>;<br>    <span class="hljs-type">int</span> j = high + <span class="hljs-number">1</span>;<br><br>    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) &#123;<br>        <span class="hljs-comment">// 从左找第一个大于等于pivot的元素</span><br>        <span class="hljs-keyword">do</span> &#123;<br>            i++;<br>        &#125; <br>        <span class="hljs-keyword">while</span> (arr[i] &lt; pivot);<br><br>        <span class="hljs-comment">// 从右找第一个小于等于pivot的元素</span><br>        <span class="hljs-keyword">do</span> &#123;<br>            j--;<br>        &#125; <br>        <span class="hljs-keyword">while</span> (arr[j] &gt; pivot);<br><br>        <span class="hljs-comment">// 如果指针相遇，返回j</span><br>        <span class="hljs-keyword">if</span> (i &gt;= j) <span class="hljs-keyword">return</span> j;<br><br>        <span class="hljs-comment">// 交换这两个错位的元素</span><br>        <span class="hljs-built_in">swap</span>(arr[i], arr[j]);<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">quickSortHoare</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; arr, <span class="hljs-type">int</span> low, <span class="hljs-type">int</span> high)</span> </span>&#123;<br>    <span class="hljs-keyword">if</span> (low &lt; high) &#123;<br>        <span class="hljs-type">int</span> pi = <span class="hljs-built_in">partitionHoare</span>(arr, low, high);<br>        <span class="hljs-built_in">quickSortHoare</span>(arr, low, pi);      <span class="hljs-comment">// 注意：包含pi</span><br>        <span class="hljs-built_in">quickSortHoare</span>(arr, pi + <span class="hljs-number">1</span>, high);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<hr />
<p>五、📊 快排的pivot极端情况</p>
<p>🏆 最好的pivot：中位数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">[1, 2, 3, 4, 5, 6, 7, 8]<br>选pivot=4或5<br>结果：左边3个，右边4个 → 完美平衡<br>递归深度：log₂n ≈ 3层<br>时间复杂度：O(n log n) ✅ 最快<br></code></pre></td></tr></table></figure>
<p>💀 最差的pivot：最大/最小值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">[1, 2, 3, 4, 5, 6, 7, 8]<br>选pivot=1或8<br>结果：左边0个，右边7个（或相反）→ 极度不平衡<br>递归深度：n ≈ 8层<br>时间复杂度：O(n²) ❌ 最慢<br></code></pre></td></tr></table></figure>
<hr />
<p>🎯 最好vs最差：一图胜千言</p>
<p>最好情况（中位数）：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">第1层: [1,2,3,4,5,6,7,8] → pivot=4<br>        /           \\<br>[1,2,3,4]         [5,6,7,8]  ✓ 两边均匀<br>第2层: 再分 → 4个子数组<br>第3层: 再分 → 8个子数组（完成）<br></code></pre></td></tr></table></figure>
<p>最差情况（最大/最小值）：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">第1层: [1,2,3,4,5,6,7,8] → pivot=1<br>        /<br>      []    [2,3,4,5,6,7,8]  ❌ 一边倒<br><br>第2层: [2,3,4,5,6,7,8] → pivot=2<br>        /<br>      []    [3,4,5,6,7,8]    ❌ 继续倒<br><br>... 一直倒到结束，像冒泡排序一样慢<br></code></pre></td></tr></table></figure>
<hr />
<p>🔥 为什么中位数最好？</p>
<p>因为每次都能把数组对半切：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">n = 8<br>第1层: 8个 → 4个 + 4个<br>第2层: 4个 → 2个 + 2个<br>第3层: 2个 → 1个 + 1个<br>总层数: log₂8 = 3<br></code></pre></td></tr></table></figure>
<p>为什么最差是最大/最小值？</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">n = 8<br>第1层: 8个 → 0个 + 7个<br>第2层: 7个 → 0个 + 6个<br>第3层: 6个 → 0个 + 5个<br>...<br>总层数: 8 = n<br></code></pre></td></tr></table></figure>
<hr />
<p>📈 时间复杂度对比</p>
<p>pivot    递归深度   总时间       举例<br />
中位数     log₂n   O(n log n)   50ms<br />
随机 期望  log₂n   O(n log n)   50-60ms<br />
最大/最小    n        O(n²)     2500ms</p>
<hr />
<p>🎲 为什么随机pivot能救？</p>
<p>固定选最后一个：</p>
<p>· 已排序数组 → 100%是最差pivot ❌</p>
<p>随机选：</p>
<p>· 第一次选到最差概率：2/n<br />
· 连续选到最差概率：(2/n)ⁿ → 几乎为0</p>
<p>数学保你不死！ ✅</p>
<p>💎 一句话总结</p>
<p>最好pivot是正中靶心的中位数，最差pivot是擦边过的大/最小值——前者一剑封喉，后者钝刀割肉。 🎯</p>
<hr />
<p>六、优化策略</p>
<ol>
<li>随机化pivot选择（避免最坏情况）</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">partitionRandom</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; arr, <span class="hljs-type">int</span> low, <span class="hljs-type">int</span> high)</span> </span>&#123;<br>    <span class="hljs-comment">// 随机选择一个pivot</span><br>    <span class="hljs-type">int</span> randomIndex = low + <span class="hljs-built_in">rand</span>() % (high - low + <span class="hljs-number">1</span>);<br>    <span class="hljs-built_in">swap</span>(arr[randomIndex], arr[high]);  <span class="hljs-comment">// 放到最后，方便Lomuto分区</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">partition</span>(arr, low, high);<br>&#125;<br><br></code></pre></td></tr></table></figure>
<ol start="2">
<li>三数取中法</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">medianOfThree</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; arr, <span class="hljs-type">int</span> low, <span class="hljs-type">int</span> high)</span> </span>&#123;<br>    <span class="hljs-type">int</span> mid = low + (high - low) / <span class="hljs-number">2</span>;<br><br>    <span class="hljs-comment">// 对arr[low], arr[mid], arr[high]排序</span><br>    <span class="hljs-keyword">if</span> (arr[low] &gt; arr[mid]) <span class="hljs-built_in">swap</span>(arr[low], arr[mid]);<br>    <span class="hljs-keyword">if</span> (arr[low] &gt; arr[high]) <span class="hljs-built_in">swap</span>(arr[low], arr[high]);<br>    <span class="hljs-keyword">if</span> (arr[mid] &gt; arr[high]) <span class="hljs-built_in">swap</span>(arr[mid], arr[high]);<br><br>    <span class="hljs-comment">// 将中位数放到high位置</span><br>    <span class="hljs-built_in">swap</span>(arr[mid], arr[high]);<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">partition</span>(arr, low, high);<br>&#125;<br><br></code></pre></td></tr></table></figure>
<ol start="3">
<li>小数组使用插入排序</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">quickSortOptimized</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; arr, <span class="hljs-type">int</span> low, <span class="hljs-type">int</span> high)</span> </span>&#123;<br>    <span class="hljs-comment">// 小数组用插入排序更快</span><br>    <span class="hljs-keyword">if</span> (high - low + <span class="hljs-number">1</span> &lt; <span class="hljs-number">10</span>) &#123;<br>        <span class="hljs-built_in">insertionSort</span>(arr, low, high);<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (low &lt; high) &#123;<br>        <span class="hljs-type">int</span> pi = <span class="hljs-built_in">partitionRandom</span>(arr, low, high);<br>        <span class="hljs-built_in">quickSortOptimized</span>(arr, low, pi - <span class="hljs-number">1</span>);<br>        <span class="hljs-built_in">quickSortOptimized</span>(arr, pi + <span class="hljs-number">1</span>, high);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="归并排序"><a href="#归并排序" class="headerlink" title="归并排序"></a><a class="markdownIt-Anchor" href="#归并排序"></a> 归并排序</h3>
<h3 id="堆排序"><a href="#堆排序" class="headerlink" title="堆排序"></a><a class="markdownIt-Anchor" href="#堆排序"></a> 堆排序</h3>
<h3 id="计数排序"><a href="#计数排序" class="headerlink" title="计数排序"></a><a class="markdownIt-Anchor" href="#计数排序"></a> 计数排序</h3>
<h3 id="基数排序"><a href="#基数排序" class="headerlink" title="基数排序"></a><a class="markdownIt-Anchor" href="#基数排序"></a> 基数排序</h3>
<h2 id="搜索"><a href="#搜索" class="headerlink" title="搜索"></a><a class="markdownIt-Anchor" href="#搜索"></a> 搜索</h2>
<h3 id="线性搜索"><a href="#线性搜索" class="headerlink" title="线性搜索"></a><a class="markdownIt-Anchor" href="#线性搜索"></a> 线性搜索</h3>
<h3 id="二分搜索"><a href="#二分搜索" class="headerlink" title="二分搜索"></a><a class="markdownIt-Anchor" href="#二分搜索"></a> 二分搜索</h3>
<h3 id="插值搜索"><a href="#插值搜索" class="headerlink" title="插值搜索"></a><a class="markdownIt-Anchor" href="#插值搜索"></a> 插值搜索</h3>
<h3 id="跳表"><a href="#跳表" class="headerlink" title="跳表"></a><a class="markdownIt-Anchor" href="#跳表"></a> 跳表</h3>
<h1 id="异或操作xor"><a href="#异或操作xor" class="headerlink" title="异或操作xor"></a><a class="markdownIt-Anchor" href="#异或操作xor"></a> 异或操作（XOR）</h1>
<ol>
<li>基本概念</li>
</ol>
<p>运算符：^</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">int</span> a = <span class="hljs-number">5</span>;    <span class="hljs-comment">// 二进制: 0101</span><br><span class="hljs-type">int</span> b = <span class="hljs-number">3</span>;    <span class="hljs-comment">// 二进制: 0011</span><br><span class="hljs-type">int</span> c = a ^ b; <span class="hljs-comment">// 结果: 0110 (十进制 6)</span><br><br></code></pre></td></tr></table></figure>
<p>异或运算规则表</p>
<p>A  B    A ^ B<br />
0  0    0<br />
0  1    1<br />
1  0    1<br />
1  1    0</p>
<p>口诀：相同为0，不同为1</p>
<ol start="2">
<li>基本性质</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 1. 自反性</span><br>x ^ x = <span class="hljs-number">0</span>       <span class="hljs-comment">// 自己异或自己等于0</span><br><br><span class="hljs-comment">// 2. 与0异或</span><br>x ^ <span class="hljs-number">0</span> = x       <span class="hljs-comment">// 任何数异或0等于自己</span><br><br><span class="hljs-comment">// 3. 交换律</span><br>a ^ b = b ^ a<br><br><span class="hljs-comment">// 4. 结合律</span><br>(a ^ b) ^ c = a ^ (b ^ c)<br><br><span class="hljs-comment">// 5. 可逆性（重要！）</span><br><span class="hljs-keyword">if</span> a ^ b = c<br>then a = c ^ b<br><span class="hljs-keyword">and</span> b = c ^ a<br><br></code></pre></td></tr></table></figure>
<ol start="3">
<li>常见用途</li>
</ol>
<p>3.1 交换两个数（不推荐！）</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">int</span> a = <span class="hljs-number">5</span>, b = <span class="hljs-number">3</span>;<br>a = a ^ b;  <span class="hljs-comment">// a = 5 ^ 3 = 6</span><br>b = a ^ b;  <span class="hljs-comment">// b = 6 ^ 3 = 5</span><br>a = a ^ b;  <span class="hljs-comment">// a = 6 ^ 5 = 3</span><br><span class="hljs-comment">// 现在 a=3, b=5</span><br><br><span class="hljs-comment">// ⚠️ 问题：如果 a 和 b 是同一个变量</span><br><span class="hljs-type">int</span> x = <span class="hljs-number">5</span>;<br>x = x ^ x;  <span class="hljs-comment">// x = 0</span><br>x = x ^ x;  <span class="hljs-comment">// x = 0</span><br>x = x ^ x;  <span class="hljs-comment">// x = 0</span><br><span class="hljs-comment">// 结果 x 变成了 0！</span><br><br></code></pre></td></tr></table></figure>
<p>3.2 找出唯一不重复的数</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 题目：数组中除了一个数出现一次，其他都出现两次</span><br>vector&lt;<span class="hljs-type">int</span>&gt; nums = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>&#125;;<br><span class="hljs-type">int</span> result = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> num : nums) &#123;<br>    result ^= num;  <span class="hljs-comment">// 依次异或</span><br>&#125;<br><span class="hljs-comment">// result = 4（只出现一次的数）</span><br><br><span class="hljs-comment">// 原理：a ^ a = 0，成对的会抵消</span><br><span class="hljs-comment">// 1^1=0, 2^2=0, 3^3=0，最后剩下4</span><br><br></code></pre></td></tr></table></figure>
<p>3.3 判断两个数是否符号相反</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">oppositeSign</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> (x ^ y) &lt; <span class="hljs-number">0</span>;  <span class="hljs-comment">// 异或结果的最高位为1表示符号不同</span><br>&#125;<br><br><span class="hljs-comment">// 示例</span><br><span class="hljs-built_in">oppositeSign</span>(<span class="hljs-number">5</span>, <span class="hljs-number">-3</span>);   <span class="hljs-comment">// true</span><br><span class="hljs-built_in">oppositeSign</span>(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>);    <span class="hljs-comment">// false</span><br><span class="hljs-built_in">oppositeSign</span>(<span class="hljs-number">-5</span>, <span class="hljs-number">-3</span>);  <span class="hljs-comment">// false</span><br><br></code></pre></td></tr></table></figure>
<p>3.4 加密/解密（简单XOR加密）</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">char</span> <span class="hljs-title">encrypt</span><span class="hljs-params">(<span class="hljs-type">char</span> data, <span class="hljs-type">char</span> key)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> data ^ key;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">char</span> <span class="hljs-title">decrypt</span><span class="hljs-params">(<span class="hljs-type">char</span> encrypted, <span class="hljs-type">char</span> key)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> encrypted ^ key;  <span class="hljs-comment">// 同一个key异或两次恢复原数据</span><br>&#125;<br><br><span class="hljs-comment">// 示例</span><br><span class="hljs-type">char</span> data = <span class="hljs-string">&#x27;A&#x27;</span>;     <span class="hljs-comment">// 65</span><br><span class="hljs-type">char</span> key = <span class="hljs-number">0x55</span>;     <span class="hljs-comment">// 密钥</span><br><span class="hljs-type">char</span> encrypted = <span class="hljs-built_in">encrypt</span>(data, key);<br><span class="hljs-type">char</span> decrypted = <span class="hljs-built_in">decrypt</span>(encrypted, key);<br><span class="hljs-comment">// decrypted 又变回 &#x27;A&#x27;</span><br><br></code></pre></td></tr></table></figure>
<ol start="4">
<li>位操作技巧</li>
</ol>
<p>4.1 翻转特定位</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 翻转第k位（0-based）</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">flipBit</span><span class="hljs-params">(<span class="hljs-type">int</span> num, <span class="hljs-type">int</span> k)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> num ^ (<span class="hljs-number">1</span> &lt;&lt; k);<br>&#125;<br><br><span class="hljs-comment">// 示例：翻转 13(1101) 的第1位</span><br><span class="hljs-comment">// 13 ^ (1&lt;&lt;1) = 13 ^ 2 = 15(1111)</span><br><br></code></pre></td></tr></table></figure>
<p>4.2 判断某位是否为1</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">isBitSet</span><span class="hljs-params">(<span class="hljs-type">int</span> num, <span class="hljs-type">int</span> k)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> (num &gt;&gt; k) &amp; <span class="hljs-number">1</span>;  <span class="hljs-comment">// 与运算，不是异或</span><br>&#125;<br><br><span class="hljs-comment">// 如果用异或判断会怎样？</span><br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">wrongWay</span><span class="hljs-params">(<span class="hljs-type">int</span> num, <span class="hljs-type">int</span> k)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> (num ^ (<span class="hljs-number">1</span> &lt;&lt; k)) &lt; num;  <span class="hljs-comment">// ❌ 不准确</span><br>&#125;<br><br></code></pre></td></tr></table></figure>
<p>4.3 不用比较找最小值/最大值</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 找到两个数中的最小值（不用if）</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">min</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> y ^ ((x ^ y) &amp; -(x &lt; y));<br>&#125;<br><br><span class="hljs-comment">// 找到两个数中的最大值</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">max</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> x ^ ((x ^ y) &amp; -(x &lt; y));<br>&#125;<br><br></code></pre></td></tr></table></figure>
<ol start="5">
<li>实际应用示例</li>
</ol>
<p>5.1 校验和计算</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 简单的奇偶校验</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">parityCheck</span><span class="hljs-params">(<span class="hljs-type">const</span> vector&lt;<span class="hljs-type">int</span>&gt;&amp; data)</span> </span>&#123;<br>    <span class="hljs-type">int</span> checksum = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> byte : data) &#123;<br>        checksum ^= byte;  <span class="hljs-comment">// 异或所有字节</span><br>    &#125;<br>    <span class="hljs-keyword">return</span> checksum;<br>&#125;<br><br><span class="hljs-comment">// 传输时：发送 data + checksum</span><br><span class="hljs-comment">// 接收时：重新计算checksum，与收到的比较</span><br><br></code></pre></td></tr></table></figure>
<p>5.2 图形学中的透明混合</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// XOR绘图模式（老式图形编程）</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">drawXorMode</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-comment">// 第一次画：显示</span><br>    pixel = pixel ^ color;<br><br>    <span class="hljs-comment">// 在同一位置再画一次：擦除（恢复原状）</span><br>    pixel = pixel ^ color;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<p>5.3 游戏开发：切换状态</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 使用异或切换布尔状态</span><br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">toggle</span><span class="hljs-params">(<span class="hljs-type">bool</span> state)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> state ^ <span class="hljs-literal">true</span>;  <span class="hljs-comment">// 等价于 !state</span><br>&#125;<br><br><span class="hljs-comment">// 或直接</span><br>state ^= <span class="hljs-number">1</span>;  <span class="hljs-comment">// 0变1，1变0</span><br><br></code></pre></td></tr></table></figure>
<ol start="6">
<li>注意事项和陷阱</li>
</ol>
<p>6.1 优先级问题</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">int</span> a = <span class="hljs-number">5</span>, b = <span class="hljs-number">3</span>, c = <span class="hljs-number">2</span>;<br><span class="hljs-type">int</span> result1 = a ^ b &amp; c;   <span class="hljs-comment">// 错误！&amp; 优先级高于 ^</span><br><span class="hljs-comment">// 实际是：a ^ (b &amp; c) = 5 ^ 2 = 7</span><br><br><span class="hljs-type">int</span> result2 = (a ^ b) &amp; c; <span class="hljs-comment">// 正确：先异或，再与</span><br><span class="hljs-comment">// (5^3) &amp; 2 = 6 &amp; 2 = 2</span><br><br><span class="hljs-comment">// 总是加括号！</span><br><br></code></pre></td></tr></table></figure>
<p>6.2 类型转换问题</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">char</span> c1 = <span class="hljs-number">0xFF</span>;    <span class="hljs-comment">// -1 (有符号)</span><br><span class="hljs-type">char</span> c2 = <span class="hljs-number">0x7F</span>;    <span class="hljs-comment">// 127</span><br><span class="hljs-type">int</span> result = c1 ^ c2;  <span class="hljs-comment">// 会进行符号扩展！</span><br><br><span class="hljs-comment">// 最好使用无符号类型</span><br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> uc1 = <span class="hljs-number">0xFF</span>;  <span class="hljs-comment">// 255</span><br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> uc2 = <span class="hljs-number">0x7F</span>;  <span class="hljs-comment">// 127</span><br><br></code></pre></td></tr></table></figure>
<p>6.3 不要用于浮点数！</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">float</span> f1 = <span class="hljs-number">3.14f</span>;<br><span class="hljs-type">float</span> f2 = <span class="hljs-number">2.71f</span>;<br><span class="hljs-type">float</span> bad = f1 ^ f2;  <span class="hljs-comment">// ❌ 编译错误！不能对浮点数异或</span><br><br></code></pre></td></tr></table></figure>
<ol start="7">
<li>性能考虑</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 异或通常是CPU最快的操作之一</span><br><span class="hljs-comment">// 在现代CPU上，与加法/减法速度相当</span><br><br><span class="hljs-comment">// 但编译器优化可能更好</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">traditionalSwap</span><span class="hljs-params">(<span class="hljs-type">int</span>&amp; a, <span class="hljs-type">int</span>&amp; b)</span> </span>&#123;<br>    <span class="hljs-type">int</span> temp = a;<br>    a = b;<br>    b = temp;<br>&#125;<br><br><span class="hljs-comment">// 编译器可能会优化为寄存器交换</span><br><span class="hljs-comment">// 不要手动用异或&quot;优化&quot;，编译器更聪明</span><br><br></code></pre></td></tr></table></figure>
<h1 id="输入与输出"><a href="#输入与输出" class="headerlink" title="输入与输出"></a><a class="markdownIt-Anchor" href="#输入与输出"></a> 输入与输出</h1>
<h2 id="输入"><a href="#输入" class="headerlink" title="输入"></a><a class="markdownIt-Anchor" href="#输入"></a> 输入</h2>
<hr />
<p>基本语法</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-comment">// 单个变量</span><br>cin &gt;&gt; variable;<br><br><span class="hljs-comment">// 多个变量（链式输入）</span><br>cin &gt;&gt; var1 &gt;&gt; var2 &gt;&gt; var3;<br></code></pre></td></tr></table></figure>
<hr />
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">数据类型  读取行为             停止条件           示例输入 → 结果<br>int      读取整数             遇到非数字字符      &quot;123abc&quot; → 123<br>double   读取浮点数           遇到非数字/非小数点  &quot;3.14abc&quot; → 3.14<br>char     读取第一个非空白字符   读取1个字符         &quot;  A&quot; → &#x27;A&#x27;<br>string   读取到下一个空白字符   空格/制表符/换行     &quot;Hello World&quot; → &quot;Hello&quot;<br>bool     读取布尔值           0/1 或 true/false  &quot;1&quot; → true<br></code></pre></td></tr></table></figure>
<hr />
<p>重要注意事项</p>
<ol>
<li>空白字符处理</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 空白字符包括：空格(&#x27; &#x27;)、制表符(&#x27;\\t&#x27;)、换行符(&#x27;\\n&#x27;)</span><br>cin &gt;&gt; var;  <span class="hljs-comment">// 会自动跳过前导空白字符</span><br></code></pre></td></tr></table></figure>
<ol start="2">
<li>读取会留下分隔符</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">int</span> a;<br><span class="hljs-type">char</span> ch;<br>string s;<br><br>cin &gt;&gt; a;    <span class="hljs-comment">// 输入 &quot;123\\n&quot;，读取 123，留下 \\n</span><br>cin &gt;&gt; ch;   <span class="hljs-comment">// 直接读取 \\n，不会等待输入！</span><br></code></pre></td></tr></table></figure>
<ol start="3">
<li>混合类型输入问题</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">int</span> age;<br>string name;<br><br><span class="hljs-comment">//  错误写法</span><br>cout &lt;&lt; <span class="hljs-string">&quot;年龄: &quot;</span>;<br>cin &gt;&gt; age;          <span class="hljs-comment">// 输入 &quot;25\\n&quot;</span><br>cout &lt;&lt; <span class="hljs-string">&quot;姓名: &quot;</span>;<br><span class="hljs-built_in">getline</span>(cin, name);  <span class="hljs-comment">// 立即读取到空字符串！</span><br><br><span class="hljs-comment">//  正确写法</span><br>cout &lt;&lt; <span class="hljs-string">&quot;年龄: &quot;</span>;<br>cin &gt;&gt; age;<br>cin.<span class="hljs-built_in">ignore</span>();        <span class="hljs-comment">// 清除缓冲区的换行符</span><br>cout &lt;&lt; <span class="hljs-string">&quot;姓名: &quot;</span>;<br><span class="hljs-built_in">getline</span>(cin, name);  <span class="hljs-comment">// 正常等待输入</span><br></code></pre></td></tr></table></figure>
<hr />
<p>成员函数</p>
<ol>
<li>get() - 读取字符</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">char</span> ch;<br><br><span class="hljs-comment">// 读取单个字符（包括空白字符）</span><br>ch = cin.<span class="hljs-built_in">get</span>();           <span class="hljs-comment">// 读取1字符</span><br><br><span class="hljs-comment">// 读取到缓冲区</span><br><span class="hljs-type">char</span> buffer[<span class="hljs-number">100</span>];<br>cin.<span class="hljs-built_in">get</span>(buffer, <span class="hljs-number">100</span>);     <span class="hljs-comment">// 读取一行，不丢弃换行符</span><br>cin.<span class="hljs-built_in">get</span>(buffer, <span class="hljs-number">100</span>, <span class="hljs-string">&#x27;;&#x27;</span>);<span class="hljs-comment">// 读取到分号</span><br></code></pre></td></tr></table></figure>
<ol start="2">
<li>getline() - 读取一行</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">char</span> buffer[<span class="hljs-number">100</span>];<br>cin.<span class="hljs-built_in">getline</span>(buffer, <span class="hljs-number">100</span>);      <span class="hljs-comment">// 读取一行，丢弃换行符</span><br>cin.<span class="hljs-built_in">getline</span>(buffer, <span class="hljs-number">100</span>, <span class="hljs-string">&#x27;#&#x27;</span>); <span class="hljs-comment">// 读取到 # 号</span><br></code></pre></td></tr></table></figure>
<ol start="3">
<li>ignore() - 忽略字符</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 忽略下一个字符</span><br>cin.<span class="hljs-built_in">ignore</span>();<br><br><span class="hljs-comment">// 忽略最多100个字符，或直到遇到换行符</span><br>cin.<span class="hljs-built_in">ignore</span>(<span class="hljs-number">100</span>, <span class="hljs-string">&#x27;\\n&#x27;</span>);<br><br><span class="hljs-comment">// 忽略所有剩余字符直到换行</span><br>cin.<span class="hljs-built_in">ignore</span>(numeric_limits&lt;streamsize&gt;::<span class="hljs-built_in">max</span>(), <span class="hljs-string">&#x27;\\n&#x27;</span>);<br></code></pre></td></tr></table></figure>
<ol start="4">
<li>peek() - 查看下一个字符</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">char</span> next = cin.<span class="hljs-built_in">peek</span>();  <span class="hljs-comment">// 查看但不提取下一个字符</span><br><br></code></pre></td></tr></table></figure>
<ol start="5">
<li>putback() - 放回字符</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">char</span> ch = cin.<span class="hljs-built_in">get</span>();<br>cin.<span class="hljs-built_in">putback</span>(ch);  <span class="hljs-comment">// 将字符放回输入流</span><br></code></pre></td></tr></table></figure>
<hr />
<h2 id="输出"><a href="#输出" class="headerlink" title="输出"></a><a class="markdownIt-Anchor" href="#输出"></a> 输出</h2>
<p>核心输出对象</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br>cout    <span class="hljs-comment">// 标准输出（屏幕）</span><br>cerr    <span class="hljs-comment">// 标准错误输出（无缓冲，立即显示）</span><br>clog    <span class="hljs-comment">// 标准日志输出（有缓冲）</span><br></code></pre></td></tr></table></figure>
<hr />
<p>基础输出语法</p>
<ol>
<li>基本用法</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cpp">cout &lt;&lt; <span class="hljs-string">&quot;Hello World!&quot;</span>;           <span class="hljs-comment">// 输出字符串</span><br>cout &lt;&lt; <span class="hljs-number">42</span>;                       <span class="hljs-comment">// 输出整数</span><br>cout &lt;&lt; <span class="hljs-number">3.14</span>;                     <span class="hljs-comment">// 输出浮点数</span><br>cout &lt;&lt; <span class="hljs-literal">true</span>;                     <span class="hljs-comment">// 输出布尔值</span><br></code></pre></td></tr></table></figure>
<ol start="2">
<li>链式输出</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">int</span> age = <span class="hljs-number">25</span>;<br><span class="hljs-type">double</span> salary = <span class="hljs-number">5000.5</span>;<br>string name = <span class="hljs-string">&quot;张三&quot;</span>;<br><br>cout &lt;&lt; <span class="hljs-string">&quot;姓名: &quot;</span> &lt;&lt; name<br>     &lt;&lt; <span class="hljs-string">&quot;, 年龄: &quot;</span> &lt;&lt; age<br>     &lt;&lt; <span class="hljs-string">&quot;, 工资: &quot;</span> &lt;&lt; salary &lt;&lt; endl;<br></code></pre></td></tr></table></figure>
<ol start="3">
<li>换行控制</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs cpp">cout &lt;&lt; <span class="hljs-string">&quot;第一行&quot;</span> &lt;&lt; endl;        <span class="hljs-comment">// 换行并刷新缓冲区</span><br>cout &lt;&lt; <span class="hljs-string">&quot;第二行\\n&quot;</span>;              <span class="hljs-comment">// 只换行，不刷新缓冲区</span><br>cout &lt;&lt; <span class="hljs-string">&quot;第三行&quot;</span> &lt;&lt; <span class="hljs-string">&#x27;\\n&#x27;</span>;        <span class="hljs-comment">// 字符换行</span><br></code></pre></td></tr></table></figure>
<ol start="4">
<li>数组输出</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#include &lt;iostream&gt;</span><br>using namespace std;<br><br>int <span class="hljs-function"><span class="hljs-title">main</span></span>() &#123;<br>    int arr[5] = &#123;1, 2, 3, 4, 5&#125;;<br>    <br>    // 使用 <span class="hljs-keyword">for</span> 循环<br>    <span class="hljs-keyword">for</span>(int i = 0; i &lt; 5; i++) &#123;<br>        cout &lt;&lt; <span class="hljs-string">arr[i] &lt;&lt; &quot; &quot;;</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">    cout &lt;&lt; endl;</span><br><span class="hljs-string">    </span><br><span class="hljs-string">    // 使用范围 for 循环（C++11 及以上）</span><br><span class="hljs-string">    for(int num : arr</span>) &#123;<br>        cout &lt;&lt; <span class="hljs-string">num &lt;&lt; &quot; &quot;;</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">    cout &lt;&lt; endl;</span><br><span class="hljs-string">    </span><br><span class="hljs-string">    return 0;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">#include &lt;iostream&gt;</span><br><span class="hljs-string">using namespace std;</span><br><span class="hljs-string"></span><br><span class="hljs-string">int main() &#123;</span><br><span class="hljs-string">    int arr[5] = &#123;10, 20, 30, 40, 50&#125;;</span><br><span class="hljs-string">    int* ptr = arr; // 指向数组首元素</span><br><span class="hljs-string">    </span><br><span class="hljs-string">    for(int i = 0; i &lt; 5; i++) &#123;</span><br><span class="hljs-string">        cout &lt;&lt; *(ptr + i) &lt;&lt; &quot; &quot;;</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">    cout &lt;&lt; endl;</span><br><span class="hljs-string">    </span><br><span class="hljs-string">    return 0;</span><br><span class="hljs-string">&#125;</span><br></code></pre></td></tr></table></figure>
<hr />
<p>格式化输出（头文件：<iomanip>）</p>
<ol>
<li>整数格式化</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iomanip&gt;</span></span><br><br><span class="hljs-type">int</span> num = <span class="hljs-number">255</span>;<br><br><span class="hljs-comment">// 进制输出</span><br>cout &lt;&lt; dec &lt;&lt; num &lt;&lt; endl;      <span class="hljs-comment">// 255（十进制，默认）</span><br>cout &lt;&lt; hex &lt;&lt; num &lt;&lt; endl;      <span class="hljs-comment">// ff（十六进制）</span><br>cout &lt;&lt; oct &lt;&lt; num &lt;&lt; endl;      <span class="hljs-comment">// 377（八进制）</span><br><br><span class="hljs-comment">// 显示进制前缀</span><br>cout &lt;&lt; showbase;<br>cout &lt;&lt; hex &lt;&lt; num &lt;&lt; endl;      <span class="hljs-comment">// 0xff</span><br>cout &lt;&lt; oct &lt;&lt; num &lt;&lt; endl;      <span class="hljs-comment">// 0377</span><br><br><span class="hljs-comment">// 控制字母大小写</span><br>cout &lt;&lt; uppercase &lt;&lt; hex &lt;&lt; num &lt;&lt; endl;   <span class="hljs-comment">// 0xFF</span><br>cout &lt;&lt; nouppercase &lt;&lt; hex &lt;&lt; num &lt;&lt; endl; <span class="hljs-comment">// 0xff</span><br></code></pre></td></tr></table></figure>
<ol start="2">
<li>浮点数格式化</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">double</span> pi = <span class="hljs-number">3.14159265358979</span>;<br><br><span class="hljs-comment">// 固定小数位数</span><br>cout &lt;&lt; fixed &lt;&lt; <span class="hljs-built_in">setprecision</span>(<span class="hljs-number">2</span>) &lt;&lt; pi &lt;&lt; endl;    <span class="hljs-comment">// 3.14</span><br>cout &lt;&lt; fixed &lt;&lt; <span class="hljs-built_in">setprecision</span>(<span class="hljs-number">4</span>) &lt;&lt; pi &lt;&lt; endl;    <span class="hljs-comment">// 3.1416</span><br><br><span class="hljs-comment">// 科学计数法</span><br>cout &lt;&lt; scientific &lt;&lt; <span class="hljs-built_in">setprecision</span>(<span class="hljs-number">2</span>) &lt;&lt; pi &lt;&lt; endl;  <span class="hljs-comment">// 3.14e+00</span><br><br><span class="hljs-comment">// 显示小数点</span><br>cout &lt;&lt; showpoint &lt;&lt; <span class="hljs-number">10.0</span> &lt;&lt; endl;     <span class="hljs-comment">// 10.0000（默认精度）</span><br>cout &lt;&lt; noshowpoint &lt;&lt; <span class="hljs-number">10.0</span> &lt;&lt; endl;   <span class="hljs-comment">// 10</span><br><br><span class="hljs-comment">// 显示正数符号</span><br>cout &lt;&lt; showpos &lt;&lt; <span class="hljs-number">42</span> &lt;&lt; endl;         <span class="hljs-comment">// +42</span><br>cout &lt;&lt; noshowpos &lt;&lt; <span class="hljs-number">42</span> &lt;&lt; endl;       <span class="hljs-comment">// 42</span><br></code></pre></td></tr></table></figure>
<ol start="3">
<li>字段宽度和对齐</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">int</span> num = <span class="hljs-number">123</span>;<br>string text = <span class="hljs-string">&quot;Hello&quot;</span>;<br><br><span class="hljs-comment">// 设置宽度（只对下一个输出有效）</span><br>cout &lt;&lt; <span class="hljs-built_in">setw</span>(<span class="hljs-number">10</span>) &lt;&lt; num &lt;&lt; endl;       <span class="hljs-comment">// &quot;       123&quot;</span><br>cout &lt;&lt; <span class="hljs-built_in">setw</span>(<span class="hljs-number">10</span>) &lt;&lt; text &lt;&lt; endl;      <span class="hljs-comment">// &quot;     Hello&quot;</span><br><br><span class="hljs-comment">// 对齐方式</span><br>cout &lt;&lt; left &lt;&lt; <span class="hljs-built_in">setw</span>(<span class="hljs-number">10</span>) &lt;&lt; num &lt;&lt; endl;                <span class="hljs-comment">// &quot;123       &quot;</span><br>cout &lt;&lt; right &lt;&lt; <span class="hljs-built_in">setw</span>(<span class="hljs-number">10</span>) &lt;&lt; num &lt;&lt; endl;               <span class="hljs-comment">// &quot;       123&quot;</span><br>cout &lt;&lt; internal &lt;&lt; <span class="hljs-built_in">setw</span>(<span class="hljs-number">10</span>) &lt;&lt; showpos &lt;&lt; num &lt;&lt; endl; <span class="hljs-comment">// &quot;+      123&quot;</span><br>                           <span class="hljs-comment">//  noshowpos（控制符号显示或隐藏）</span><br><br><span class="hljs-comment">// 填充字符</span><br>cout &lt;&lt; <span class="hljs-built_in">setfill</span>(<span class="hljs-string">&#x27;*&#x27;</span>) &lt;&lt; <span class="hljs-built_in">setw</span>(<span class="hljs-number">10</span>) &lt;&lt; num &lt;&lt; endl;  <span class="hljs-comment">// &quot;*******123&quot;</span><br>cout &lt;&lt; <span class="hljs-built_in">setfill</span>(<span class="hljs-string">&#x27; &#x27;</span>);  <span class="hljs-comment">// 恢复空格填充</span><br></code></pre></td></tr></table></figure>
<hr />
<p>特殊字符输出</p>
<ol>
<li>转义字符</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs cpp">cout &lt;&lt; <span class="hljs-string">&quot;换行: 第一行\n第二行&quot;</span> &lt;&lt; endl;<br>cout &lt;&lt; <span class="hljs-string">&quot;制表符: 姓名\t年龄&quot;</span> &lt;&lt; endl;<br>cout &lt;&lt; <span class="hljs-string">&quot;双引号: \&quot;Hello\&quot;&quot;</span> &lt;&lt; endl;<br>cout &lt;&lt; <span class="hljs-string">&quot;单引号: \&#x27;C++\&#x27;&quot;</span> &lt;&lt; endl;<br>cout &lt;&lt; <span class="hljs-string">&quot;反斜杠: C:\\Program Files\\&quot;</span> &lt;&lt; endl;<br>cout &lt;&lt; <span class="hljs-string">&quot;回车: 进度条&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\r&quot;</span> &lt;&lt; <span class="hljs-string">&quot;完成&quot;</span> &lt;&lt; endl;  <span class="hljs-comment">// 回车到行首</span><br>cout &lt;&lt; <span class="hljs-string">&quot;蜂鸣: \a&quot;</span> &lt;&lt; endl;  <span class="hljs-comment">// 发出声音</span><br></code></pre></td></tr></table></figure>
<ol start="2">
<li>转义字符标</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs cpp">转义序列 含义 ASCII码 说明<br>\a 警报 (Alert/蜂鸣) <span class="hljs-number">7</span> 发出声音<br>\b 退格 (Backspace) <span class="hljs-number">8</span> 后退一格<br>\t 水平制表符 (Tab) <span class="hljs-number">9</span> 对齐用<br>\n 换行 (Newline) <span class="hljs-number">10</span> 新的一行<br>\v 垂直制表符 <span class="hljs-number">11</span> 垂直对齐<br>\f 换页 (Form feed) <span class="hljs-number">12</span> 打印机换页<br>\r 回车 (Carriage <span class="hljs-keyword">return</span>) <span class="hljs-number">13</span> 回到行首<br>\\ 反斜杠 <span class="hljs-number">92</span> 输出 \<br>\<span class="hljs-string">&#x27; 单引号 39 输出 &#x27;</span><br>\<span class="hljs-string">&quot; 双引号 34 输出 &quot;</span><br>\? 问号 <span class="hljs-number">63</span> 输出 ?<br>\<span class="hljs-number">0</span> 空字符 (Null) <span class="hljs-number">0</span> 字符串结束符<br></code></pre></td></tr></table></figure>
<h1 id="内置函数"><a href="#内置函数" class="headerlink" title="内置函数"></a><a class="markdownIt-Anchor" href="#内置函数"></a> 内置函数</h1>
<h2 id="一-字符串处理string"><a href="#一-字符串处理string" class="headerlink" title="一-字符串处理string"></a><a class="markdownIt-Anchor" href="#一-字符串处理string"></a> 一、字符串处理（<string>）</h2>
<ol>
<li>长度相关</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br>string str = <span class="hljs-string">&quot;Hello&quot;</span>;<br><br><span class="hljs-comment">// 获取长度/大小（效果一样）</span><br><span class="hljs-type">int</span> len1 = str.<span class="hljs-built_in">length</span>();    <span class="hljs-comment">// 5</span><br><span class="hljs-type">int</span> len2 = str.<span class="hljs-built_in">size</span>();      <span class="hljs-comment">// 5（推荐用这个，和容器一致）</span><br><br><span class="hljs-comment">// 检查是否为空</span><br><span class="hljs-type">bool</span> isEmpty = str.<span class="hljs-built_in">empty</span>();  <span class="hljs-comment">// false</span><br></code></pre></td></tr></table></figure>
<ol start="2">
<li>查找与截取</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs cpp">string str = <span class="hljs-string">&quot;Hello World&quot;</span>;<br><br><span class="hljs-comment">// 查找子串位置</span><br><span class="hljs-type">size_t</span> pos = str.<span class="hljs-built_in">find</span>(<span class="hljs-string">&quot;World&quot;</span>);  <span class="hljs-comment">// 6（从0开始计数）</span><br><span class="hljs-type">size_t</span> notFound = str.<span class="hljs-built_in">find</span>(<span class="hljs-string">&quot;abc&quot;</span>); <span class="hljs-comment">// string::npos（很大的数）</span><br><br><span class="hljs-comment">// 从后往前查找</span><br>pos = str.<span class="hljs-built_in">rfind</span>(<span class="hljs-string">&quot;o&quot;</span>);  <span class="hljs-comment">// 7（最后一个o的位置）</span><br><br><span class="hljs-comment">// 检查是否包含</span><br><span class="hljs-keyword">if</span> (str.<span class="hljs-built_in">find</span>(<span class="hljs-string">&quot;World&quot;</span>) != string::npos) &#123;<br>    cout &lt;&lt; <span class="hljs-string">&quot;包含World&quot;</span> &lt;&lt; endl;<br>&#125;<br><br><span class="hljs-comment">// 截取子串</span><br>string sub1 = str.<span class="hljs-built_in">substr</span>(<span class="hljs-number">6</span>);      <span class="hljs-comment">// &quot;World&quot;（从位置6到结尾）</span><br>string sub2 = str.<span class="hljs-built_in">substr</span>(<span class="hljs-number">0</span>, <span class="hljs-number">5</span>);   <span class="hljs-comment">// &quot;Hello&quot;（从0开始，取5个字符）</span><br>string sub3 = str.<span class="hljs-built_in">substr</span>(<span class="hljs-number">6</span>, <span class="hljs-number">5</span>);   <span class="hljs-comment">// &quot;World&quot;</span><br></code></pre></td></tr></table></figure>
<ol start="3">
<li>修改与连接</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 追加</span><br>str.<span class="hljs-built_in">append</span>(<span class="hljs-string">&quot;!!!&quot;</span>);        <span class="hljs-comment">// &quot;Hello World!!!&quot;</span><br>str += <span class="hljs-string">&quot;!!!&quot;</span>;             <span class="hljs-comment">// 同样效果</span><br><br><span class="hljs-comment">// 插入</span><br>str.<span class="hljs-built_in">insert</span>(<span class="hljs-number">5</span>, <span class="hljs-string">&quot; C++&quot;</span>);    <span class="hljs-comment">// &quot;Hello C++ World&quot;</span><br><br><span class="hljs-comment">// 替换</span><br>str.<span class="hljs-built_in">replace</span>(<span class="hljs-number">6</span>, <span class="hljs-number">5</span>, <span class="hljs-string">&quot;C++&quot;</span>); <span class="hljs-comment">// &quot;Hello C++&quot;（从位置6开始替换5个字符）</span><br><br><span class="hljs-comment">// 删除</span><br>str.<span class="hljs-built_in">erase</span>(<span class="hljs-number">5</span>, <span class="hljs-number">4</span>);          <span class="hljs-comment">// 删除位置5开始的4个字符</span><br>str.<span class="hljs-built_in">clear</span>();              <span class="hljs-comment">// 清空字符串</span><br><br></code></pre></td></tr></table></figure>
<ol start="4">
<li>字符访问与修改</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 访问字符（类似数组）</span><br><span class="hljs-type">char</span> ch = str[<span class="hljs-number">0</span>];      <span class="hljs-comment">// &#x27;H&#x27;</span><br><span class="hljs-type">char</span> ch2 = str.<span class="hljs-built_in">at</span>(<span class="hljs-number">0</span>);  <span class="hljs-comment">// &#x27;H&#x27;（会检查边界，越界会抛异常）</span><br><br><span class="hljs-comment">// 修改字符</span><br>str[<span class="hljs-number">0</span>] = <span class="hljs-string">&#x27;h&#x27;</span>;          <span class="hljs-comment">// &quot;hello World&quot;</span><br>str.<span class="hljs-built_in">at</span>(<span class="hljs-number">1</span>) = <span class="hljs-string">&#x27;E&#x27;</span>;       <span class="hljs-comment">// &quot;hEllo World&quot;</span><br><br><span class="hljs-comment">// 获取C风格字符串</span><br><span class="hljs-type">const</span> <span class="hljs-type">char</span>* cstr = str.<span class="hljs-built_in">c_str</span>();  <span class="hljs-comment">// 用于需要char*参数的函数</span><br></code></pre></td></tr></table></figure>
<h2 id="二-字符处理cctype"><a href="#二-字符处理cctype" class="headerlink" title="二-字符处理cctype"></a><a class="markdownIt-Anchor" href="#二-字符处理cctype"></a> 二、字符处理（<cctype>）</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cctype&gt;</span></span><br><br><span class="hljs-type">char</span> ch = <span class="hljs-string">&#x27;A&#x27;</span>;<br><br><span class="hljs-comment">// 类型判断</span><br><span class="hljs-built_in">isalpha</span>(ch);  <span class="hljs-comment">// 是否字母（a-z, A-Z）→ true</span><br><span class="hljs-built_in">isdigit</span>(ch);  <span class="hljs-comment">// 是否数字（0-9）→ false</span><br><span class="hljs-built_in">isalnum</span>(ch);  <span class="hljs-comment">// 是否字母或数字 → true</span><br><span class="hljs-built_in">isspace</span>(ch);  <span class="hljs-comment">// 是否空白（空格、制表符、换行等）→ false</span><br><span class="hljs-built_in">islower</span>(ch);  <span class="hljs-comment">// 是否小写字母 → false</span><br><span class="hljs-built_in">isupper</span>(ch);  <span class="hljs-comment">// 是否大写字母 → true</span><br><br><span class="hljs-comment">// 大小写转换</span><br><span class="hljs-type">char</span> lower = <span class="hljs-built_in">tolower</span>(<span class="hljs-string">&#x27;A&#x27;</span>);  <span class="hljs-comment">// &#x27;a&#x27;</span><br><span class="hljs-type">char</span> upper = <span class="hljs-built_in">toupper</span>(<span class="hljs-string">&#x27;a&#x27;</span>);  <span class="hljs-comment">// &#x27;A&#x27;</span><br><br><span class="hljs-comment">// 检查可打印字符</span><br><span class="hljs-built_in">isprint</span>(ch);  <span class="hljs-comment">// 是否可打印字符（非控制字符）→ true</span><br></code></pre></td></tr></table></figure>
<h2 id="三-输入输出处理iostream"><a href="#三-输入输出处理iostream" class="headerlink" title="三-输入输出处理iostream"></a><a class="markdownIt-Anchor" href="#三-输入输出处理iostream"></a> 三、输入输出处理（<iostream>）</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-comment">// 输出</span><br>cout &lt;&lt; <span class="hljs-string">&quot;Hello&quot;</span> &lt;&lt; endl;    <span class="hljs-comment">// 输出并换行</span><br>cout &lt;&lt; <span class="hljs-string">&quot;Hello\\n&quot;</span>;          <span class="hljs-comment">// 同样效果</span><br><br><span class="hljs-comment">// 输入</span><br><span class="hljs-type">int</span> num;<br>string name;<br><br>cin &gt;&gt; num;     <span class="hljs-comment">// 读取整数（跳过空白）</span><br>cin &gt;&gt; name;    <span class="hljs-comment">// 读取单词（遇到空白停止）</span><br><br><span class="hljs-comment">// 读取整行</span><br>string line;<br><span class="hljs-built_in">getline</span>(cin, line);  <span class="hljs-comment">// 读取一行（包括空格）</span><br><br><span class="hljs-comment">// 注意：cin &gt;&gt; 和 getline 混用时的问题</span><br><span class="hljs-type">int</span> age;<br>string fullName;<br><br>cin &gt;&gt; age;               <span class="hljs-comment">// 读取数字</span><br>cin.<span class="hljs-built_in">ignore</span>();             <span class="hljs-comment">// 清除缓冲区中的换行符</span><br><span class="hljs-built_in">getline</span>(cin, fullName);   <span class="hljs-comment">// 现在可以正确读取整行</span><br></code></pre></td></tr></table></figure>
<h2 id="四-数学函数cmath"><a href="#四-数学函数cmath" class="headerlink" title="四-数学函数cmath"></a><a class="markdownIt-Anchor" href="#四-数学函数cmath"></a> 四、数学函数（<cmath>）</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cmath&gt;</span></span><br><br><span class="hljs-comment">// 基本运算</span><br><span class="hljs-built_in">abs</span>(<span class="hljs-number">-10</span>);      <span class="hljs-comment">// 绝对值：10</span><br><span class="hljs-built_in">fabs</span>(<span class="hljs-number">-3.14</span>);   <span class="hljs-comment">// 浮点数绝对值：3.14</span><br><span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>);     <span class="hljs-comment">// 2的3次方：8</span><br><span class="hljs-built_in">sqrt</span>(<span class="hljs-number">16</span>);      <span class="hljs-comment">// 平方根：4</span><br><br><span class="hljs-comment">// 四舍五入</span><br><span class="hljs-built_in">round</span>(<span class="hljs-number">3.6</span>);    <span class="hljs-comment">// 4（四舍五入）</span><br><span class="hljs-built_in">ceil</span>(<span class="hljs-number">3.2</span>);     <span class="hljs-comment">// 4（向上取整）</span><br><span class="hljs-built_in">floor</span>(<span class="hljs-number">3.8</span>);    <span class="hljs-comment">// 3（向下取整）</span><br><br><span class="hljs-comment">// 三角函数（参数为弧度）</span><br><span class="hljs-built_in">sin</span>(<span class="hljs-number">3.14159</span>);  <span class="hljs-comment">// 正弦</span><br><span class="hljs-built_in">cos</span>(<span class="hljs-number">3.14159</span>);  <span class="hljs-comment">// 余弦</span><br><span class="hljs-built_in">tan</span>(<span class="hljs-number">3.14159</span>);  <span class="hljs-comment">// 正切</span><br><br><span class="hljs-comment">// 对数和指数</span><br><span class="hljs-built_in">log</span>(<span class="hljs-number">10</span>);       <span class="hljs-comment">// 自然对数</span><br><span class="hljs-built_in">log10</span>(<span class="hljs-number">100</span>);    <span class="hljs-comment">// 以10为底的对数：2</span><br><span class="hljs-built_in">exp</span>(<span class="hljs-number">1</span>);        <span class="hljs-comment">// e的1次方：约2.718</span><br><br><span class="hljs-comment">// 最大值最小值（C++11后）</span><br><span class="hljs-built_in">max</span>(<span class="hljs-number">5</span>, <span class="hljs-number">10</span>);    <span class="hljs-comment">// 10</span><br><span class="hljs-built_in">min</span>(<span class="hljs-number">5</span>, <span class="hljs-number">10</span>);    <span class="hljs-comment">// 5</span><br></code></pre></td></tr></table></figure>
<h2 id="五-算法函数algorithm"><a href="#五-算法函数algorithm" class="headerlink" title="五-算法函数algorithm"></a><a class="markdownIt-Anchor" href="#五-算法函数algorithm"></a> 五、算法函数（<algorithm>）</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;algorithm&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br>vector&lt;<span class="hljs-type">int</span>&gt; nums = &#123;<span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">9</span>&#125;;<br><br><span class="hljs-comment">// 排序</span><br><span class="hljs-built_in">sort</span>(nums.<span class="hljs-built_in">begin</span>(), nums.<span class="hljs-built_in">end</span>());  <span class="hljs-comment">// 升序：1, 1, 3, 4, 5, 9</span><br><span class="hljs-built_in">sort</span>(nums.<span class="hljs-built_in">rbegin</span>(), nums.<span class="hljs-built_in">rend</span>()); <span class="hljs-comment">// 降序</span><br><br><span class="hljs-comment">// 查找</span><br><span class="hljs-keyword">auto</span> it = <span class="hljs-built_in">find</span>(nums.<span class="hljs-built_in">begin</span>(), nums.<span class="hljs-built_in">end</span>(), <span class="hljs-number">4</span>);<br><span class="hljs-keyword">if</span> (it != nums.<span class="hljs-built_in">end</span>()) &#123;<br>    cout &lt;&lt; <span class="hljs-string">&quot;找到了，位置：&quot;</span> &lt;&lt; <span class="hljs-built_in">distance</span>(nums.<span class="hljs-built_in">begin</span>(), it) &lt;&lt; endl;<br>&#125;<br><br><span class="hljs-comment">// 反转</span><br><span class="hljs-built_in">reverse</span>(nums.<span class="hljs-built_in">begin</span>(), nums.<span class="hljs-built_in">end</span>());<br><br><span class="hljs-comment">// 统计</span><br><span class="hljs-type">int</span> countOnes = <span class="hljs-built_in">count</span>(nums.<span class="hljs-built_in">begin</span>(), nums.<span class="hljs-built_in">end</span>(), <span class="hljs-number">1</span>);  <span class="hljs-comment">// 2</span><br><br><span class="hljs-comment">// 最大最小值</span><br><span class="hljs-type">int</span> maxVal = *<span class="hljs-built_in">max_element</span>(nums.<span class="hljs-built_in">begin</span>(), nums.<span class="hljs-built_in">end</span>());  <span class="hljs-comment">// 9</span><br><span class="hljs-type">int</span> minVal = *<span class="hljs-built_in">min_element</span>(nums.<span class="hljs-built_in">begin</span>(), nums.<span class="hljs-built_in">end</span>());  <span class="hljs-comment">// 1</span><br><br><span class="hljs-comment">// 去重（需要先排序）</span><br><span class="hljs-built_in">sort</span>(nums.<span class="hljs-built_in">begin</span>(), nums.<span class="hljs-built_in">end</span>());<br><span class="hljs-keyword">auto</span> last = <span class="hljs-built_in">unique</span>(nums.<span class="hljs-built_in">begin</span>(), nums.<span class="hljs-built_in">end</span>());<br>nums.<span class="hljs-built_in">erase</span>(last, nums.<span class="hljs-built_in">end</span>());<br></code></pre></td></tr></table></figure>
<h2 id="六-实用工具函数"><a href="#六-实用工具函数" class="headerlink" title="六-实用工具函数"></a><a class="markdownIt-Anchor" href="#六-实用工具函数"></a> 六、实用工具函数</h2>
<ol>
<li>类型转换</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sstream&gt;</span></span><br><br><span class="hljs-comment">// 字符串转数字</span><br>string strNum = <span class="hljs-string">&quot;123&quot;</span>;<br><span class="hljs-type">int</span> num1 = <span class="hljs-built_in">stoi</span>(strNum);     <span class="hljs-comment">// string to int</span><br><span class="hljs-type">double</span> num2 = <span class="hljs-built_in">stod</span>(<span class="hljs-string">&quot;3.14&quot;</span>);  <span class="hljs-comment">// string to double</span><br><span class="hljs-type">long</span> num3 = <span class="hljs-built_in">stol</span>(<span class="hljs-string">&quot;1000&quot;</span>);    <span class="hljs-comment">// string to long</span><br><br><span class="hljs-comment">// 数字转字符串</span><br><span class="hljs-type">int</span> num = <span class="hljs-number">456</span>;<br>string str1 = <span class="hljs-built_in">to_string</span>(num);  <span class="hljs-comment">// &quot;456&quot;</span><br>string str2 = <span class="hljs-built_in">to_string</span>(<span class="hljs-number">3.1415</span>); <span class="hljs-comment">// &quot;3.141500&quot;</span><br><br><span class="hljs-comment">// 使用stringstream（更灵活）</span><br>stringstream ss;<br>ss &lt;&lt; <span class="hljs-string">&quot;年龄：&quot;</span> &lt;&lt; <span class="hljs-number">25</span> &lt;&lt; <span class="hljs-string">&quot;，分数：&quot;</span> &lt;&lt; <span class="hljs-number">98.5</span>;<br>string info = ss.<span class="hljs-built_in">str</span>();  <span class="hljs-comment">// &quot;年龄：25，分数：98.5&quot;</span><br></code></pre></td></tr></table></figure>
<ol start="2">
<li>随机数（C++11）</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;random&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;ctime&gt;</span></span><br><br><span class="hljs-comment">// 生成0-99的随机整数</span><br><span class="hljs-function">mt19937 <span class="hljs-title">rng</span><span class="hljs-params">(time(<span class="hljs-number">0</span>))</span></span>;  <span class="hljs-comment">// 随机数引擎</span><br><span class="hljs-function">uniform_int_distribution&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">dist</span><span class="hljs-params">(<span class="hljs-number">0</span>, <span class="hljs-number">99</span>)</span></span>;<br><br><span class="hljs-type">int</span> randomNum = <span class="hljs-built_in">dist</span>(rng);  <span class="hljs-comment">// 每次运行都不同</span><br><br><span class="hljs-comment">// 生成0.0-1.0的随机浮点数</span><br><span class="hljs-function">uniform_real_distribution&lt;<span class="hljs-type">double</span>&gt; <span class="hljs-title">dist2</span><span class="hljs-params">(<span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>)</span></span>;<br><span class="hljs-type">double</span> randomDouble = <span class="hljs-built_in">dist2</span>(rng);<br></code></pre></td></tr></table></figure>
<h1 id="读取文本文件"><a href="#读取文本文件" class="headerlink" title="读取文本文件"></a><a class="markdownIt-Anchor" href="#读取文本文件"></a> 读取文本文件</h1>
<h2 id="最基础读取整个文件"><a href="#最基础读取整个文件" class="headerlink" title="最基础读取整个文件"></a><a class="markdownIt-Anchor" href="#最基础读取整个文件"></a> 最基础：读取整个文件</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;fstream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-comment">// 方法1：逐行读取</span><br>    <span class="hljs-function">std::ifstream <span class="hljs-title">file1</span><span class="hljs-params">(<span class="hljs-string">&quot;example.txt&quot;</span>)</span></span>;<br>    std::string line;<br><br>    <span class="hljs-keyword">if</span> (file<span class="hljs-number">1.</span><span class="hljs-built_in">is_open</span>()) &#123;<br>        <span class="hljs-keyword">while</span> (std::<span class="hljs-built_in">getline</span>(file1, line)) &#123;<br>            std::cout &lt;&lt; line &lt;&lt; std::endl;<br>        &#125;<br>        file<span class="hljs-number">1.</span><span class="hljs-built_in">close</span>();<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;无法打开文件！&quot;</span> &lt;&lt; std::endl;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="读取整个文件到字符串一次性"><a href="#读取整个文件到字符串一次性" class="headerlink" title="读取整个文件到字符串一次性"></a><a class="markdownIt-Anchor" href="#读取整个文件到字符串一次性"></a> 读取整个文件到字符串（一次性）</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;fstream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sstream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string&gt;</span></span><br><br><span class="hljs-function">std::string <span class="hljs-title">readEntireFile</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; filename)</span> </span>&#123;<br>    <span class="hljs-comment">// 方法2：使用stringstream</span><br>    <span class="hljs-function">std::ifstream <span class="hljs-title">file</span><span class="hljs-params">(filename)</span></span>;<br>    std::stringstream buffer;<br><br>    <span class="hljs-keyword">if</span> (!file.<span class="hljs-built_in">is_open</span>()) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;  <span class="hljs-comment">// 返回空字符串表示失败</span><br>    &#125;<br><br>    buffer &lt;&lt; file.<span class="hljs-built_in">rdbuf</span>();  <span class="hljs-comment">// 读取整个文件</span><br>    file.<span class="hljs-built_in">close</span>();<br><br>    <span class="hljs-keyword">return</span> buffer.<span class="hljs-built_in">str</span>();<br>&#125;<br><br><span class="hljs-comment">// 或者更现代的方式</span><br><span class="hljs-function">std::string <span class="hljs-title">readEntireFile2</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; filename)</span> </span>&#123;<br>    <span class="hljs-function">std::ifstream <span class="hljs-title">file</span><span class="hljs-params">(filename, std::ios::ate)</span></span>;  <span class="hljs-comment">// ate: 直接到文件末尾</span><br>    <span class="hljs-keyword">if</span> (!file.<span class="hljs-built_in">is_open</span>()) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-type">size_t</span> fileSize = file.<span class="hljs-built_in">tellg</span>();  <span class="hljs-comment">// 获取文件大小</span><br>    file.<span class="hljs-built_in">seekg</span>(<span class="hljs-number">0</span>);  <span class="hljs-comment">// 回到开头</span><br><br>    std::string content;<br>    content.<span class="hljs-built_in">resize</span>(fileSize);  <span class="hljs-comment">// 预分配空间</span><br><br>    file.<span class="hljs-built_in">read</span>(&amp;content[<span class="hljs-number">0</span>], fileSize);  <span class="hljs-comment">// 直接读取到string</span><br>    file.<span class="hljs-built_in">close</span>();<br><br>    <span class="hljs-keyword">return</span> content;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="读取着色器文件的完整示例"><a href="#读取着色器文件的完整示例" class="headerlink" title="读取着色器文件的完整示例"></a><a class="markdownIt-Anchor" href="#读取着色器文件的完整示例"></a> 读取着色器文件的完整示例</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;fstream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sstream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string&gt;</span></span><br><br><span class="hljs-comment">// 读取着色器文件 - 完整版本</span><br><span class="hljs-function">std::string <span class="hljs-title">readShaderFile</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span>* filePath)</span> </span>&#123;<br>    <span class="hljs-comment">// 1. 打开文件（二进制模式可选）</span><br>    <span class="hljs-function">std::ifstream <span class="hljs-title">file</span><span class="hljs-params">(filePath, std::ios::in)</span></span>;<br><br>    <span class="hljs-comment">// 2. 检查是否成功打开</span><br>    <span class="hljs-keyword">if</span> (!file.<span class="hljs-built_in">is_open</span>()) &#123;<br>        std::cerr &lt;&lt; <span class="hljs-string">&quot;错误：无法打开文件 &quot;</span> &lt;&lt; filePath &lt;&lt; std::endl;<br><br>        <span class="hljs-comment">// 调试信息：列出当前目录</span><br>        <span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> _WIN32</span><br>            <span class="hljs-built_in">system</span>(<span class="hljs-string">&quot;dir&quot;</span>);<br>        <span class="hljs-meta">#<span class="hljs-keyword">else</span></span><br>            <span class="hljs-built_in">system</span>(<span class="hljs-string">&quot;ls -la&quot;</span>);<br>        <span class="hljs-meta">#<span class="hljs-keyword">endif</span></span><br><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// 3. 读取内容</span><br>    std::stringstream contentStream;<br><br>    <span class="hljs-comment">// 方法A：逐行读取（保留换行符）</span><br>    std::string line;<br>    <span class="hljs-keyword">while</span> (std::<span class="hljs-built_in">getline</span>(file, line)) &#123;<br>        contentStream &lt;&lt; line &lt;&lt; <span class="hljs-string">&quot;\\n&quot;</span>;  <span class="hljs-comment">// 添加换行</span><br>    &#125;<br><br>    <span class="hljs-comment">// 方法B：一次性读取（更快）</span><br>    <span class="hljs-comment">// contentStream &lt;&lt; file.rdbuf();</span><br><br>    <span class="hljs-comment">// 4. 关闭文件</span><br>    file.<span class="hljs-built_in">close</span>();<br><br>    <span class="hljs-keyword">return</span> contentStream.<span class="hljs-built_in">str</span>();<br>&#125;<br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="读取二进制文件"><a href="#读取二进制文件" class="headerlink" title="读取二进制文件"></a><a class="markdownIt-Anchor" href="#读取二进制文件"></a> 读取二进制文件</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;fstream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><br><span class="hljs-comment">// 读取二进制文件（如图片、模型）</span><br><span class="hljs-function">std::vector&lt;<span class="hljs-type">char</span>&gt; <span class="hljs-title">readBinaryFile</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; filename)</span> </span>&#123;<br>    <span class="hljs-comment">// 以二进制模式打开</span><br>    <span class="hljs-function">std::ifstream <span class="hljs-title">file</span><span class="hljs-params">(filename, std::ios::binary | std::ios::ate)</span></span>;<br><br>    <span class="hljs-keyword">if</span> (!file.<span class="hljs-built_in">is_open</span>()) &#123;<br>        <span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">runtime_error</span>(<span class="hljs-string">&quot;无法打开文件: &quot;</span> + filename);<br>    &#125;<br><br>    <span class="hljs-comment">// 获取文件大小</span><br>    std::streamsize size = file.<span class="hljs-built_in">tellg</span>();<br>    file.<span class="hljs-built_in">seekg</span>(<span class="hljs-number">0</span>, std::ios::beg);<br><br>    <span class="hljs-comment">// 读取到vector</span><br>    <span class="hljs-function">std::vector&lt;<span class="hljs-type">char</span>&gt; <span class="hljs-title">buffer</span><span class="hljs-params">(size)</span></span>;<br>    <span class="hljs-keyword">if</span> (!file.<span class="hljs-built_in">read</span>(buffer.<span class="hljs-built_in">data</span>(), size)) &#123;<br>        <span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">runtime_error</span>(<span class="hljs-string">&quot;读取文件失败: &quot;</span> + filename);<br>    &#125;<br><br>    file.<span class="hljs-built_in">close</span>();<br>    <span class="hljs-keyword">return</span> buffer;<br>&#125;<br>​<br>读取配置文件（CSV/键值对）<br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;fstream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sstream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;map&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><br><span class="hljs-comment">// 读取CSV文件</span><br>std::vector&lt;std::vector&lt;std::string&gt;&gt; <span class="hljs-built_in">readCSV</span>(<span class="hljs-type">const</span> std::string&amp; filename) &#123;<br>    <span class="hljs-function">std::ifstream <span class="hljs-title">file</span><span class="hljs-params">(filename)</span></span>;<br>    std::vector&lt;std::vector&lt;std::string&gt;&gt; data;<br>    std::string line;<br><br>    <span class="hljs-keyword">while</span> (std::<span class="hljs-built_in">getline</span>(file, line)) &#123;<br>        std::vector&lt;std::string&gt; row;<br>        <span class="hljs-function">std::stringstream <span class="hljs-title">lineStream</span><span class="hljs-params">(line)</span></span>;<br>        std::string cell;<br><br>        <span class="hljs-keyword">while</span> (std::<span class="hljs-built_in">getline</span>(lineStream, cell, <span class="hljs-string">&#x27;,&#x27;</span>)) &#123;  <span class="hljs-comment">// 逗号分隔</span><br>            row.<span class="hljs-built_in">push_back</span>(cell);<br>        &#125;<br>        data.<span class="hljs-built_in">push_back</span>(row);<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> data;<br>&#125;<br><br><span class="hljs-comment">// 读取键值对配置文件</span><br><span class="hljs-function">std::map&lt;std::string, std::string&gt; <span class="hljs-title">readConfig</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; filename)</span> </span>&#123;<br>    <span class="hljs-function">std::ifstream <span class="hljs-title">file</span><span class="hljs-params">(filename)</span></span>;<br>    std::map&lt;std::string, std::string&gt; config;<br>    std::string line;<br><br>    <span class="hljs-keyword">while</span> (std::<span class="hljs-built_in">getline</span>(file, line)) &#123;<br>        <span class="hljs-comment">// 跳过注释和空行</span><br>        <span class="hljs-keyword">if</span> (line.<span class="hljs-built_in">empty</span>() || line[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;#&#x27;</span>) &#123;<br>            <span class="hljs-keyword">continue</span>;<br>        &#125;<br><br>        <span class="hljs-type">size_t</span> pos = line.<span class="hljs-built_in">find</span>(<span class="hljs-string">&#x27;=&#x27;</span>);<br>        <span class="hljs-keyword">if</span> (pos != std::string::npos) &#123;<br>            std::string key = line.<span class="hljs-built_in">substr</span>(<span class="hljs-number">0</span>, pos);<br>            std::string value = line.<span class="hljs-built_in">substr</span>(pos + <span class="hljs-number">1</span>);<br><br>            <span class="hljs-comment">// 去除空格</span><br>            key.<span class="hljs-built_in">erase</span>(<span class="hljs-number">0</span>, key.<span class="hljs-built_in">find_first_not_of</span>(<span class="hljs-string">&quot; \\t&quot;</span>));<br>            key.<span class="hljs-built_in">erase</span>(key.<span class="hljs-built_in">find_last_not_of</span>(<span class="hljs-string">&quot; \\t&quot;</span>) + <span class="hljs-number">1</span>);<br>            value.<span class="hljs-built_in">erase</span>(<span class="hljs-number">0</span>, value.<span class="hljs-built_in">find_first_not_of</span>(<span class="hljs-string">&quot; \\t&quot;</span>));<br>            value.<span class="hljs-built_in">erase</span>(value.<span class="hljs-built_in">find_last_not_of</span>(<span class="hljs-string">&quot; \\t&quot;</span>) + <span class="hljs-number">1</span>);<br><br>            config[key] = value;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> config;<br>&#125;<br>​<br>错误处理最佳实践<br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;fstream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;system_error&gt;</span>  <span class="hljs-comment">// C++11错误处理</span></span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">FileReader</span> &#123;<br><span class="hljs-keyword">private</span>:<br>    std::string filename_;<br><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">explicit</span> <span class="hljs-title">FileReader</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; filename)</span> : filename_(filename) &#123;</span>&#125;<br><br>    <span class="hljs-comment">// 方法1：返回bool表示成功/失败</span><br>    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">readToString</span><span class="hljs-params">(std::string&amp; content)</span> </span>&#123;<br>        <span class="hljs-function">std::ifstream <span class="hljs-title">file</span><span class="hljs-params">(filename_)</span></span>;<br>        <span class="hljs-keyword">if</span> (!file) &#123;<br>            std::cerr &lt;&lt; <span class="hljs-string">&quot;无法打开文件: &quot;</span> &lt;&lt; filename_ &lt;&lt; std::endl;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br><br>        std::stringstream buffer;<br>        buffer &lt;&lt; file.<span class="hljs-built_in">rdbuf</span>();<br>        content = buffer.<span class="hljs-built_in">str</span>();<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// 方法2：抛出异常</span><br>    <span class="hljs-function">std::string <span class="hljs-title">readOrThrow</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-function">std::ifstream <span class="hljs-title">file</span><span class="hljs-params">(filename_)</span></span>;<br>        <span class="hljs-keyword">if</span> (!file) &#123;<br>            <span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">runtime_error</span>(<span class="hljs-string">&quot;无法打开文件: &quot;</span> + filename_);<br>        &#125;<br><br>        std::stringstream buffer;<br>        buffer &lt;&lt; file.<span class="hljs-built_in">rdbuf</span>();<br>        <span class="hljs-keyword">return</span> buffer.<span class="hljs-built_in">str</span>();<br>    &#125;<br><br>    <span class="hljs-comment">// 方法3：使用std::error_code（现代C++）</span><br>    <span class="hljs-function">std::string <span class="hljs-title">readWithError</span><span class="hljs-params">(std::error_code&amp; ec)</span> </span>&#123;<br>        <span class="hljs-function">std::ifstream <span class="hljs-title">file</span><span class="hljs-params">(filename_)</span></span>;<br>        <span class="hljs-keyword">if</span> (!file) &#123;<br>            ec = std::<span class="hljs-built_in">make_error_code</span>(std::errc::no_such_file_or_directory);<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;<br>        &#125;<br><br>        std::stringstream buffer;<br>        buffer &lt;&lt; file.<span class="hljs-built_in">rdbuf</span>();<br>        ec.<span class="hljs-built_in">clear</span>();  <span class="hljs-comment">// 清除错误码</span><br>        <span class="hljs-keyword">return</span> buffer.<span class="hljs-built_in">str</span>();<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="实用工具函数集合"><a href="#实用工具函数集合" class="headerlink" title="实用工具函数集合"></a><a class="markdownIt-Anchor" href="#实用工具函数集合"></a> 实用工具函数集合</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;fstream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sstream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><br><span class="hljs-keyword">namespace</span> FileUtils &#123;<br><br>    <span class="hljs-comment">// 检查文件是否存在</span><br>    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">fileExists</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; path)</span> </span>&#123;<br>        <span class="hljs-function">std::ifstream <span class="hljs-title">file</span><span class="hljs-params">(path)</span></span>;<br>        <span class="hljs-keyword">return</span> file.<span class="hljs-built_in">good</span>();<br>    &#125;<br><br>    <span class="hljs-comment">// 获取文件大小</span><br>    <span class="hljs-function"><span class="hljs-type">size_t</span> <span class="hljs-title">getFileSize</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; filename)</span> </span>&#123;<br>        <span class="hljs-function">std::ifstream <span class="hljs-title">file</span><span class="hljs-params">(filename, std::ios::binary | std::ios::ate)</span></span>;<br>        <span class="hljs-keyword">if</span> (!file.<span class="hljs-built_in">is_open</span>()) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">return</span> file.<span class="hljs-built_in">tellg</span>();<br>    &#125;<br><br>    <span class="hljs-comment">// 读取前N行</span><br>    <span class="hljs-function">std::vector&lt;std::string&gt; <span class="hljs-title">readFirstNLines</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; filename, <span class="hljs-type">int</span> n)</span> </span>&#123;<br>        <span class="hljs-function">std::ifstream <span class="hljs-title">file</span><span class="hljs-params">(filename)</span></span>;<br>        std::vector&lt;std::string&gt; lines;<br>        std::string line;<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; n &amp;&amp; std::<span class="hljs-built_in">getline</span>(file, line); i++) &#123;<br>            lines.<span class="hljs-built_in">push_back</span>(line);<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> lines;<br>    &#125;<br><br>    <span class="hljs-comment">// 统计文件行数</span><br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">countLines</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; filename)</span> </span>&#123;<br>        <span class="hljs-function">std::ifstream <span class="hljs-title">file</span><span class="hljs-params">(filename)</span></span>;<br>        <span class="hljs-keyword">if</span> (!file.<span class="hljs-built_in">is_open</span>()) <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br><br>        <span class="hljs-type">int</span> count = <span class="hljs-number">0</span>;<br>        std::string line;<br>        <span class="hljs-keyword">while</span> (std::<span class="hljs-built_in">getline</span>(file, line)) &#123;<br>            count++;<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> count;<br>    &#125;<br><br>    <span class="hljs-comment">// 查找文件中是否包含特定文本</span><br>    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">containsText</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; filename, <span class="hljs-type">const</span> std::string&amp; searchText)</span> </span>&#123;<br>        <span class="hljs-function">std::ifstream <span class="hljs-title">file</span><span class="hljs-params">(filename)</span></span>;<br>        std::string line;<br><br>        <span class="hljs-keyword">while</span> (std::<span class="hljs-built_in">getline</span>(file, line)) &#123;<br>            <span class="hljs-keyword">if</span> (line.<span class="hljs-built_in">find</span>(searchText) != std::string::npos) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h1 id="指针"><a href="#指针" class="headerlink" title="指针"></a><a class="markdownIt-Anchor" href="#指针"></a> 指针</h1>
<h2 id="一-指针基础概念"><a href="#一-指针基础概念" class="headerlink" title="一-指针基础概念"></a><a class="markdownIt-Anchor" href="#一-指针基础概念"></a> 一、指针基础概念</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-number">1.1</span> 什么是指针<br>指针是一个变量，其值为另一个变量的内存地址。<br><span class="hljs-type">int</span> var = <span class="hljs-number">10</span>;      <span class="hljs-comment">// 普通整型变量</span><br><span class="hljs-type">int</span>* ptr = &amp;var;   <span class="hljs-comment">// ptr是指向var的指针</span><br>​<br><span class="hljs-number">1.2</span> 指针声明和初始化<br><span class="hljs-comment">// 声明指针</span><br><span class="hljs-type">int</span>* p1;       <span class="hljs-comment">// 指向int的指针</span><br><span class="hljs-type">double</span>* p2;    <span class="hljs-comment">// 指向double的指针</span><br><span class="hljs-type">char</span>* p3;      <span class="hljs-comment">// 指向char的指针</span><br><br><span class="hljs-comment">// 初始化指针</span><br><span class="hljs-type">int</span> x = <span class="hljs-number">5</span>;<br><span class="hljs-type">int</span>* ptr = &amp;x;  <span class="hljs-comment">// &amp; 取地址运算符</span><br><br><span class="hljs-comment">// 空指针（推荐使用nullptr，C++11以后）</span><br><span class="hljs-type">int</span>* p4 = <span class="hljs-literal">nullptr</span>;  <span class="hljs-comment">// 现代C++</span><br><span class="hljs-type">int</span>* p5 = <span class="hljs-literal">NULL</span>;     <span class="hljs-comment">// 传统C/C++</span><br><span class="hljs-type">int</span>* p6 = <span class="hljs-number">0</span>;        <span class="hljs-comment">// 字面量0</span><br><br></code></pre></td></tr></table></figure>
<h2 id="二-指针基本操作"><a href="#二-指针基本操作" class="headerlink" title="二-指针基本操作"></a><a class="markdownIt-Anchor" href="#二-指针基本操作"></a> 二、指针基本操作</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-number">2.1</span> 取地址和间接访问<br><span class="hljs-type">int</span> value = <span class="hljs-number">42</span>;<br><span class="hljs-type">int</span>* ptr = &amp;value;    <span class="hljs-comment">// ptr保存value的地址</span><br><br>cout &lt;&lt; <span class="hljs-string">&quot;value的值: &quot;</span> &lt;&lt; value &lt;&lt; endl;      <span class="hljs-comment">// 42</span><br>cout &lt;&lt; <span class="hljs-string">&quot;value的地址: &quot;</span> &lt;&lt; &amp;value &lt;&lt; endl;   <span class="hljs-comment">// 0x7ffeeb5c...</span><br>cout &lt;&lt; <span class="hljs-string">&quot;ptr的值: &quot;</span> &lt;&lt; ptr &lt;&lt; endl;          <span class="hljs-comment">// 与&amp;value相同</span><br>cout &lt;&lt; <span class="hljs-string">&quot;ptr指向的值: &quot;</span> &lt;&lt; *ptr &lt;&lt; endl;     <span class="hljs-comment">// 42，*是解引用运算符</span><br><br><span class="hljs-comment">// 通过指针修改变量</span><br>*ptr = <span class="hljs-number">100</span>;<br>cout &lt;&lt; <span class="hljs-string">&quot;修改后value的值: &quot;</span> &lt;&lt; value &lt;&lt; endl;  <span class="hljs-comment">// 100</span><br>​<br><span class="hljs-number">2.2</span> 指针运算<br><span class="hljs-type">int</span> arr[<span class="hljs-number">5</span>] = &#123;<span class="hljs-number">10</span>, <span class="hljs-number">20</span>, <span class="hljs-number">30</span>, <span class="hljs-number">40</span>, <span class="hljs-number">50</span>&#125;;<br><span class="hljs-type">int</span>* p = arr;  <span class="hljs-comment">// p指向数组第一个元素</span><br><br>cout &lt;&lt; *p &lt;&lt; endl;        <span class="hljs-comment">// 10</span><br>cout &lt;&lt; *(p + <span class="hljs-number">1</span>) &lt;&lt; endl;  <span class="hljs-comment">// 20，指针加法</span><br>cout &lt;&lt; *(p + <span class="hljs-number">2</span>) &lt;&lt; endl;  <span class="hljs-comment">// 30</span><br><br>p++;  <span class="hljs-comment">// 移动到下一个元素</span><br>cout &lt;&lt; *p &lt;&lt; endl;        <span class="hljs-comment">// 20</span><br><br><span class="hljs-comment">// 指针比较</span><br><span class="hljs-type">int</span>* p1 = &amp;arr[<span class="hljs-number">0</span>];<br><span class="hljs-type">int</span>* p2 = &amp;arr[<span class="hljs-number">3</span>];<br><span class="hljs-keyword">if</span> (p1 &lt; p2) &#123;<br>    cout &lt;&lt; <span class="hljs-string">&quot;p1在p2之前&quot;</span> &lt;&lt; endl;<br>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="三-指针与数组"><a href="#三-指针与数组" class="headerlink" title="三-指针与数组"></a><a class="markdownIt-Anchor" href="#三-指针与数组"></a> 三、指针与数组</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-number">3.1</span> 数组名即指针<br><span class="hljs-type">int</span> numbers[<span class="hljs-number">5</span>] = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>&#125;;<br><br><span class="hljs-comment">// 数组名是指向第一个元素的指针</span><br>cout &lt;&lt; numbers &lt;&lt; endl;    <span class="hljs-comment">// 数组首地址</span><br>cout &lt;&lt; &amp;numbers[<span class="hljs-number">0</span>] &lt;&lt; endl; <span class="hljs-comment">// 与numbers相同</span><br><br><span class="hljs-comment">// 访问数组元素</span><br>cout &lt;&lt; numbers[<span class="hljs-number">2</span>] &lt;&lt; endl;      <span class="hljs-comment">// 3</span><br>cout &lt;&lt; *(numbers + <span class="hljs-number">2</span>) &lt;&lt; endl;  <span class="hljs-comment">// 3，等价于numbers[2]</span><br><br><span class="hljs-comment">// 遍历数组的三种方式</span><br><span class="hljs-comment">// 1. 使用下标</span><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) &#123;<br>    cout &lt;&lt; numbers[i] &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;<br>&#125;<br><br><span class="hljs-comment">// 2. 使用指针算术</span><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) &#123;<br>    cout &lt;&lt; *(numbers + i) &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;<br>&#125;<br><br><span class="hljs-comment">// 3. 使用指针变量</span><br><span class="hljs-type">int</span>* ptr = numbers;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) &#123;<br>    cout &lt;&lt; *ptr++ &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;<br>&#125;<br>​<br><span class="hljs-number">3.2</span> 指针数组 vs 数组指针<br><span class="hljs-comment">// 指针数组：数组的元素是指针</span><br><span class="hljs-type">int</span> a = <span class="hljs-number">1</span>, b = <span class="hljs-number">2</span>, c = <span class="hljs-number">3</span>;<br><span class="hljs-type">int</span>* ptrArr[<span class="hljs-number">3</span>] = &#123;&amp;a, &amp;b, &amp;c&#125;;<br><br><span class="hljs-comment">// 数组指针：指向数组的指针</span><br><span class="hljs-type">int</span> arr[<span class="hljs-number">5</span>] = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>&#125;;<br><span class="hljs-built_in">int</span> (*arrPtr)[<span class="hljs-number">5</span>] = &amp;arr;  <span class="hljs-comment">// 指向整个数组的指针</span><br><br><span class="hljs-comment">// 访问</span><br>cout &lt;&lt; (*arrPtr)[<span class="hljs-number">2</span>] &lt;&lt; endl;  <span class="hljs-comment">// 3</span><br></code></pre></td></tr></table></figure>
<h2 id="四-指针与函数"><a href="#四-指针与函数" class="headerlink" title="四-指针与函数"></a><a class="markdownIt-Anchor" href="#四-指针与函数"></a> 四、指针与函数</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-number">4.1</span> 指针作为函数参数（传地址）<br><span class="hljs-comment">// 通过指针修改实参</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">swap</span><span class="hljs-params">(<span class="hljs-type">int</span>* a, <span class="hljs-type">int</span>* b)</span> </span>&#123;<br>    <span class="hljs-type">int</span> temp = *a;<br>    *a = *b;<br>    *b = temp;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-type">int</span> x = <span class="hljs-number">5</span>, y = <span class="hljs-number">10</span>;<br>    cout &lt;&lt; <span class="hljs-string">&quot;交换前: x=&quot;</span> &lt;&lt; x &lt;&lt; <span class="hljs-string">&quot;, y=&quot;</span> &lt;&lt; y &lt;&lt; endl;<br>    <span class="hljs-built_in">swap</span>(&amp;x, &amp;y);<br>    cout &lt;&lt; <span class="hljs-string">&quot;交换后: x=&quot;</span> &lt;&lt; x &lt;&lt; <span class="hljs-string">&quot;, y=&quot;</span> &lt;&lt; y &lt;&lt; endl;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br>​<br><span class="hljs-number">4.2</span> 数组作为函数参数<br><span class="hljs-comment">// 三种等价形式</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">printArray</span><span class="hljs-params">(<span class="hljs-type">int</span> arr[], <span class="hljs-type">int</span> size)</span> </span>&#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; size; i++) &#123;<br>        cout &lt;&lt; arr[i] &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">printArray</span><span class="hljs-params">(<span class="hljs-type">int</span>* arr, <span class="hljs-type">int</span> size)</span> </span>&#123;  <span class="hljs-comment">// 更明确的指针形式</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; size; i++) &#123;<br>        cout &lt;&lt; arr[i] &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 使用</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-type">int</span> data[<span class="hljs-number">5</span>] = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>&#125;;<br>    <span class="hljs-built_in">printArray</span>(data, <span class="hljs-number">5</span>);  <span class="hljs-comment">// 数组名自动转换为指针</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br>​<br><span class="hljs-number">4.3</span> 函数指针<br><span class="hljs-comment">// 函数原型</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> a + b;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">multiply</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> a * b;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-comment">// 声明函数指针</span><br>    <span class="hljs-built_in">int</span> (*funcPtr)(<span class="hljs-type">int</span>, <span class="hljs-type">int</span>);<br><br>    <span class="hljs-comment">// 指向add函数</span><br>    funcPtr = &amp;add;  <span class="hljs-comment">// 或直接 funcPtr = add;</span><br>    cout &lt;&lt; <span class="hljs-string">&quot;10 + 5 = &quot;</span> &lt;&lt; <span class="hljs-built_in">funcPtr</span>(<span class="hljs-number">10</span>, <span class="hljs-number">5</span>) &lt;&lt; endl;<br><br>    <span class="hljs-comment">// 指向multiply函数</span><br>    funcPtr = multiply;<br>    cout &lt;&lt; <span class="hljs-string">&quot;10 * 5 = &quot;</span> &lt;&lt; <span class="hljs-built_in">funcPtr</span>(<span class="hljs-number">10</span>, <span class="hljs-number">5</span>) &lt;&lt; endl;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="五-动态内存管理"><a href="#五-动态内存管理" class="headerlink" title="五-动态内存管理"></a><a class="markdownIt-Anchor" href="#五-动态内存管理"></a> 五、动态内存管理</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-number">5.1</span> <span class="hljs-keyword">new</span>和<span class="hljs-keyword">delete</span>操作符<br><span class="hljs-comment">// 单个变量的动态分配</span><br><span class="hljs-type">int</span>* p = <span class="hljs-keyword">new</span> <span class="hljs-type">int</span>;     <span class="hljs-comment">// 分配一个int</span><br>*p = <span class="hljs-number">42</span>;<br>cout &lt;&lt; *p &lt;&lt; endl;<br><span class="hljs-keyword">delete</span> p;             <span class="hljs-comment">// 释放内存</span><br>p = <span class="hljs-literal">nullptr</span>;          <span class="hljs-comment">// 避免野指针</span><br><br><span class="hljs-comment">// 数组的动态分配</span><br><span class="hljs-type">int</span> size = <span class="hljs-number">5</span>;<br><span class="hljs-type">int</span>* arr = <span class="hljs-keyword">new</span> <span class="hljs-type">int</span>[size];  <span class="hljs-comment">// 分配数组</span><br><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; size; i++) &#123;<br>    arr[i] = i * <span class="hljs-number">10</span>;<br>&#125;<br><br><span class="hljs-keyword">delete</span>[] arr;  <span class="hljs-comment">// 释放数组</span><br>arr = <span class="hljs-literal">nullptr</span>;<br>​<br><span class="hljs-number">5.2</span> 动态二维数组<br><span class="hljs-comment">// 创建动态二维数组</span><br><span class="hljs-type">int</span> rows = <span class="hljs-number">3</span>, cols = <span class="hljs-number">4</span>;<br><span class="hljs-type">int</span>** matrix = <span class="hljs-keyword">new</span> <span class="hljs-type">int</span>*[rows];  <span class="hljs-comment">// 创建行指针数组</span><br><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; rows; i++) &#123;<br>    matrix[i] = <span class="hljs-keyword">new</span> <span class="hljs-type">int</span>[cols];  <span class="hljs-comment">// 为每行创建列数组</span><br>&#125;<br><br><span class="hljs-comment">// 初始化</span><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; rows; i++) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; cols; j++) &#123;<br>        matrix[i][j] = i * cols + j;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 释放内存（逆序）</span><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; rows; i++) &#123;<br>    <span class="hljs-keyword">delete</span>[] matrix[i];<br>&#125;<br><span class="hljs-keyword">delete</span>[] matrix;<br>matrix = <span class="hljs-literal">nullptr</span>;<br></code></pre></td></tr></table></figure>
<h2 id="六-特殊指针类型"><a href="#六-特殊指针类型" class="headerlink" title="六-特殊指针类型"></a><a class="markdownIt-Anchor" href="#六-特殊指针类型"></a> 六、特殊指针类型</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-number">6.1</span> <span class="hljs-type">void</span>指针（泛型指针）<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">print</span><span class="hljs-params">(<span class="hljs-type">void</span>* data, <span class="hljs-type">char</span> type)</span> </span>&#123;<br>    <span class="hljs-keyword">switch</span>(type) &#123;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;i&#x27;</span>:<br>            cout &lt;&lt; *((<span class="hljs-type">int</span>*)data) &lt;&lt; endl;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;f&#x27;</span>:<br>            cout &lt;&lt; *((<span class="hljs-type">float</span>*)data) &lt;&lt; endl;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;c&#x27;</span>:<br>            cout &lt;&lt; *((<span class="hljs-type">char</span>*)data) &lt;&lt; endl;<br>            <span class="hljs-keyword">break</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-type">int</span> n = <span class="hljs-number">5</span>;<br>    <span class="hljs-type">float</span> f = <span class="hljs-number">3.14</span>;<br>    <span class="hljs-type">char</span> c = <span class="hljs-string">&#x27;A&#x27;</span>;<br><br>    <span class="hljs-built_in">print</span>(&amp;n, <span class="hljs-string">&#x27;i&#x27;</span>);<br>    <span class="hljs-built_in">print</span>(&amp;f, <span class="hljs-string">&#x27;f&#x27;</span>);<br>    <span class="hljs-built_in">print</span>(&amp;c, <span class="hljs-string">&#x27;c&#x27;</span>);<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br>​<br><span class="hljs-number">6.2</span> <span class="hljs-type">const</span>与指针<br><span class="hljs-type">int</span> value = <span class="hljs-number">10</span>;<br><span class="hljs-type">int</span> another = <span class="hljs-number">20</span>;<br><br><span class="hljs-comment">// 指向常量的指针（指针指向的内容不能修改）</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span>* ptr1 = &amp;value;<br><span class="hljs-comment">// *ptr1 = 20;  // 错误！不能通过ptr1修改value</span><br>ptr1 = &amp;another;  <span class="hljs-comment">// 但可以改变指针的指向</span><br><br><span class="hljs-comment">// 常量指针（指针的指向不能修改）</span><br><span class="hljs-type">int</span>* <span class="hljs-type">const</span> ptr2 = &amp;value;<br>*ptr2 = <span class="hljs-number">30</span>;       <span class="hljs-comment">// 可以修改指向的值</span><br><span class="hljs-comment">// ptr2 = &amp;another;  // 错误！不能改变指针的指向</span><br><br><span class="hljs-comment">// 指向常量的常量指针</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span>* <span class="hljs-type">const</span> ptr3 = &amp;value;<br><span class="hljs-comment">// *ptr3 = 40;        // 错误！</span><br><span class="hljs-comment">// ptr3 = &amp;another;  // 错误！</span><br>​<br>七、指针操作符 -&gt; 和 * 深度解析<br>* 和 -&gt; 操作符对比<br><span class="hljs-number">1.1</span> 基本概念区分<br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Point</span> &#123;<br>    <span class="hljs-type">int</span> x;<br>    <span class="hljs-type">int</span> y;<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">print</span><span class="hljs-params">()</span> </span>&#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;(&quot;</span> &lt;&lt; x &lt;&lt; <span class="hljs-string">&quot;, &quot;</span> &lt;&lt; y &lt;&lt; <span class="hljs-string">&quot;)&quot;</span> &lt;&lt; endl;<br>    &#125;<br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    Point p1 = &#123;<span class="hljs-number">10</span>, <span class="hljs-number">20</span>&#125;;<br>    Point* ptr = &amp;p1;<br><br>    <span class="hljs-comment">// 两种访问方式的对比</span><br>    <span class="hljs-comment">// 1. 使用 . 操作符（对象直接访问）</span><br>    cout &lt;&lt; <span class="hljs-string">&quot;p1.x = &quot;</span> &lt;&lt; p<span class="hljs-number">1.</span>x &lt;&lt; endl;      <span class="hljs-comment">// 10</span><br>    p<span class="hljs-number">1.</span><span class="hljs-built_in">print</span>();                              <span class="hljs-comment">// (10, 20)</span><br><br>    <span class="hljs-comment">// 2. 使用 * 和 . 组合（指针解引用后访问）</span><br>    cout &lt;&lt; <span class="hljs-string">&quot;(*ptr).x = &quot;</span> &lt;&lt; (*ptr).x &lt;&lt; endl;  <span class="hljs-comment">// 10</span><br>    (*ptr).<span class="hljs-built_in">print</span>();                              <span class="hljs-comment">// (10, 20)</span><br><br>    <span class="hljs-comment">// 3. 使用 -&gt; 操作符（指针直接访问）</span><br>    cout &lt;&lt; <span class="hljs-string">&quot;ptr-&gt;x = &quot;</span> &lt;&lt; ptr-&gt;x &lt;&lt; endl;      <span class="hljs-comment">// 10</span><br>    ptr-&gt;<span class="hljs-built_in">print</span>();                               <span class="hljs-comment">// (10, 20)</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br>​<br><span class="hljs-number">1.2</span> 语法等价关系<br><span class="hljs-comment">// 以下三种形式完全等价：</span><br>ptr-&gt;member;     <span class="hljs-comment">// 最简洁的指针访问方式</span><br>(*ptr).member;   <span class="hljs-comment">// 解引用后使用点操作符</span><br>(*(ptr)).member; <span class="hljs-comment">// 更明确的解引用</span><br>​<br>-&gt; 操作符详解<br><span class="hljs-number">2.1</span> -&gt; 操作符的工作原理<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span> &#123;<br><span class="hljs-keyword">private</span>:<br>    string name;<br>    <span class="hljs-type">int</span> age;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">Student</span>(string n, <span class="hljs-type">int</span> a) : <span class="hljs-built_in">name</span>(n), <span class="hljs-built_in">age</span>(a) &#123;&#125;<br><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">display</span><span class="hljs-params">()</span> </span>&#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;姓名: &quot;</span> &lt;&lt; name &lt;&lt; <span class="hljs-string">&quot;, 年龄: &quot;</span> &lt;&lt; age &lt;&lt; endl;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">setName</span><span class="hljs-params">(string n)</span> </span>&#123;<br>        name = n;<br>    &#125;<br><br>    <span class="hljs-function">string <span class="hljs-title">getName</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> name;<br>    &#125;<br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-comment">// 在栈上创建对象</span><br>    <span class="hljs-function">Student <span class="hljs-title">s1</span><span class="hljs-params">(<span class="hljs-string">&quot;张三&quot;</span>, <span class="hljs-number">20</span>)</span></span>;<br>    s<span class="hljs-number">1.</span><span class="hljs-built_in">display</span>();           <span class="hljs-comment">// 对象直接使用 .</span><br><br>    <span class="hljs-comment">// 在堆上动态创建对象</span><br>    Student* s2 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Student</span>(<span class="hljs-string">&quot;李四&quot;</span>, <span class="hljs-number">22</span>);<br><br>    <span class="hljs-comment">// 访问成员函数</span><br>    s2-&gt;<span class="hljs-built_in">display</span>();          <span class="hljs-comment">// 使用 -&gt;</span><br>    s2-&gt;<span class="hljs-built_in">setName</span>(<span class="hljs-string">&quot;王五&quot;</span>);<br>    cout &lt;&lt; <span class="hljs-string">&quot;新名字: &quot;</span> &lt;&lt; s2-&gt;<span class="hljs-built_in">getName</span>() &lt;&lt; endl;<br><br>    <span class="hljs-comment">// 访问数据成员（如果public）</span><br>    <span class="hljs-comment">// s2-&gt;name;  // 如果name是public才可以</span><br><br>    <span class="hljs-keyword">delete</span> s2;  <span class="hljs-comment">// 记得释放内存</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br>​<br><span class="hljs-number">2.2</span> 为什么需要 -&gt; 操作符<br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Node</span> &#123;<br>    <span class="hljs-type">int</span> data;<br>    Node* next;  <span class="hljs-comment">// 指向下一个节点的指针</span><br><br>    <span class="hljs-built_in">Node</span>(<span class="hljs-type">int</span> val) : <span class="hljs-built_in">data</span>(val), <span class="hljs-built_in">next</span>(<span class="hljs-literal">nullptr</span>) &#123;&#125;<br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-comment">// 创建链表节点</span><br>    Node* head = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Node</span>(<span class="hljs-number">1</span>);<br>    head-&gt;next = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Node</span>(<span class="hljs-number">2</span>);<br>    head-&gt;next-&gt;next = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Node</span>(<span class="hljs-number">3</span>);  <span class="hljs-comment">// 链式调用</span><br><br>    <span class="hljs-comment">// 遍历链表</span><br>    Node* current = head;<br>    <span class="hljs-keyword">while</span> (current != <span class="hljs-literal">nullptr</span>) &#123;<br>        cout &lt;&lt; current-&gt;data &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;<br>        current = current-&gt;next;  <span class="hljs-comment">// 移动到下一个节点</span><br>    &#125;<br><br>    <span class="hljs-comment">// 对比：如果没有-&gt;操作符，代码会很繁琐</span><br>    <span class="hljs-comment">// (*head).next = new Node(2);</span><br>    <span class="hljs-comment">// (*(*head).next).next = new Node(3);</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<h1 id="引用"><a href="#引用" class="headerlink" title="引用"></a><a class="markdownIt-Anchor" href="#引用"></a> 引用</h1>
<h2 id="一-引用基础概念"><a href="#一-引用基础概念" class="headerlink" title="一-引用基础概念"></a><a class="markdownIt-Anchor" href="#一-引用基础概念"></a> 一、引用基础概念</h2>
<p>1.1 什么是引用</p>
<p>引用是变量的别名，是一个已存在变量的另一个名字。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">int</span> var = <span class="hljs-number">10</span>;<br><span class="hljs-type">int</span>&amp; ref = var;  <span class="hljs-comment">// ref是var的引用（别名）</span><br><br></code></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 值传递 - 创建副本（不修改原数组）</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">bubbleSort</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt; arr)</span> </span>&#123;<br>    <span class="hljs-comment">// arr 是原数组的副本</span><br>    <span class="hljs-comment">// 修改这里的 arr 不会影响 main 中的原数组</span><br>&#125;<br><br><span class="hljs-comment">// 引用传递 - 直接操作原数组</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">bubbleSort</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; arr)</span> </span>&#123;<br>    <span class="hljs-comment">// arr 是原数组的&quot;别名&quot;</span><br>    <span class="hljs-comment">// 修改这里的 arr 会影响 main 中的原数组</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>1.2 引用特性</p>
<p>· 必须初始化：引用在声明时必须初始化<br />
· 不能重新绑定：一旦绑定到一个变量，就不能再绑定到其他变量<br />
· 没有独立内存：引用与被引用变量共享同一内存地址</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">int</span> x = <span class="hljs-number">5</span>;<br><span class="hljs-type">int</span> y = <span class="hljs-number">10</span>;<br><br><span class="hljs-type">int</span>&amp; r1 = x;  <span class="hljs-comment">// 正确：声明时初始化</span><br><span class="hljs-comment">// int&amp; r2;    // 错误：引用必须初始化</span><br><br>r1 = <span class="hljs-number">20</span>;      <span class="hljs-comment">// 修改x的值为20</span><br><span class="hljs-comment">// r1 = y;    // 不是重新绑定，而是把y的值赋给x</span><br>cout &lt;&lt; x &lt;&lt; endl;  <span class="hljs-comment">// 20</span><br><br></code></pre></td></tr></table></figure>
<h2 id="二-引用声明和初始化"><a href="#二-引用声明和初始化" class="headerlink" title="二-引用声明和初始化"></a><a class="markdownIt-Anchor" href="#二-引用声明和初始化"></a> 二、引用声明和初始化</h2>
<p>2.1 基本类型引用</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 基本类型的引用</span><br><span class="hljs-type">int</span> a = <span class="hljs-number">42</span>;<br><span class="hljs-type">int</span>&amp; refA = a;         <span class="hljs-comment">// refA是a的引用</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span>&amp; constRefA = a;  <span class="hljs-comment">// 常引用</span><br><br><span class="hljs-type">double</span> d = <span class="hljs-number">3.14</span>;<br><span class="hljs-type">double</span>&amp; refD = d;<br><br><span class="hljs-type">char</span> c = <span class="hljs-string">&#x27;A&#x27;</span>;<br><span class="hljs-type">char</span>&amp; refC = c;<br><br><span class="hljs-comment">// 注意：引用类型必须与变量类型匹配</span><br><span class="hljs-comment">// double&amp; refInt = a;  // 错误：类型不匹配</span><br><br></code></pre></td></tr></table></figure>
<p>2.2 数组引用</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 一维数组引用</span><br><span class="hljs-type">int</span> arr[<span class="hljs-number">5</span>] = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>&#125;;<br><span class="hljs-built_in">int</span> (&amp;refArr)[<span class="hljs-number">5</span>] = arr;  <span class="hljs-comment">// 引用整个数组</span><br><br><span class="hljs-comment">// 通过引用访问数组</span><br>refArr[<span class="hljs-number">2</span>] = <span class="hljs-number">30</span>;  <span class="hljs-comment">// 修改arr[2]</span><br>cout &lt;&lt; arr[<span class="hljs-number">2</span>] &lt;&lt; endl;  <span class="hljs-comment">// 30</span><br><br><span class="hljs-comment">// 遍历数组引用</span><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) &#123;<br>    cout &lt;&lt; refArr[i] &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<p>2.3 指针的引用</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">int</span> x = <span class="hljs-number">100</span>;<br><span class="hljs-type">int</span>* ptr = &amp;x;<br><span class="hljs-type">int</span>*&amp; refPtr = ptr;  <span class="hljs-comment">// 指针的引用</span><br><br>cout &lt;&lt; *ptr &lt;&lt; endl;     <span class="hljs-comment">// 100</span><br>cout &lt;&lt; *refPtr &lt;&lt; endl;  <span class="hljs-comment">// 100，通过引用访问</span><br><br><span class="hljs-type">int</span> y = <span class="hljs-number">200</span>;<br>refPtr = &amp;y;  <span class="hljs-comment">// 通过引用修改指针指向</span><br>cout &lt;&lt; *ptr &lt;&lt; endl;  <span class="hljs-comment">// 200</span><br><br></code></pre></td></tr></table></figure>
<h2 id="三-引用与函数"><a href="#三-引用与函数" class="headerlink" title="三-引用与函数"></a><a class="markdownIt-Anchor" href="#三-引用与函数"></a> 三、引用与函数</h2>
<p>3.1 引用作为函数参数（传引用）</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 通过引用修改实参</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">increment</span><span class="hljs-params">(<span class="hljs-type">int</span>&amp; num)</span> </span>&#123;<br>    num++;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">swap</span><span class="hljs-params">(<span class="hljs-type">int</span>&amp; a, <span class="hljs-type">int</span>&amp; b)</span> </span>&#123;<br>    <span class="hljs-type">int</span> temp = a;<br>    a = b;<br>    b = temp;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-type">int</span> x = <span class="hljs-number">5</span>;<br>    cout &lt;&lt; <span class="hljs-string">&quot;原始值: &quot;</span> &lt;&lt; x &lt;&lt; endl;  <span class="hljs-comment">// 5</span><br>    <span class="hljs-built_in">increment</span>(x);<br>    cout &lt;&lt; <span class="hljs-string">&quot;增加后: &quot;</span> &lt;&lt; x &lt;&lt; endl;  <span class="hljs-comment">// 6</span><br><br>    <span class="hljs-type">int</span> a = <span class="hljs-number">10</span>, b = <span class="hljs-number">20</span>;<br>    cout &lt;&lt; <span class="hljs-string">&quot;交换前: a=&quot;</span> &lt;&lt; a &lt;&lt; <span class="hljs-string">&quot;, b=&quot;</span> &lt;&lt; b &lt;&lt; endl;<br>    <span class="hljs-built_in">swap</span>(a, b);<br>    cout &lt;&lt; <span class="hljs-string">&quot;交换后: a=&quot;</span> &lt;&lt; a &lt;&lt; <span class="hljs-string">&quot;, b=&quot;</span> &lt;&lt; b &lt;&lt; endl;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<p>3.2 引用作为函数返回值</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 返回局部变量的引用是危险的！</span><br><span class="hljs-function"><span class="hljs-type">int</span>&amp; <span class="hljs-title">badFunction</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-type">int</span> local = <span class="hljs-number">42</span>;  <span class="hljs-comment">// 局部变量</span><br>    <span class="hljs-keyword">return</span> local;    <span class="hljs-comment">// 危险！返回后local被销毁</span><br>&#125;<br><br><span class="hljs-comment">// 正确的用法：返回静态变量、全局变量或传入参数的引用</span><br><span class="hljs-function"><span class="hljs-type">int</span>&amp; <span class="hljs-title">getElement</span><span class="hljs-params">(<span class="hljs-type">int</span> arr[], <span class="hljs-type">int</span> index)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> arr[index];  <span class="hljs-comment">// 安全：返回数组元素的引用</span><br>&#125;<br><br><span class="hljs-comment">// 返回静态变量的引用</span><br><span class="hljs-function"><span class="hljs-type">int</span>&amp; <span class="hljs-title">getCounter</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-type">static</span> <span class="hljs-type">int</span> counter = <span class="hljs-number">0</span>;  <span class="hljs-comment">// 静态变量，生命周期贯穿程序</span><br>    counter++;<br>    <span class="hljs-keyword">return</span> counter;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-type">int</span> array[<span class="hljs-number">5</span>] = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>&#125;;<br><br>    <span class="hljs-comment">// 修改数组元素</span><br>    <span class="hljs-built_in">getElement</span>(array, <span class="hljs-number">2</span>) = <span class="hljs-number">100</span>;<br>    cout &lt;&lt; array[<span class="hljs-number">2</span>] &lt;&lt; endl;  <span class="hljs-comment">// 100</span><br><br>    <span class="hljs-comment">// 使用返回的引用</span><br>    <span class="hljs-type">int</span>&amp; countRef = <span class="hljs-built_in">getCounter</span>();<br>    cout &lt;&lt; <span class="hljs-string">&quot;计数器: &quot;</span> &lt;&lt; countRef &lt;&lt; endl;  <span class="hljs-comment">// 1</span><br>    countRef = <span class="hljs-number">50</span>;  <span class="hljs-comment">// 通过引用修改静态变量</span><br>    cout &lt;&lt; <span class="hljs-string">&quot;修改后: &quot;</span> &lt;&lt; <span class="hljs-built_in">getCounter</span>() &lt;&lt; endl;  <span class="hljs-comment">// 51</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<p>3.3 常引用（const引用）</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 常引用：只读引用，不能通过它修改原变量</span><br><span class="hljs-type">int</span> x = <span class="hljs-number">10</span>;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span>&amp; constRef = x;<br><br><span class="hljs-comment">// constRef = 20;  // 错误：不能通过常引用修改</span><br>x = <span class="hljs-number">20</span>;            <span class="hljs-comment">// 正确：可以直接修改原变量</span><br>cout &lt;&lt; constRef &lt;&lt; endl;  <span class="hljs-comment">// 20</span><br><br><span class="hljs-comment">// 常引用的优势：可以绑定到临时对象</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">getValue</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">42</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-comment">// const int&amp; r1 = getValue();  // 正确：可以绑定到临时值</span><br>    <span class="hljs-comment">// int&amp; r2 = getValue();        // 错误：非常引用不能绑定到临时值</span><br><br>    <span class="hljs-type">const</span> <span class="hljs-type">int</span>&amp; r = <span class="hljs-number">100</span>;  <span class="hljs-comment">// 正确：常引用可以绑定到字面量</span><br>    cout &lt;&lt; r &lt;&lt; endl;   <span class="hljs-comment">// 100</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<h2 id="四-引用与指针对比"><a href="#四-引用与指针对比" class="headerlink" title="四-引用与指针对比"></a><a class="markdownIt-Anchor" href="#四-引用与指针对比"></a> 四、引用与指针对比</h2>
<p>4.1 语法对比</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">int</span> value = <span class="hljs-number">42</span>;<br><br><span class="hljs-comment">// 指针方式</span><br><span class="hljs-type">int</span>* ptr = &amp;value;  <span class="hljs-comment">// 取地址</span><br>*ptr = <span class="hljs-number">50</span>;          <span class="hljs-comment">// 解引用修改</span><br><span class="hljs-type">int</span> x = *ptr;       <span class="hljs-comment">// 解引用读取</span><br><br><span class="hljs-comment">// 引用方式</span><br><span class="hljs-type">int</span>&amp; ref = value;   <span class="hljs-comment">// 直接绑定</span><br>ref = <span class="hljs-number">60</span>;           <span class="hljs-comment">// 直接修改</span><br><span class="hljs-type">int</span> y = ref;        <span class="hljs-comment">// 直接读取</span><br><br></code></pre></td></tr></table></figure>
<p>4.2 关键区别</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">特性              指针                 引用<br>初始化            可以不初始化           必须初始化<br>重新赋值          可以指向不同变量        不能重新绑定<br>空值              可以为null            ptr 不能为空<br>内存占用          有自己的内存地址        与原始变量共享地址<br>多级              可以有多级指针         只有一级引用<br>运算符            需要*和-&gt;操作符        像普通变量一样使用<br></code></pre></td></tr></table></figure>
<p>4.3 使用场景对比</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 场景1：函数参数传递</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">funcByPointer</span><span class="hljs-params">(<span class="hljs-type">int</span>* p)</span> </span>&#123;<br>    <span class="hljs-keyword">if</span> (p != <span class="hljs-literal">nullptr</span>) &#123;  <span class="hljs-comment">// 需要检查空指针</span><br>        *p = <span class="hljs-number">100</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">funcByReference</span><span class="hljs-params">(<span class="hljs-type">int</span>&amp; r)</span> </span>&#123;<br>    r = <span class="hljs-number">100</span>;  <span class="hljs-comment">// 无需检查，引用不能为空</span><br>&#125;<br><br><span class="hljs-comment">// 场景2：返回多个值</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">getMinMaxByPointer</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">int</span>* arr, <span class="hljs-type">int</span> size, <span class="hljs-type">int</span>* min, <span class="hljs-type">int</span>* max)</span> </span>&#123;<br>    <span class="hljs-keyword">if</span> (min != <span class="hljs-literal">nullptr</span>) *min = arr[<span class="hljs-number">0</span>];<br>    <span class="hljs-keyword">if</span> (max != <span class="hljs-literal">nullptr</span>) *max = arr[<span class="hljs-number">0</span>];<br>    <span class="hljs-comment">// ... 计算逻辑</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">getMinMaxByReference</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">int</span>* arr, <span class="hljs-type">int</span> size, <span class="hljs-type">int</span>&amp; min, <span class="hljs-type">int</span>&amp; max)</span> </span>&#123;<br>    min = arr[<span class="hljs-number">0</span>];<br>    max = arr[<span class="hljs-number">0</span>];<br>    <span class="hljs-comment">// ... 计算逻辑</span><br>&#125;<br><br></code></pre></td></tr></table></figure>
<h2 id="五-引用高级用法"><a href="#五-引用高级用法" class="headerlink" title="五-引用高级用法"></a><a class="markdownIt-Anchor" href="#五-引用高级用法"></a> 五、引用高级用法</h2>
<p>5.1 引用与const</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 四种组合</span><br><span class="hljs-type">int</span> data = <span class="hljs-number">10</span>;<br><br><span class="hljs-comment">// 1. 非常量引用（可以修改）</span><br><span class="hljs-type">int</span>&amp; ref1 = data;<br>ref1 = <span class="hljs-number">20</span>;  <span class="hljs-comment">// 可以修改</span><br><br><span class="hljs-comment">// 2. 常量引用（只读）</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span>&amp; ref2 = data;<br><span class="hljs-comment">// ref2 = 30;  // 错误：不能通过ref2修改</span><br><br><span class="hljs-comment">// 3. 对常量的引用（绑定到常量）</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> constData = <span class="hljs-number">40</span>;<br><span class="hljs-comment">// int&amp; ref3 = constData;  // 错误：不能绑定非常量引用到常量</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span>&amp; ref4 = constData;  <span class="hljs-comment">// 正确</span><br><br><span class="hljs-comment">// 4. 临时对象的引用</span><br><span class="hljs-comment">// int&amp; ref5 = 50;  // 错误：不能绑定非常量引用到字面量</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span>&amp; ref6 = <span class="hljs-number">50</span>;  <span class="hljs-comment">// 正确：常引用可以</span><br><br></code></pre></td></tr></table></figure>
<p>5.2 引用在范围for循环中的应用</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs cpp">vector&lt;<span class="hljs-type">int</span>&gt; vec = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>&#125;;<br><br><span class="hljs-comment">// 值传递：复制每个元素（效率低）</span><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> num : vec) &#123;<br>    num *= <span class="hljs-number">2</span>;  <span class="hljs-comment">// 只修改副本</span><br>&#125;<br><span class="hljs-comment">// vec内容不变：1, 2, 3, 4, 5</span><br><br><span class="hljs-comment">// 引用传递：直接操作元素（效率高）</span><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span>&amp; num : vec) &#123;<br>    num *= <span class="hljs-number">2</span>;  <span class="hljs-comment">// 修改原元素</span><br>&#125;<br><span class="hljs-comment">// vec内容变为：2, 4, 6, 8, 10</span><br><br><span class="hljs-comment">// 常引用：只读访问</span><br><span class="hljs-keyword">for</span> (<span class="hljs-type">const</span> <span class="hljs-type">int</span>&amp; num : vec) &#123;<br>    <span class="hljs-comment">// num *= 2;  // 错误：不能修改</span><br>    cout &lt;&lt; num &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<p>5.3 右值引用（C++11新特性）</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 左值引用：绑定到左值（有名字、有地址的对象）</span><br><span class="hljs-type">int</span> x = <span class="hljs-number">10</span>;<br><span class="hljs-type">int</span>&amp; lref = x;  <span class="hljs-comment">// 左值引用</span><br><br><span class="hljs-comment">// 右值引用：绑定到右值（临时对象、字面量）</span><br><span class="hljs-type">int</span>&amp;&amp; rref1 = <span class="hljs-number">42</span>;         <span class="hljs-comment">// 字面量是右值</span><br><span class="hljs-type">int</span>&amp;&amp; rref2 = x + <span class="hljs-number">5</span>;      <span class="hljs-comment">// 表达式结果是右值</span><br><br><span class="hljs-comment">// 移动语义：高效转移资源所有权</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyString</span> &#123;<br><span class="hljs-keyword">private</span>:<br>    <span class="hljs-type">char</span>* data;<br><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-comment">// 移动构造函数</span><br>    <span class="hljs-built_in">MyString</span>(MyString&amp;&amp; other) <span class="hljs-keyword">noexcept</span><br>        : <span class="hljs-built_in">data</span>(other.data) &#123;<br>        other.data = <span class="hljs-literal">nullptr</span>;  <span class="hljs-comment">// 置空原指针</span><br>    &#125;<br><br>    <span class="hljs-comment">// 移动赋值运算符</span><br>    MyString&amp; <span class="hljs-keyword">operator</span>=(MyString&amp;&amp; other) <span class="hljs-keyword">noexcept</span> &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span> != &amp;other) &#123;<br>            <span class="hljs-keyword">delete</span>[] data;<br>            data = other.data;<br>            other.data = <span class="hljs-literal">nullptr</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> *<span class="hljs-keyword">this</span>;<br>    &#125;<br>&#125;;<br><br></code></pre></td></tr></table></figure>
<h2 id="六-引用在类中的应用"><a href="#六-引用在类中的应用" class="headerlink" title="六-引用在类中的应用"></a><a class="markdownIt-Anchor" href="#六-引用在类中的应用"></a> 六、引用在类中的应用</h2>
<p>6.1 成员引用</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span> &#123;<br><span class="hljs-keyword">private</span>:<br>    string&amp; nameRef;  <span class="hljs-comment">// 引用成员</span><br><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-comment">// 引用成员必须在构造函数的初始化列表中初始化</span><br>    <span class="hljs-built_in">Student</span>(string&amp; name) : <span class="hljs-built_in">nameRef</span>(name) &#123;&#125;<br><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">display</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>&#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;学生姓名: &quot;</span> &lt;&lt; nameRef &lt;&lt; endl;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">rename</span><span class="hljs-params">(string&amp; newName)</span> </span>&#123;<br>        <span class="hljs-comment">// nameRef = newName;  // 重新绑定？错误！</span><br>        <span class="hljs-comment">// 引用不能重新绑定，所以这里实际上不能修改</span><br>    &#125;<br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    string studentName = <span class="hljs-string">&quot;张三&quot;</span>;<br>    <span class="hljs-function">Student <span class="hljs-title">s</span><span class="hljs-params">(studentName)</span></span>;<br>    s.<span class="hljs-built_in">display</span>();<br><br>    string newName = <span class="hljs-string">&quot;李四&quot;</span>;<br>    <span class="hljs-comment">// s.rename(newName);  // 不能修改引用绑定</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<p>6.2 返回*this（链式调用）</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Calculator</span> &#123;<br><span class="hljs-keyword">private</span>:<br>    <span class="hljs-type">double</span> result;<br><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">Calculator</span>() : <span class="hljs-built_in">result</span>(<span class="hljs-number">0</span>) &#123;&#125;<br><br>    <span class="hljs-comment">// 返回引用支持链式调用</span><br>    <span class="hljs-function">Calculator&amp; <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-type">double</span> value)</span> </span>&#123;<br>        result += value;<br>        <span class="hljs-keyword">return</span> *<span class="hljs-keyword">this</span>;  <span class="hljs-comment">// 返回当前对象的引用</span><br>    &#125;<br><br>    <span class="hljs-function">Calculator&amp; <span class="hljs-title">subtract</span><span class="hljs-params">(<span class="hljs-type">double</span> value)</span> </span>&#123;<br>        result -= value;<br>        <span class="hljs-keyword">return</span> *<span class="hljs-keyword">this</span>;<br>    &#125;<br><br>    <span class="hljs-function">Calculator&amp; <span class="hljs-title">multiply</span><span class="hljs-params">(<span class="hljs-type">double</span> value)</span> </span>&#123;<br>        result *= value;<br>        <span class="hljs-keyword">return</span> *<span class="hljs-keyword">this</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">getResult</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    Calculator calc;<br><br>    <span class="hljs-comment">// 链式调用</span><br>    calc.<span class="hljs-built_in">add</span>(<span class="hljs-number">10</span>).<span class="hljs-built_in">subtract</span>(<span class="hljs-number">3</span>).<span class="hljs-built_in">multiply</span>(<span class="hljs-number">2</span>).<span class="hljs-built_in">add</span>(<span class="hljs-number">5</span>);<br>    cout &lt;&lt; <span class="hljs-string">&quot;结果: &quot;</span> &lt;&lt; calc.<span class="hljs-built_in">getResult</span>() &lt;&lt; endl;  <span class="hljs-comment">// 19</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<h2 id="七-引用常见陷阱"><a href="#七-引用常见陷阱" class="headerlink" title="七-引用常见陷阱"></a><a class="markdownIt-Anchor" href="#七-引用常见陷阱"></a> 七、引用常见陷阱</h2>
<p>7.1 返回局部变量的引用</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 错误示例</span><br><span class="hljs-function"><span class="hljs-type">int</span>&amp; <span class="hljs-title">badExample</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-type">int</span> localVar = <span class="hljs-number">100</span>;  <span class="hljs-comment">// 局部变量</span><br>    <span class="hljs-keyword">return</span> localVar;     <span class="hljs-comment">// 返回局部变量的引用</span><br>&#125;  <span class="hljs-comment">// localVar被销毁，返回的引用变成悬空引用</span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-type">int</span>&amp; ref = <span class="hljs-built_in">badExample</span>();<br>    <span class="hljs-comment">// 危险！ref现在指向已销毁的内存</span><br>    <span class="hljs-comment">// cout &lt;&lt; ref &lt;&lt; endl;  // 未定义行为</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<p>7.2 引用与指针的混淆</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">int</span> x = <span class="hljs-number">10</span>;<br><br><span class="hljs-comment">// 正确的引用用法</span><br><span class="hljs-type">int</span>&amp; ref = x;<br><br><span class="hljs-comment">// 常见的混淆错误</span><br><span class="hljs-comment">// int&amp; ref = &amp;x;        // 错误：引用不需要取地址</span><br><span class="hljs-comment">// int&amp; ref = *(&amp;x);     // 虽然能编译，但不推荐</span><br><br><span class="hljs-comment">// 指针和引用的混合使用</span><br><span class="hljs-type">int</span>* ptr = &amp;x;<br><span class="hljs-type">int</span>&amp; refFromPtr = *ptr;  <span class="hljs-comment">// 正确：解引用指针得到引用</span><br><br><span class="hljs-comment">// 但这样更清晰</span><br><span class="hljs-type">int</span>&amp; refDirect = x;<br><br></code></pre></td></tr></table></figure>
<p>7.3 引用数组元素时的越界</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">int</span> arr[<span class="hljs-number">5</span>] = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>&#125;;<br><br><span class="hljs-comment">// 返回引用时要注意边界检查</span><br><span class="hljs-function"><span class="hljs-type">int</span>&amp; <span class="hljs-title">getElement</span><span class="hljs-params">(<span class="hljs-type">int</span> index)</span> </span>&#123;<br>    <span class="hljs-comment">// 危险：没有边界检查</span><br>    <span class="hljs-keyword">return</span> arr[index];<br>&#125;<br><br><span class="hljs-comment">// 改进版本</span><br><span class="hljs-function"><span class="hljs-type">int</span>&amp; <span class="hljs-title">safeGetElement</span><span class="hljs-params">(<span class="hljs-type">int</span> index)</span> </span>&#123;<br>    <span class="hljs-keyword">if</span> (index &gt;= <span class="hljs-number">0</span> &amp;&amp; index &lt; <span class="hljs-number">5</span>) &#123;<br>        <span class="hljs-keyword">return</span> arr[index];<br>    &#125;<br>    <span class="hljs-comment">// 返回静态变量或抛出异常</span><br>    <span class="hljs-type">static</span> <span class="hljs-type">int</span> error = <span class="hljs-number">-1</span>;<br>    <span class="hljs-keyword">return</span> error;<br>&#125;<br></code></pre></td></tr></table></figure>
<h1 id="递归"><a href="#递归" class="headerlink" title="递归"></a><a class="markdownIt-Anchor" href="#递归"></a> 递归</h1>
<h2 id="一-什么是递归"><a href="#一-什么是递归" class="headerlink" title="一-什么是递归"></a><a class="markdownIt-Anchor" href="#一-什么是递归"></a> 一、什么是递归？</h2>
<p>函数调用自身，把大问题拆成小问题，小问题再拆成更小的问题…</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">func</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-comment">// ...</span><br>    <span class="hljs-built_in">func</span>();  <span class="hljs-comment">// 👈 调用自己</span><br>    <span class="hljs-comment">// ...</span><br>&#125;<br><br></code></pre></td></tr></table></figure>
<hr />
<h2 id="二-递归的两个核心要素"><a href="#二-递归的两个核心要素" class="headerlink" title="二-递归的两个核心要素"></a><a class="markdownIt-Anchor" href="#二-递归的两个核心要素"></a> 二、递归的两个核心要素</h2>
<ol>
<li>终止条件（必须要有！）</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">if</span> (终止条件) &#123;<br>    <span class="hljs-keyword">return</span>;  <span class="hljs-comment">// 不再调用自己</span><br>&#125;<br><br></code></pre></td></tr></table></figure>
<p>没有终止条件 = 死循环 → 栈溢出</p>
<ol>
<li>递归调用（问题规模缩小）</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-built_in">func</span>(更小的范围);  <span class="hljs-comment">// 向终止条件靠近</span><br><br></code></pre></td></tr></table></figure>
<hr />
<h2 id="三-递归的执行过程"><a href="#三-递归的执行过程" class="headerlink" title="三-递归的执行过程"></a><a class="markdownIt-Anchor" href="#三-递归的执行过程"></a> 三、递归的执行过程</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">func</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span> </span>&#123;<br>    <span class="hljs-keyword">if</span> (n == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;  <span class="hljs-comment">// 终止条件</span><br>    cout &lt;&lt; <span class="hljs-string">&quot;递: &quot;</span> &lt;&lt; n;<br>    <span class="hljs-built_in">func</span>(n - <span class="hljs-number">1</span>);         <span class="hljs-comment">// 递归调用</span><br>    cout &lt;&lt; <span class="hljs-string">&quot;归: &quot;</span> &lt;&lt; n;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<p>调用 func(3)：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">递: 3 → 递: 2 → 递: 1 → 触底<br>                        ← 归: 1 ← 归: 2 ← 归: 3<br><br></code></pre></td></tr></table></figure>
<p>阶段 动作  栈状态<br />
递 向下调用 栈帧增加<br />
归 向上返回 栈帧释放</p>
<hr />
<h2 id="四-递归的核心认知最难但也最重要"><a href="#四-递归的核心认知最难但也最重要" class="headerlink" title="四-递归的核心认知最难但也最重要"></a><a class="markdownIt-Anchor" href="#四-递归的核心认知最难但也最重要"></a> 四、递归的核心认知（最难但也最重要）</h2>
<p>✅ 每一层都是独立的函数调用！</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">quickSort</span><span class="hljs-params">(arr, <span class="hljs-number">0</span>, <span class="hljs-number">5</span>)</span> </span>&#123;  <span class="hljs-comment">// 第1层</span><br>    <span class="hljs-type">int</span> pi = <span class="hljs-built_in">partition</span>(...); <span class="hljs-comment">// pi=2</span><br>    <span class="hljs-built_in">quickSort</span>(arr, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>);    <span class="hljs-comment">// 👈 第2层</span><br>    <span class="hljs-built_in">quickSort</span>(arr, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>);    <span class="hljs-comment">// 👈 另一第2层</span><br>&#125;<br><br></code></pre></td></tr></table></figure>
<pre><code>    每一层有       是否独立
</code></pre>
<p>参数    low, high     独立，值可能相同但互不影响<br />
局部变量 i, pi         独立，同名但不是同一个</p>
<p>返回值   给上一层用，不是给下一层</p>
<p>递归不是代码在重复，是函数的每一层分身各干各的活！</p>
<hr />
<h2 id="六-递归-vs-循环"><a href="#六-递归-vs-循环" class="headerlink" title="六-递归-vs-循环"></a><a class="markdownIt-Anchor" href="#六-递归-vs-循环"></a> 六、递归 vs 循环</h2>
<p>维度 递归             循环<br />
本质 函数调用自己    重复执行代码块<br />
内存 每层新栈帧      共享同一栈帧<br />
速度 略慢（调用开销）    快<br />
代码 简洁，符合数学思维  直观<br />
终止 必须显式条件    条件不成立即止<br />
适用 树、分治、回溯    线性遍历</p>
<p>递归能做的循环都能做，但有些问题递归更自然（如快排、二叉树）。</p>
<hr />
<h2 id="七-常见误区"><a href="#七-常见误区" class="headerlink" title="七-常见误区"></a><a class="markdownIt-Anchor" href="#七-常见误区"></a> 七、常见误区</h2>
<p>误区1：递归是“代码复用”</p>
<p>真相：是函数复用，不是代码复用</p>
<p>误区2：下一层能用上一层的变量</p>
<p>真相：参数传值，不是共享变量</p>
<p>误区3：没创建新数组怎么递归</p>
<p>真相：用指针/索引画圈，不复制数据</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-built_in">quickSort</span>(arr, low, pi - <span class="hljs-number">1</span>);  <span class="hljs-comment">// 没创建新数组，只是移动指针！</span><br><br></code></pre></td></tr></table></figure>
<p>误区4：返回值是给自己用</p>
<p>真相：返回值是给上一层用的！</p>
<hr />
<h2 id="八-快排中的递归完美案例"><a href="#八-快排中的递归完美案例" class="headerlink" title="八-快排中的递归完美案例"></a><a class="markdownIt-Anchor" href="#八-快排中的递归完美案例"></a> 八、快排中的递归（完美案例）</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">quickSort</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; arr, <span class="hljs-type">int</span> low, <span class="hljs-type">int</span> high)</span> </span>&#123;<br>    <span class="hljs-keyword">if</span> (low &lt; high) &#123;                          <span class="hljs-comment">// 1. 终止条件</span><br>        <span class="hljs-type">int</span> pi = <span class="hljs-built_in">partition</span>(arr, low, high);    <span class="hljs-comment">// 2. 当前层工作</span><br>        <span class="hljs-built_in">quickSort</span>(arr, low, pi - <span class="hljs-number">1</span>);           <span class="hljs-comment">// 3. 递归左半（规模缩小）</span><br>        <span class="hljs-built_in">quickSort</span>(arr, pi + <span class="hljs-number">1</span>, high);          <span class="hljs-comment">// 4. 递归右半（规模缩小）</span><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<p>代码行 作用<br />
if (low &lt; high) 终止条件：只剩0/1个元素就停<br />
partition(…) 当前层：归位一个数<br />
quickSort(…, pi-1) 递归：处理更小的左区间<br />
quickSort(…, pi+1) 递归：处理更小的右区间</p>
<p>每层只归位一个数，n个元素需要n层递归（最坏情况）。</p>
<p>—​</p>
<h1 id="struct-class"><a href="#struct-class" class="headerlink" title="struct-class"></a><a class="markdownIt-Anchor" href="#struct-class"></a> Struct、Class</h1>
<h2 id="一-基本概念与区别"><a href="#一-基本概念与区别" class="headerlink" title="一-基本概念与区别"></a><a class="markdownIt-Anchor" href="#一-基本概念与区别"></a> 一、基本概念与区别</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">1.1 什么是结构体(struct)和类(class)<br>· 结构体(struct)：用于将不同类型的数据组合成一个复合数据类型<br>· 类(class)：面向对象编程的核心，包含数据和操作数据的方法<br><br>1.2 主要区别对比表<br>特性                      结构体(struct)                  类(class)<br>默认访问权限               public（公共）                  private（私有）<br>设计思想                  数据聚合                        对象封装<br>典型用途                  简单数据存储、配置参数             复杂对象建模、业务逻辑<br>继承                     支持（但少用）                    支持（面向对象核心）<br>构造函数                  支持                            支持<br></code></pre></td></tr></table></figure>
<h2 id="二-结构体struct的功能与使用"><a href="#二-结构体struct的功能与使用" class="headerlink" title="二-结构体struct的功能与使用"></a><a class="markdownIt-Anchor" href="#二-结构体struct的功能与使用"></a> 二、结构体(struct)的功能与使用</h2>
<p>2.1 主要功能</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">数据打包：            将相关变量组合成一个单元<br>创建自定义数据类型：    定义新的数据类型<br>传递复杂数据：         函数参数可以传递整个结构体<br></code></pre></td></tr></table></figure>
<p>2.2 使用方式</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 1. 定义结构体</span><br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Student</span> &#123;<br>    <span class="hljs-type">int</span> id;<br>    string name;<br>    <span class="hljs-type">int</span> age;<br>&#125;;<br><br><span class="hljs-comment">// 2. 创建结构体变量</span><br>Student s1;                     <span class="hljs-comment">// 方式1：默认创建</span><br>Student s2 = &#123;<span class="hljs-number">1001</span>, <span class="hljs-string">&quot;张三&quot;</span>, <span class="hljs-number">20</span>&#125;; <span class="hljs-comment">// 方式2：初始化</span><br>Student s3&#123;<span class="hljs-number">1002</span>, <span class="hljs-string">&quot;李四&quot;</span>, <span class="hljs-number">21</span>&#125;;    <span class="hljs-comment">// 方式3：C++11统一初始化</span><br><br><span class="hljs-comment">// 3. 访问成员</span><br>s<span class="hljs-number">1.</span>id = <span class="hljs-number">1003</span>;<br>s<span class="hljs-number">1.</span>name = <span class="hljs-string">&quot;王五&quot;</span>;<br>s<span class="hljs-number">1.</span>age = <span class="hljs-number">22</span>;<br><br><span class="hljs-comment">// 4. 作为函数参数</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">printStudent</span><span class="hljs-params">(Student s)</span> </span>&#123;<br>    cout &lt;&lt; s.name &lt;&lt; <span class="hljs-string">&quot; &quot;</span> &lt;&lt; s.age &lt;&lt; <span class="hljs-string">&quot;岁&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>2.3 何时使用结构体</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">· 只有数据，没有方法<br>· 简单的数据记录（如坐标点、颜色）<br>· 配置参数集合<br>· 函数需要返回多个值<br></code></pre></td></tr></table></figure>
<h2 id="三-类class的功能与使用"><a href="#三-类class的功能与使用" class="headerlink" title="三-类class的功能与使用"></a><a class="markdownIt-Anchor" href="#三-类class的功能与使用"></a> 三、类(class)的功能与使用</h2>
<p>3.1 主要功能</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">封装：隐藏内部实现，暴露安全接口<br>数据保护：通过访问控制保护数据安全<br>对象建模：模拟现实世界中的对象<br>代码复用：通过继承和多态实现<br></code></pre></td></tr></table></figure>
<p>3.2 使用方式</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 1. 定义类（带访问控制）</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">BankAccount</span> &#123;<br><span class="hljs-keyword">private</span>:    <span class="hljs-comment">// 私有：只能在类内部访问</span><br>    <span class="hljs-type">double</span> balance;<br>    string password;<br><br><span class="hljs-keyword">public</span>:     <span class="hljs-comment">// 公共：外部可以访问</span><br>    <span class="hljs-comment">// 构造函数</span><br>    <span class="hljs-built_in">BankAccount</span>(<span class="hljs-type">double</span> initial) &#123;<br>        balance = initial;<br>    &#125;<br><br>    <span class="hljs-comment">// 公共方法（接口）</span><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">deposit</span><span class="hljs-params">(<span class="hljs-type">double</span> amount)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (amount &gt; <span class="hljs-number">0</span>) balance += amount;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">getBalance</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> balance;<br>    &#125;<br>&#125;;<br><br><span class="hljs-comment">// 2. 创建对象</span><br><span class="hljs-function">BankAccount <span class="hljs-title">account</span><span class="hljs-params">(<span class="hljs-number">1000.0</span>)</span></span>;  <span class="hljs-comment">// 调用构造函数</span><br><br><span class="hljs-comment">// 3. 使用对象</span><br>account.<span class="hljs-built_in">deposit</span>(<span class="hljs-number">500.0</span>);       <span class="hljs-comment">// 调用公共方法</span><br><span class="hljs-type">double</span> money = account.<span class="hljs-built_in">getBalance</span>();<br><br><span class="hljs-comment">// 4. 不能直接访问私有成员</span><br><span class="hljs-comment">// account.balance = 10000;   // 错误！balance是私有的</span><br></code></pre></td></tr></table></figure>
<p>3.3 访问控制关键字</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">· public：任何地方都可以访问<br>· private：只能在类内部访问<br>· protected：类内部和派生类可以访问<br></code></pre></td></tr></table></figure>
<p>3.4 何时使用类</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">· 需要数据隐藏和保护<br>· 有复杂的业务逻辑<br>· 需要继承和多态<br>· 对象有状态和行为<br>· 需要控制数据的访问方式<br></code></pre></td></tr></table></figure>
<h2 id="四-实际选择指南"><a href="#四-实际选择指南" class="headerlink" title="四-实际选择指南"></a><a class="markdownIt-Anchor" href="#四-实际选择指南"></a> 四、实际选择指南</h2>
<p>4.1 选择结构体的场景</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">情况：定义二维坐标点<br>选择：struct Point &#123; double x; double y; &#125;<br>理由：只有数据，没有复杂逻辑<br><br>情况：配置文件参数<br>选择：struct Config &#123; int width; int height; string theme; &#125;<br>理由：简单数据聚合<br><br>情况：函数返回多个值<br>选择：struct Result &#123; bool success; string message; int code; &#125;<br>理由：打包返回数据<br></code></pre></td></tr></table></figure>
<p>4.2 选择类的场景</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">情况：银行账户<br>选择：class BankAccount &#123; private余额; public存款/取款方法 &#125;<br>理由：需要保护余额，控制访问方式<br><br>情况：游戏角色<br>选择：class Character &#123; private生命值; public攻击/防御方法 &#125;<br>理由：有状态和行为，需要封装<br><br>情况：数据库连接<br>选择：class Database &#123; private连接句柄; public查询/关闭方法 &#125;<br>理由：需要资源管理，隐藏实现细节<br></code></pre></td></tr></table></figure>
<h1 id="vector-array"><a href="#vector-array" class="headerlink" title="vector-array"></a><a class="markdownIt-Anchor" href="#vector-array"></a> vector、array</h1>
<h2 id="一-array数组基础"><a href="#一-array数组基础" class="headerlink" title="一-array数组基础"></a><a class="markdownIt-Anchor" href="#一-array数组基础"></a> 一、Array（数组）基础</h2>
<p>1.1 数组是什么</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">数组是固定大小、连续内存存储的相同类型元素的集合。<br></code></pre></td></tr></table></figure>
<p>1.2 两种数组类型</p>
<p>传统C风格数组</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 声明和初始化</span><br><span class="hljs-type">int</span> arr1[<span class="hljs-number">5</span>];                    <span class="hljs-comment">// 未初始化，值是随机的</span><br><span class="hljs-type">int</span> arr2[<span class="hljs-number">5</span>] = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>&#125;;        <span class="hljs-comment">// 部分初始化，后面自动补0</span><br><span class="hljs-type">int</span> arr3[] = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>&#125;;   <span class="hljs-comment">// 自动推断大小为5</span><br><span class="hljs-type">int</span> arr4[<span class="hljs-number">3</span>] = &#123;<span class="hljs-number">0</span>&#125;;              <span class="hljs-comment">// 全部初始化为0</span><br><br><span class="hljs-comment">// 二维数组</span><br><span class="hljs-type">int</span> matrix[<span class="hljs-number">2</span>][<span class="hljs-number">3</span>] = &#123;<br>    &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>&#125;,<br>    &#123;<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>&#125;<br>&#125;;<br><br><span class="hljs-comment">// 使用</span><br>arr2[<span class="hljs-number">0</span>] = <span class="hljs-number">10</span>;                   <span class="hljs-comment">// 修改第一个元素</span><br><span class="hljs-type">int</span> x = arr2[<span class="hljs-number">1</span>];                <span class="hljs-comment">// 读取第二个元素</span><br></code></pre></td></tr></table></figure>
<p>C++11 std::array（推荐）</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;array&gt;</span></span><br><br>std::array&lt;<span class="hljs-type">int</span>, 5&gt; arr1;                 <span class="hljs-comment">// 5个int，默认初始化为0</span><br>std::array&lt;<span class="hljs-type">int</span>, 3&gt; arr2 = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>&#125;;     <span class="hljs-comment">// 初始化列表</span><br><span class="hljs-keyword">auto</span> arr3 = std::array&lt;<span class="hljs-type">int</span>, <span class="hljs-number">4</span>&gt;&#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>&#125;;  <span class="hljs-comment">// C++11统一初始化</span><br><br><span class="hljs-comment">// 有更多成员函数</span><br><span class="hljs-type">int</span> size = arr<span class="hljs-number">1.</span><span class="hljs-built_in">size</span>();                   <span class="hljs-comment">// 获取大小</span><br><span class="hljs-type">bool</span> empty = arr<span class="hljs-number">1.</span><span class="hljs-built_in">empty</span>();                <span class="hljs-comment">// 判断是否为空</span><br><span class="hljs-type">int</span> first = arr<span class="hljs-number">1.f</span>ront();                 <span class="hljs-comment">// 第一个元素</span><br><span class="hljs-type">int</span> last = arr<span class="hljs-number">1.</span><span class="hljs-built_in">back</span>();                   <span class="hljs-comment">// 最后一个元素</span><br><span class="hljs-type">int</span> val = arr<span class="hljs-number">1.</span><span class="hljs-built_in">at</span>(<span class="hljs-number">2</span>);                     <span class="hljs-comment">// 带边界检查的访问</span><br></code></pre></td></tr></table></figure>
<h2 id="二-vector向量基础"><a href="#二-vector向量基础" class="headerlink" title="二-vector向量基础"></a><a class="markdownIt-Anchor" href="#二-vector向量基础"></a> 二、Vector（向量）基础</h2>
<p>2.1 Vector是什么</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">Vector是动态数组，大小可以运行时改变，自动管理内存。<br></code></pre></td></tr></table></figure>
<p>2.2 Vector基本使用</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-comment">// 创建vector</span><br>std::vector&lt;<span class="hljs-type">int</span>&gt; vec1;                    <span class="hljs-comment">// 空vector</span><br><span class="hljs-function">std::vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">vec2</span><span class="hljs-params">(<span class="hljs-number">5</span>)</span></span>;                 <span class="hljs-comment">// 5个元素，都初始化为0</span><br><span class="hljs-function">std::vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">vec3</span><span class="hljs-params">(<span class="hljs-number">5</span>, <span class="hljs-number">10</span>)</span></span>;             <span class="hljs-comment">// 5个元素，都初始化为10</span><br>std::vector&lt;<span class="hljs-type">int</span>&gt; vec4 = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>&#125;;  <span class="hljs-comment">// 初始化列表</span><br><span class="hljs-function">std::vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">vec5</span><span class="hljs-params">(vec4)</span></span>;              <span class="hljs-comment">// 拷贝构造</span><br><br><span class="hljs-comment">// 添加元素</span><br>vec<span class="hljs-number">1.</span><span class="hljs-built_in">push_back</span>(<span class="hljs-number">10</span>);      <span class="hljs-comment">// 在末尾添加10</span><br>vec<span class="hljs-number">1.</span><span class="hljs-built_in">push_back</span>(<span class="hljs-number">20</span>);      <span class="hljs-comment">// 在末尾添加20</span><br>vec<span class="hljs-number">1.</span><span class="hljs-built_in">push_back</span>(<span class="hljs-number">30</span>);      <span class="hljs-comment">// 在末尾添加30</span><br><br><span class="hljs-comment">// 访问元素</span><br><span class="hljs-type">int</span> first = vec1[<span class="hljs-number">0</span>];     <span class="hljs-comment">// 通过下标访问（无边界检查）</span><br><span class="hljs-type">int</span> second = vec<span class="hljs-number">1.</span><span class="hljs-built_in">at</span>(<span class="hljs-number">1</span>); <span class="hljs-comment">// 通过at访问（有边界检查，越界会抛出异常）</span><br><br><span class="hljs-comment">// 删除元素</span><br>vec<span class="hljs-number">1.</span><span class="hljs-built_in">pop_back</span>();         <span class="hljs-comment">// 删除最后一个元素</span><br></code></pre></td></tr></table></figure>
<h2 id="三-核心区别对比"><a href="#三-核心区别对比" class="headerlink" title="三-核心区别对比"></a><a class="markdownIt-Anchor" href="#三-核心区别对比"></a> 三、核心区别对比</h2>
<p>3.1 内存管理方式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">数组（Array）：<br>栈上： [元素][元素][元素]...（直接存储）<br>大小在编译时确定<br><br>向量（Vector）：<br>栈上： [指针][大小][容量]<br>        ↓<br>堆上： [元素][元素][元素]...<br></code></pre></td></tr></table></figure>
<p>3.2 大小变化能力</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// Array：固定大小</span><br><span class="hljs-type">int</span> arr[<span class="hljs-number">5</span>];  <span class="hljs-comment">// 永远只有5个元素</span><br><span class="hljs-comment">// arr[5] = 10;  // 错误！数组越界</span><br><br><span class="hljs-comment">// Vector：动态大小</span><br>std::vector&lt;<span class="hljs-type">int</span>&gt; vec;<br>vec.<span class="hljs-built_in">push_back</span>(<span class="hljs-number">1</span>);  <span class="hljs-comment">// 大小：1</span><br>vec.<span class="hljs-built_in">push_back</span>(<span class="hljs-number">2</span>);  <span class="hljs-comment">// 大小：2</span><br>vec.<span class="hljs-built_in">push_back</span>(<span class="hljs-number">3</span>);  <span class="hljs-comment">// 大小：3</span><br>vec.<span class="hljs-built_in">pop_back</span>();    <span class="hljs-comment">// 大小：2</span><br></code></pre></td></tr></table></figure>
<h2 id="四-常用操作详解"><a href="#四-常用操作详解" class="headerlink" title="四-常用操作详解"></a><a class="markdownIt-Anchor" href="#四-常用操作详解"></a> 四、常用操作详解</h2>
<p>4.1 Vector的容量管理</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs cpp">std::vector&lt;<span class="hljs-type">int</span>&gt; vec;<br><br><span class="hljs-comment">// 容量相关</span><br>vec.<span class="hljs-built_in">size</span>();        <span class="hljs-comment">// 当前元素个数</span><br>vec.<span class="hljs-built_in">capacity</span>();    <span class="hljs-comment">// 当前分配的内存能容纳的元素数</span><br>vec.<span class="hljs-built_in">empty</span>();       <span class="hljs-comment">// 是否为空</span><br>vec.<span class="hljs-built_in">reserve</span>(<span class="hljs-number">100</span>);  <span class="hljs-comment">// 预留100个元素的空间（避免多次扩容）</span><br><br><span class="hljs-comment">// 调整大小</span><br>vec.<span class="hljs-built_in">resize</span>(<span class="hljs-number">10</span>);    <span class="hljs-comment">// 调整为10个元素，新增的用0填充</span><br>vec.<span class="hljs-built_in">resize</span>(<span class="hljs-number">15</span>, <span class="hljs-number">5</span>); <span class="hljs-comment">// 调整为15个元素，新增的用5填充</span><br>vec.<span class="hljs-built_in">resize</span>(<span class="hljs-number">3</span>);     <span class="hljs-comment">// 调整为3个元素，删除多余的元素</span><br></code></pre></td></tr></table></figure>
<p>4.2 遍历方式对比</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 两种结构都支持的遍历方式：</span><br><br><span class="hljs-comment">// 1. 下标遍历（最常用）</span><br><span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; vec.<span class="hljs-built_in">size</span>(); i++) &#123;<br>    std::cout &lt;&lt; vec[i] &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;<br>&#125;<br><br><span class="hljs-comment">// 2. 范围for循环（C++11）</span><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> num : vec) &#123;<br>    std::cout &lt;&lt; num &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;<br>&#125;<br><br><span class="hljs-comment">// 3. 迭代器遍历</span><br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> it = vec.<span class="hljs-built_in">begin</span>(); it != vec.<span class="hljs-built_in">end</span>(); it++) &#123;<br>    std::cout &lt;&lt; *it &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>4.3 插入和删除</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs cpp">std::vector&lt;<span class="hljs-type">int</span>&gt; vec = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>&#125;;<br><br><span class="hljs-comment">// 在指定位置插入</span><br>vec.<span class="hljs-built_in">insert</span>(vec.<span class="hljs-built_in">begin</span>() + <span class="hljs-number">2</span>, <span class="hljs-number">100</span>);  <span class="hljs-comment">// 在第3个位置插入100</span><br><span class="hljs-comment">// 结果：&#123;1, 2, 100, 3, 4, 5&#125;</span><br><br><span class="hljs-comment">// 删除指定位置</span><br>vec.<span class="hljs-built_in">erase</span>(vec.<span class="hljs-built_in">begin</span>() + <span class="hljs-number">1</span>);        <span class="hljs-comment">// 删除第2个元素</span><br><span class="hljs-comment">// 结果：&#123;1, 100, 3, 4, 5&#125;</span><br><br><span class="hljs-comment">// 删除指定范围</span><br>vec.<span class="hljs-built_in">erase</span>(vec.<span class="hljs-built_in">begin</span>() + <span class="hljs-number">1</span>, vec.<span class="hljs-built_in">begin</span>() + <span class="hljs-number">3</span>);<br><span class="hljs-comment">// 结果：&#123;1, 4, 5&#125;</span><br><br><span class="hljs-comment">// 清空所有</span><br>vec.<span class="hljs-built_in">clear</span>();  <span class="hljs-comment">// 大小变为0，但容量不变</span><br></code></pre></td></tr></table></figure>
<h1 id="左值和右值"><a href="#左值和右值" class="headerlink" title="左值和右值"></a><a class="markdownIt-Anchor" href="#左值和右值"></a> 左值和右值</h1>
<h2 id="一-基本概念"><a href="#一-基本概念" class="headerlink" title="一-基本概念"></a><a class="markdownIt-Anchor" href="#一-基本概念"></a> 一、基本概念</h2>
<p>1.1 左值 vs 右值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">左值（Lvalue）：像“左手拿的容器”<br>· 有名字的变量<br>· 有明确的内存地址<br>· 可以取地址（&amp;）<br>· 可以放在赋值语句左边<br><br>右值（Rvalue）：像“右手拿的值”<br>· 临时的、一次性的值<br>· 没有名字<br>· 通常不能取地址<br>· 只能放在赋值语句右边<br></code></pre></td></tr></table></figure>
<p>1.2 简单例子</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">int</span> a = <span class="hljs-number">10</span>;      <span class="hljs-comment">// a是左值（容器），10是右值（值）</span><br><span class="hljs-type">int</span> b = a;       <span class="hljs-comment">// b是左值，a是左值（但这里a被当作右值使用）</span><br><br>a = <span class="hljs-number">5</span>;           <span class="hljs-comment">// ✅ 正确：a是左值，可以放左边</span><br><span class="hljs-number">5</span> = a;           <span class="hljs-comment">// ❌ 错误：5是右值，不能放左边</span><br>(a + <span class="hljs-number">1</span>) = <span class="hljs-number">5</span>;     <span class="hljs-comment">// ❌ 错误：(a+1)是右值（计算结果）</span><br><br></code></pre></td></tr></table></figure>
<h2 id="二-分类详解"><a href="#二-分类详解" class="headerlink" title="二-分类详解"></a><a class="markdownIt-Anchor" href="#二-分类详解"></a> 二、分类详解</h2>
<p>2.1 什么是左值？</p>
<p>左值特征：有身份、有地址、可持久</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">int</span> x = <span class="hljs-number">5</span>;              <span class="hljs-comment">// x是左值</span><br><span class="hljs-type">int</span> arr[<span class="hljs-number">10</span>];            <span class="hljs-comment">// arr是左值</span><br><span class="hljs-type">int</span>* ptr = &amp;x;          <span class="hljs-comment">// ptr是左值</span><br>string str = <span class="hljs-string">&quot;hello&quot;</span>;   <span class="hljs-comment">// str是左值</span><br><br><span class="hljs-comment">// 验证：可以取地址</span><br>&amp;x;     <span class="hljs-comment">// ✅ 可以</span><br>&amp;arr;   <span class="hljs-comment">// ✅ 可以</span><br>&amp;str;   <span class="hljs-comment">// ✅ 可以</span><br><br></code></pre></td></tr></table></figure>
<p>2.2 什么是右值？</p>
<p>右值特征：临时的、一次性的、用完即弃</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 常见的右值：</span><br><span class="hljs-number">5</span>;                     <span class="hljs-comment">// 字面量（纯右值）</span><br>x + <span class="hljs-number">3</span>;                 <span class="hljs-comment">// 表达式结果（纯右值）</span><br><span class="hljs-built_in">func</span>();                <span class="hljs-comment">// 函数返回值（纯右值）</span><br>std::<span class="hljs-built_in">move</span>(x);          <span class="hljs-comment">// 将亡值（xvalue）</span><br><span class="hljs-built_in">string</span>(<span class="hljs-string">&quot;hello&quot;</span>);       <span class="hljs-comment">// 临时对象</span><br><br><span class="hljs-comment">// 验证：不能取地址</span><br>&amp;<span class="hljs-number">5</span>;                    <span class="hljs-comment">// ❌ 错误</span><br>&amp;(x + <span class="hljs-number">3</span>);              <span class="hljs-comment">// ❌ 错误</span><br>&amp;<span class="hljs-built_in">func</span>();               <span class="hljs-comment">// ❌ 错误</span><br><br></code></pre></td></tr></table></figure>
<h2 id="三-实际代码判断"><a href="#三-实际代码判断" class="headerlink" title="三-实际代码判断"></a><a class="markdownIt-Anchor" href="#三-实际代码判断"></a> 三、实际代码判断</h2>
<p>3.1 左值例子</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-comment">// 这些都是左值</span><br>    <span class="hljs-type">int</span> a = <span class="hljs-number">10</span>;                <span class="hljs-comment">// ✅ a是左值</span><br>    <span class="hljs-type">int</span>&amp; ref = a;              <span class="hljs-comment">// ✅ ref是左值引用</span><br>    <span class="hljs-type">const</span> <span class="hljs-type">int</span> c = <span class="hljs-number">20</span>;          <span class="hljs-comment">// ✅ c是左值（常量左值）</span><br>    <span class="hljs-type">int</span> arr[<span class="hljs-number">5</span>] = &#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>&#125;;  <span class="hljs-comment">// ✅ arr是左值</span><br><br>    <span class="hljs-comment">// 左值可以放左边</span><br>    a = <span class="hljs-number">100</span>;                   <span class="hljs-comment">// ✅</span><br>    arr[<span class="hljs-number">0</span>] = <span class="hljs-number">10</span>;              <span class="hljs-comment">// ✅</span><br><br>    <span class="hljs-comment">// 左值可以取地址</span><br>    <span class="hljs-type">int</span>* p1 = &amp;a;             <span class="hljs-comment">// ✅</span><br>    <span class="hljs-type">int</span>* p2 = &amp;arr[<span class="hljs-number">0</span>];        <span class="hljs-comment">// ✅</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<p>3.2 右值例子</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">getNumber</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">42</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-type">int</span> x = <span class="hljs-number">5</span>;<br><br>    <span class="hljs-comment">// 这些都是右值</span><br>    <span class="hljs-type">int</span> a = <span class="hljs-number">10</span>;             <span class="hljs-comment">// 10是右值（字面量）</span><br>    <span class="hljs-type">int</span> b = x + <span class="hljs-number">3</span>;          <span class="hljs-comment">// (x+3)是右值（表达式）</span><br>    <span class="hljs-type">int</span> c = <span class="hljs-built_in">getNumber</span>();    <span class="hljs-comment">// getNumber()是右值</span><br><br>    <span class="hljs-comment">// 典型的右值位置（只能放右边）</span><br>    x = <span class="hljs-number">20</span>;                 <span class="hljs-comment">// 20是右值</span><br>    x = x * <span class="hljs-number">2</span>;              <span class="hljs-comment">// (x*2)是右值</span><br><br>    <span class="hljs-comment">// 下面这些都是错误的</span><br>    <span class="hljs-comment">// 10 = x;              // ❌ 错误：10是右值</span><br>    <span class="hljs-comment">// (x+1) = 10;          // ❌ 错误：(x+1)是右值</span><br>    <span class="hljs-comment">// getNumber() = 100;   // ❌ 错误：函数返回值是右值</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<h2 id="四-左值引用-vs-右值引用"><a href="#四-左值引用-vs-右值引用" class="headerlink" title="四-左值引用-vs-右值引用"></a><a class="markdownIt-Anchor" href="#四-左值引用-vs-右值引用"></a> 四、左值引用 vs 右值引用</h2>
<p>4.1 左值引用（&amp;）</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">int</span> a = <span class="hljs-number">10</span>;<br><span class="hljs-type">int</span>&amp; ref1 = a;     <span class="hljs-comment">// ✅ 正确：左值引用绑定到左值</span><br><span class="hljs-comment">// int&amp; ref2 = 5;  // ❌ 错误：左值引用不能绑定到右值</span><br><span class="hljs-comment">// int&amp; ref3 = a+1; // ❌ 错误：不能绑定到表达式结果</span><br><br><span class="hljs-type">const</span> <span class="hljs-type">int</span>&amp; ref4 = <span class="hljs-number">5</span>;  <span class="hljs-comment">// ✅ 正确：const左值引用可以绑定到右值</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span>&amp; ref5 = a<span class="hljs-number">+2</span>; <span class="hljs-comment">// ✅ 正确</span><br><br></code></pre></td></tr></table></figure>
<p>4.2 右值引用（&amp;&amp;，C++11新特性）</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">int</span> a = <span class="hljs-number">10</span>;<br><br><span class="hljs-type">int</span>&amp;&amp; rref1 = <span class="hljs-number">5</span>;           <span class="hljs-comment">// ✅ 正确：右值引用绑定到字面量</span><br><span class="hljs-type">int</span>&amp;&amp; rref2 = a + <span class="hljs-number">3</span>;       <span class="hljs-comment">// ✅ 正确：绑定到表达式结果</span><br><span class="hljs-type">int</span>&amp;&amp; rref3 = std::<span class="hljs-built_in">move</span>(a);<span class="hljs-comment">// ✅ 正确：将左值转为右值引用</span><br><br><span class="hljs-comment">// int&amp;&amp; rref4 = a;        // ❌ 错误：右值引用不能直接绑定到左值</span><br><br></code></pre></td></tr></table></figure>
<h2 id="五-移动语义为什么要有右值引用"><a href="#五-移动语义为什么要有右值引用" class="headerlink" title="五-移动语义为什么要有右值引用"></a><a class="markdownIt-Anchor" href="#五-移动语义为什么要有右值引用"></a> 五、移动语义（为什么要有右值引用？）</h2>
<p>5.1 问题的由来</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">BigObject</span> &#123;<br>    <span class="hljs-type">int</span>* data;  <span class="hljs-comment">// 大量数据</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-comment">// 传统拷贝：深拷贝，性能差</span><br>    <span class="hljs-built_in">BigObject</span>(<span class="hljs-type">const</span> BigObject&amp; other) &#123;<br>        data = <span class="hljs-keyword">new</span> <span class="hljs-type">int</span>[<span class="hljs-number">100</span>];<br>        <span class="hljs-comment">// 复制所有数据... 很慢！</span><br>    &#125;<br>&#125;;<br><br><span class="hljs-function">BigObject <span class="hljs-title">createObject</span><span class="hljs-params">()</span> </span>&#123;<br>    BigObject obj;<br>    <span class="hljs-comment">// ... 填充数据</span><br>    <span class="hljs-keyword">return</span> obj;  <span class="hljs-comment">// 这里会发生拷贝！</span><br>&#125;<br><br></code></pre></td></tr></table></figure>
<p>5.2 解决方案：移动语义</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">BigObject</span> &#123;<br>    <span class="hljs-type">int</span>* data;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-comment">// 移动构造函数：&quot;偷取&quot;资源，不复制</span><br>    <span class="hljs-built_in">BigObject</span>(BigObject&amp;&amp; other) <span class="hljs-keyword">noexcept</span> &#123;<br>        data = other.data;    <span class="hljs-comment">// 直接接管指针</span><br>        other.data = <span class="hljs-literal">nullptr</span>; <span class="hljs-comment">// 原对象置空</span><br>        <span class="hljs-comment">// 没有复制数据！性能极高</span><br>    &#125;<br><br>    <span class="hljs-comment">// 移动赋值运算符</span><br>    BigObject&amp; <span class="hljs-keyword">operator</span>=(BigObject&amp;&amp; other) <span class="hljs-keyword">noexcept</span> &#123;<br>        <span class="hljs-keyword">delete</span>[] data;        <span class="hljs-comment">// 释放自己的资源</span><br>        data = other.data;    <span class="hljs-comment">// 接管别人的资源</span><br>        other.data = <span class="hljs-literal">nullptr</span>;<br>        <span class="hljs-keyword">return</span> *<span class="hljs-keyword">this</span>;<br>    &#125;<br>&#125;;<br><br>BigObject obj1;<br>BigObject obj2 = std::<span class="hljs-built_in">move</span>(obj1);  <span class="hljs-comment">// 调用移动构造函数，高效！</span><br><br></code></pre></td></tr></table></figure>
<h2 id="六-stdmove-的作用"><a href="#六-stdmove-的作用" class="headerlink" title="六-stdmove-的作用"></a><a class="markdownIt-Anchor" href="#六-stdmove-的作用"></a> 六、std::move 的作用</h2>
<p>6.1 std::move 是什么？</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">· 不是移动，而是类型转换<br>· 将左值转换为右值引用<br>· 告诉编译器：&quot;这个对象可以被移动&quot;<br></code></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs cpp">string str1 = <span class="hljs-string">&quot;Hello&quot;</span>;<br>string str2 = <span class="hljs-string">&quot;World&quot;</span>;<br><br><span class="hljs-comment">// 传统拷贝（效率低）</span><br>string str3 = str1;  <span class="hljs-comment">// 调用拷贝构造函数，复制所有字符</span><br><br><span class="hljs-comment">// 使用移动（效率高）</span><br>string str4 = std::<span class="hljs-built_in">move</span>(str1);  <span class="hljs-comment">// 调用移动构造函数</span><br><span class="hljs-comment">// 现在：str1变成空字符串，str4得到&quot;Hello&quot;</span><br><span class="hljs-comment">// 没有字符复制，只是指针转移</span><br><br></code></pre></td></tr></table></figure>
<h2 id="七-实际应用场景"><a href="#七-实际应用场景" class="headerlink" title="七-实际应用场景"></a><a class="markdownIt-Anchor" href="#七-实际应用场景"></a> 七、实际应用场景</h2>
<p>7.1 什么时候考虑右值？</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">✅ 使用右值引用和移动语义的场景：<br>1. 函数返回大对象时<br>2. 容器插入元素时<br>3. 实现资源管理类（智能指针、字符串等）<br>4. 避免不必要的深拷贝<br><br></code></pre></td></tr></table></figure>
<h2 id="八-快速判断技巧"><a href="#八-快速判断技巧" class="headerlink" title="八-快速判断技巧"></a><a class="markdownIt-Anchor" href="#八-快速判断技巧"></a> 八、快速判断技巧</h2>
<p>8.1 如何判断左值右值？</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">问自己三个问题：<br>能不能取地址？ → 能：左值，不能：可能是右值<br>能不能放赋值左边？ → 能：左值，不能：右值<br>是临时的吗？ → 是：右值，不是：左值<br></code></pre></td></tr></table></figure>
<p>8.2 简单判断口诀</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">有名字 → 通常是左值<br>字面量 → 肯定是右值<br>表达式 → 通常是右值<br>函数返回非引用 → 右值<br>std::move()的结果 → 右值引用<br><br></code></pre></td></tr></table></figure>
<h1 id="退化"><a href="#退化" class="headerlink" title="退化"></a><a class="markdownIt-Anchor" href="#退化"></a> 退化</h1>
<h2 id="一-什么是类型退化"><a href="#一-什么是类型退化" class="headerlink" title="一-什么是类型退化"></a><a class="markdownIt-Anchor" href="#一-什么是类型退化"></a> 一、什么是类型退化？</h2>
<p>类型退化是C++中某些类型在特定上下文中自动丢失部分类型信息，变为更简单类型的过程。<br />
​</p>
<h2 id="二-退化的三种主要情况"><a href="#二-退化的三种主要情况" class="headerlink" title="二-退化的三种主要情况"></a><a class="markdownIt-Anchor" href="#二-退化的三种主要情况"></a> 二、退化的三种主要情况</h2>
<p>2.1 数组退化为指针（最常见）</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 定义一个数组</span><br><span class="hljs-type">int</span> arr[<span class="hljs-number">5</span>] = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>&#125;;<br><br><span class="hljs-comment">// 退化发生：数组 → 指针</span><br><span class="hljs-type">int</span>* ptr = arr;  <span class="hljs-comment">// arr从 int[5] 退化为 int*</span><br><br><span class="hljs-comment">// 发生了什么变化？</span><br><span class="hljs-comment">// 1. 丢失了数组大小信息（5 这个信息没了）</span><br><span class="hljs-comment">// 2. 丢失了&quot;我是数组&quot;这个信息</span><br><span class="hljs-comment">// 3. 变成了普通的指针</span><br><br><span class="hljs-comment">// 验证：</span><br>cout &lt;&lt; <span class="hljs-built_in">sizeof</span>(arr) &lt;&lt; endl;    <span class="hljs-comment">// 输出 20 (5*4)</span><br>cout &lt;&lt; <span class="hljs-built_in">sizeof</span>(ptr) &lt;&lt; endl;    <span class="hljs-comment">// 输出 8 (指针大小)</span><br><span class="hljs-comment">// 看！大小信息丢失了</span><br></code></pre></td></tr></table></figure>
<p>​<br />
2.2 函数退化为函数指针</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 定义一个函数</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">sayHello</span><span class="hljs-params">()</span> </span>&#123;<br>    cout &lt;&lt; <span class="hljs-string">&quot;Hello!&quot;</span> &lt;&lt; endl;<br>&#125;<br><br><span class="hljs-comment">// 退化发生：函数 → 函数指针</span><br><span class="hljs-built_in">void</span> (*funcPtr)() = sayHello;  <span class="hljs-comment">// sayHello 从 void() 退化为 void(*)()</span><br><br><span class="hljs-comment">// 调用方式看起来一样，但类型变了</span><br><span class="hljs-built_in">sayHello</span>();     <span class="hljs-comment">// 直接调用函数</span><br><span class="hljs-built_in">funcPtr</span>();      <span class="hljs-comment">// 通过指针调用函数</span><br><br><span class="hljs-comment">// 关键区别：函数类型包含更多信息，函数指针只包含地址</span><br></code></pre></td></tr></table></figure>
<p>​<br />
2.3 顶层const/volatile被丢弃</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 顶层const：修饰变量本身</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> a = <span class="hljs-number">10</span>;        <span class="hljs-comment">// a本身是const</span><br><br><span class="hljs-comment">// 在类型推导中，顶层const会被丢弃</span><br><span class="hljs-comment">// 例如模板参数推导时：</span><br><span class="hljs-function"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> T&gt;</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">func</span><span class="hljs-params">(T param)</span> </span>&#123;<br>    <span class="hljs-comment">// 如果传入const int，T会被推导为int，不是const int</span><br>&#125;<br><br><span class="hljs-built_in">func</span>(a);  <span class="hljs-comment">// T被推导为int，const被丢弃了</span><br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="三-数组退化的详细分析"><a href="#三-数组退化的详细分析" class="headerlink" title="三-数组退化的详细分析"></a><a class="markdownIt-Anchor" href="#三-数组退化的详细分析"></a> 三、数组退化的详细分析</h2>
<p>3.1 什么时候发生数组退化？</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">int</span> arr[<span class="hljs-number">5</span>];<br><br><span class="hljs-comment">// ✅ 会发生退化的场景：</span><br><span class="hljs-comment">// 1. 赋值给指针</span><br><span class="hljs-type">int</span>* p1 = arr;              <span class="hljs-comment">// 退化</span><br><br><span class="hljs-comment">// 2. 作为函数参数传递</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">func</span><span class="hljs-params">(<span class="hljs-type">int</span> param[])</span> </span>&#123;    <span class="hljs-comment">// 这里param已经是int*了</span><br>    <span class="hljs-comment">// 无法知道数组大小！</span><br>&#125;<br><br><span class="hljs-comment">// 3. 参与表达式</span><br><span class="hljs-type">int</span>* p2 = arr + <span class="hljs-number">1</span>;          <span class="hljs-comment">// 退化</span><br><span class="hljs-type">bool</span> same = (arr == p1);    <span class="hljs-comment">// 退化后比较</span><br><br><span class="hljs-comment">// ❌ 不会发生退化的场景：</span><br><span class="hljs-comment">// 1. 使用sizeof</span><br><span class="hljs-type">int</span> size = <span class="hljs-built_in">sizeof</span>(arr);     <span class="hljs-comment">// 不退化，得到20</span><br><br><span class="hljs-comment">// 2. 使用取地址&amp;</span><br><span class="hljs-built_in">int</span> (*p3)[<span class="hljs-number">5</span>] = &amp;arr;        <span class="hljs-comment">// 不退化，得到int(*)[5]</span><br><br><span class="hljs-comment">// 3. 用decltype</span><br><span class="hljs-keyword">decltype</span>(arr) arr2;         <span class="hljs-comment">// 不退化，类型是int[5]</span><br></code></pre></td></tr></table></figure>
<p>​<br />
3.2 退化带来的问题</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-comment">// 问题1：无法知道数组大小</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">printArray</span><span class="hljs-params">(<span class="hljs-type">int</span> arr[])</span> </span>&#123;  <span class="hljs-comment">// 实际上是 int* arr</span><br>    <span class="hljs-comment">// 错误！这得到的是指针大小，不是数组大小</span><br>    <span class="hljs-comment">// int size = sizeof(arr) / sizeof(arr[0]); // 错误！</span><br><br>    <span class="hljs-comment">// 只能额外传递大小参数</span><br>&#125;<br><br><span class="hljs-comment">// 问题2：二维数组退化更复杂</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">printMatrix</span><span class="hljs-params">(<span class="hljs-type">int</span> matrix[][<span class="hljs-number">3</span>], <span class="hljs-type">int</span> rows)</span> </span>&#123;<br>    <span class="hljs-comment">// matrix从int[][3]退化为int(*)[3]</span><br>    <span class="hljs-comment">// 至少还保留了列数信息</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-type">int</span> arr[<span class="hljs-number">5</span>] = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>&#125;;<br>    <span class="hljs-type">int</span> matrix[<span class="hljs-number">2</span>][<span class="hljs-number">3</span>] = &#123;&#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>&#125;, &#123;<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>&#125;&#125;;<br><br>    <span class="hljs-built_in">printArray</span>(arr);      <span class="hljs-comment">// arr退化为int*</span><br>    <span class="hljs-built_in">printMatrix</span>(matrix, <span class="hljs-number">2</span>); <span class="hljs-comment">// matrix退化为int(*)[3]</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="四-如何防止退化"><a href="#四-如何防止退化" class="headerlink" title="四-如何防止退化"></a><a class="markdownIt-Anchor" href="#四-如何防止退化"></a> 四、如何防止退化？</h2>
<p>4.1 使用引用（最佳方法）<br />
// 方法1：使用引用传递数组</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> T, <span class="hljs-type">size_t</span> N&gt;</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">printArray</span><span class="hljs-params">(T (&amp;arr)[N])</span> </span>&#123;  <span class="hljs-comment">// 引用，不退化！</span><br>    cout &lt;&lt; <span class="hljs-string">&quot;数组大小: &quot;</span> &lt;&lt; N &lt;&lt; endl;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; N; i++) &#123;<br>        cout &lt;&lt; arr[i] &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;<br>    &#125;<br>    cout &lt;&lt; endl;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-type">int</span> arr[] = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>&#125;;<br>    <span class="hljs-built_in">printArray</span>(arr);  <span class="hljs-comment">// 不退化，N自动推导为5</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>​<br />
4.2 使用std::array（现代C++）</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;array&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">processArray</span><span class="hljs-params">(std::array&lt;<span class="hljs-type">int</span>, <span class="hljs-number">5</span>&gt;&amp; arr)</span> </span>&#123;<br>    <span class="hljs-comment">// std::array不会退化！</span><br>    cout &lt;&lt; <span class="hljs-string">&quot;大小: &quot;</span> &lt;&lt; arr.<span class="hljs-built_in">size</span>() &lt;&lt; endl;<br>    <span class="hljs-comment">// 所有信息都保留</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    std::array&lt;<span class="hljs-type">int</span>, 5&gt; arr = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>&#125;;<br>    <span class="hljs-built_in">processArray</span>(arr);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>​<br />
4.3 使用指针+大小组组</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 虽然退化，但可以通过传递大小来弥补</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">process</span><span class="hljs-params">(<span class="hljs-type">int</span>* data, <span class="hljs-type">size_t</span> size)</span> </span>&#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; size; i++) &#123;<br>        cout &lt;&lt; data[i] &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-type">int</span> arr[<span class="hljs-number">5</span>] = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>&#125;;<br>    <span class="hljs-built_in">process</span>(arr, <span class="hljs-built_in">sizeof</span>(arr)/<span class="hljs-built_in">sizeof</span>(arr[<span class="hljs-number">0</span>]));<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>​<br />
五、函数退化的细节<br />
5.1 函数什么时候退化？</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> a + b;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-comment">// 函数名单独使用时会退化</span><br>    <span class="hljs-built_in">int</span> (*funcPtr)(<span class="hljs-type">int</span>, <span class="hljs-type">int</span>) = add;  <span class="hljs-comment">// add退化为函数指针</span><br><br>    <span class="hljs-comment">// 这些情况都会退化：</span><br>    <span class="hljs-comment">// 1. 赋值</span><br>    <span class="hljs-comment">// 2. 作为参数传递</span><br>    <span class="hljs-comment">// 3. 初始化变量</span><br><br>    <span class="hljs-comment">// 这些情况不会退化：</span><br>    <span class="hljs-comment">// 1. 取地址&amp;</span><br>    <span class="hljs-built_in">int</span> (*funcPtr2)(<span class="hljs-type">int</span>, <span class="hljs-type">int</span>) = &amp;add;  <span class="hljs-comment">// 明确取地址</span><br>    <span class="hljs-comment">// 2. 函数引用</span><br>    <span class="hljs-built_in">int</span> (&amp;funcRef)(<span class="hljs-type">int</span>, <span class="hljs-type">int</span>) = add;    <span class="hljs-comment">// 引用，不退化</span><br><br>    <span class="hljs-comment">// 调用方式都相同</span><br>    cout &lt;&lt; <span class="hljs-built_in">add</span>(<span class="hljs-number">3</span>, <span class="hljs-number">4</span>) &lt;&lt; endl;         <span class="hljs-comment">// 7</span><br>    cout &lt;&lt; <span class="hljs-built_in">funcPtr</span>(<span class="hljs-number">3</span>, <span class="hljs-number">4</span>) &lt;&lt; endl;     <span class="hljs-comment">// 7</span><br>    cout &lt;&lt; <span class="hljs-built_in">funcRef</span>(<span class="hljs-number">3</span>, <span class="hljs-number">4</span>) &lt;&lt; endl;     <span class="hljs-comment">// 7</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<h1 id="强制类型转换"><a href="#强制类型转换" class="headerlink" title="强制类型转换"></a><a class="markdownIt-Anchor" href="#强制类型转换"></a> 强制类型转换</h1>
<h2 id="一-为什么需要强制类型转换"><a href="#一-为什么需要强制类型转换" class="headerlink" title="一-为什么需要强制类型转换"></a><a class="markdownIt-Anchor" href="#一-为什么需要强制类型转换"></a> 一、为什么需要强制类型转换？</h2>
<p>1.1 问题背景</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">double</span> pi = <span class="hljs-number">3.14159</span>;<br><span class="hljs-type">int</span> number = pi;  <span class="hljs-comment">// 隐式转换：3（小数部分丢失）</span><br><br><span class="hljs-comment">// 但是有些转换编译器不允许</span><br><span class="hljs-type">void</span>* ptr = &amp;pi;<br><span class="hljs-comment">// int* intPtr = ptr;  // ❌ 错误：不能隐式转换</span><br><br></code></pre></td></tr></table></figure>
<h2 id="二-static_cast最常用的转换"><a href="#二-static_cast最常用的转换" class="headerlink" title="二-static_cast最常用的转换"></a><a class="markdownIt-Anchor" href="#二-static_cast最常用的转换"></a> 二、static_cast：最常用的转换</h2>
<p>2.1 基本用法</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 1. 数值类型转换（最常用）</span><br><span class="hljs-type">double</span> pi = <span class="hljs-number">3.14159</span>;<br><span class="hljs-type">int</span> a = <span class="hljs-built_in">static_cast</span>&lt;<span class="hljs-type">int</span>&gt;(pi);  <span class="hljs-comment">// 3（去掉小数）</span><br><br><span class="hljs-type">float</span> f = <span class="hljs-number">2.5f</span>;<br><span class="hljs-type">int</span> b = <span class="hljs-built_in">static_cast</span>&lt;<span class="hljs-type">int</span>&gt;(f);   <span class="hljs-comment">// 2</span><br><br><span class="hljs-comment">// 2. 相关指针类型转换</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Base</span> &#123;&#125;;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Derived</span> : <span class="hljs-keyword">public</span> Base &#123;&#125;;<br><br>Derived d;<br>Base* basePtr = &amp;d;  <span class="hljs-comment">// 向上转换：安全，可以隐式</span><br><br>Base* b2 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Base</span>();<br><span class="hljs-comment">// Derived* d2 = b2;  // ❌ 错误：不能隐式向下转换</span><br>Derived* d2 = <span class="hljs-built_in">static_cast</span>&lt;Derived*&gt;(b2);  <span class="hljs-comment">// ✅ 但危险！</span><br><br><span class="hljs-comment">// 3. void* 转换</span><br><span class="hljs-type">int</span> x = <span class="hljs-number">100</span>;<br><span class="hljs-type">void</span>* vptr = &amp;x;<br><span class="hljs-type">int</span>* iptr = <span class="hljs-built_in">static_cast</span>&lt;<span class="hljs-type">int</span>*&gt;(vptr);  <span class="hljs-comment">// ✅</span><br><br></code></pre></td></tr></table></figure>
<p>2.2 何时使用static_cast？</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">✅ 适合的场景：<br>1. 基本数值类型转换<br>2. 指针的向上转换（子类→父类）<br>3. 从void*转回具体类型<br>4. 枚举和整数互转<br>5. 显式调用单参数构造函数<br><br>❌ 不适合的场景：<br>1. 不相关类型的指针转换<br>2. 去掉const（用const_cast）<br>3. 运行时类型检查（用dynamic_cast）<br><br></code></pre></td></tr></table></figure>
<h2 id="三-dynamic_cast安全的类型转换"><a href="#三-dynamic_cast安全的类型转换" class="headerlink" title="三-dynamic_cast安全的类型转换"></a><a class="markdownIt-Anchor" href="#三-dynamic_cast安全的类型转换"></a> 三、dynamic_cast：安全的类型转换</h2>
<p>3.1 只能用于多态类型</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-keyword">virtual</span> ~<span class="hljs-built_in">Animal</span>() &#123;&#125;  <span class="hljs-comment">// 必须有虚函数！</span><br>&#125;;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span> : <span class="hljs-keyword">public</span> Animal &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">bark</span><span class="hljs-params">()</span> </span>&#123; cout &lt;&lt; <span class="hljs-string">&quot;汪汪！&quot;</span> &lt;&lt; endl; &#125;<br>&#125;;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Cat</span> : <span class="hljs-keyword">public</span> Animal &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">meow</span><span class="hljs-params">()</span> </span>&#123; cout &lt;&lt; <span class="hljs-string">&quot;喵喵！&quot;</span> &lt;&lt; endl; &#125;<br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    Animal* animal = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Dog</span>();<br><br>    <span class="hljs-comment">// 尝试转换为Dog</span><br>    Dog* dog = <span class="hljs-built_in">dynamic_cast</span>&lt;Dog*&gt;(animal);<br>    <span class="hljs-keyword">if</span> (dog != <span class="hljs-literal">nullptr</span>) &#123;<br>        dog-&gt;<span class="hljs-built_in">bark</span>();  <span class="hljs-comment">// 转换成功</span><br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;不是狗&quot;</span> &lt;&lt; endl;<br>    &#125;<br><br>    <span class="hljs-comment">// 尝试转换为Cat（会失败）</span><br>    Cat* cat = <span class="hljs-built_in">dynamic_cast</span>&lt;Cat*&gt;(animal);<br>    <span class="hljs-keyword">if</span> (cat == <span class="hljs-literal">nullptr</span>) &#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;转换失败：不是猫&quot;</span> &lt;&lt; endl;<br>    &#125;<br><br>    <span class="hljs-keyword">delete</span> animal;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<p>3.2 特点总结</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">运行时检查：转换失败返回nullptr（指针）或抛异常（引用）<br>需要虚函数：类必须有虚函数表<br>性能开销：比static_cast慢<br>只能用于指针/引用<br></code></pre></td></tr></table></figure>
<h2 id="四-const_cast修改常量性"><a href="#四-const_cast修改常量性" class="headerlink" title="四-const_cast修改常量性"></a><a class="markdownIt-Anchor" href="#四-const_cast修改常量性"></a> 四、const_cast：修改常量性</h2>
<p>4.1 基本用法</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 1. 去掉const</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> a = <span class="hljs-number">10</span>;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span>* ptr1 = &amp;a;<br><br><span class="hljs-type">int</span>* ptr2 = <span class="hljs-built_in">const_cast</span>&lt;<span class="hljs-type">int</span>*&gt;(ptr1);  <span class="hljs-comment">// 去掉const</span><br><span class="hljs-comment">// *ptr2 = 20;  // ❌ 危险！未定义行为（a是真正的const）</span><br><br><span class="hljs-comment">// 2. 修改volatile</span><br><span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> b = <span class="hljs-number">30</span>;<br><span class="hljs-type">int</span>* ptr3 = <span class="hljs-built_in">const_cast</span>&lt;<span class="hljs-type">int</span>*&gt;(&amp;b);  <span class="hljs-comment">// 去掉volatile</span><br><br><span class="hljs-comment">// 3. 实际有用场景：调用老式API</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">oldAPI</span><span class="hljs-params">(<span class="hljs-type">char</span>* str)</span> </span>&#123;<br>    <span class="hljs-comment">// 这个函数修改字符串，但不该修改</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">modernCode</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-type">const</span> <span class="hljs-type">char</span>* msg = <span class="hljs-string">&quot;Hello&quot;</span>;<br>    <span class="hljs-comment">// oldAPI(msg);  // ❌ 错误：参数不匹配</span><br>    <span class="hljs-built_in">oldAPI</span>(<span class="hljs-built_in">const_cast</span>&lt;<span class="hljs-type">char</span>*&gt;(msg));  <span class="hljs-comment">// ✅ 但危险！</span><br>&#125;<br><br></code></pre></td></tr></table></figure>
<p>4.2 重要警告！</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">const</span> <span class="hljs-type">int</span> a = <span class="hljs-number">100</span>;          <span class="hljs-comment">// 真正的常量（可能在只读内存）</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span>* p1 = &amp;a;<br><br><span class="hljs-type">int</span>* p2 = <span class="hljs-built_in">const_cast</span>&lt;<span class="hljs-type">int</span>*&gt;(p1);<br>*p2 = <span class="hljs-number">200</span>;                  <span class="hljs-comment">// ❌ 未定义行为！可能崩溃</span><br><br><span class="hljs-comment">// 安全的情况：</span><br><span class="hljs-type">int</span> b = <span class="hljs-number">100</span>;                <span class="hljs-comment">// 非常量</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span>* p3 = &amp;b;         <span class="hljs-comment">// 只是承诺不通过p3修改</span><br><br><span class="hljs-type">int</span>* p4 = <span class="hljs-built_in">const_cast</span>&lt;<span class="hljs-type">int</span>*&gt;(p3);<br>*p4 = <span class="hljs-number">200</span>;                  <span class="hljs-comment">// ✅ 安全！b本来就是变量</span><br><br></code></pre></td></tr></table></figure>
<h2 id="五-reinterpret_cast最危险的转换"><a href="#五-reinterpret_cast最危险的转换" class="headerlink" title="五-reinterpret_cast最危险的转换"></a><a class="markdownIt-Anchor" href="#五-reinterpret_cast最危险的转换"></a> 五、reinterpret_cast：最危险的转换</h2>
<p>5.1 重新解释内存</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-comment">// 1. 指针↔整数（平台相关）</span><br>    <span class="hljs-type">int</span> x = <span class="hljs-number">0x12345678</span>;<br>    <span class="hljs-type">int</span>* ptr = &amp;x;<br><br>    <span class="hljs-type">uintptr_t</span> address = <span class="hljs-built_in">reinterpret_cast</span>&lt;<span class="hljs-type">uintptr_t</span>&gt;(ptr);<br>    cout &lt;&lt; hex &lt;&lt; <span class="hljs-string">&quot;地址: 0x&quot;</span> &lt;&lt; address &lt;&lt; endl;<br><br>    <span class="hljs-comment">// 2. 不同类型指针转换</span><br>    <span class="hljs-type">float</span> f = <span class="hljs-number">3.14f</span>;<br>    <span class="hljs-type">int</span>* intPtr = <span class="hljs-built_in">reinterpret_cast</span>&lt;<span class="hljs-type">int</span>*&gt;(&amp;f);<br>    cout &lt;&lt; <span class="hljs-string">&quot;浮点数内存表示: 0x&quot;</span> &lt;&lt; *intPtr &lt;&lt; endl;<br><br>    <span class="hljs-comment">// 3. 函数指针转换</span><br>    <span class="hljs-built_in">void</span> (*funcPtr)() = <span class="hljs-built_in">reinterpret_cast</span>&lt;<span class="hljs-built_in">void</span>(*)()&gt;(<span class="hljs-number">0x400000</span>);<br>    <span class="hljs-comment">// 极少使用！</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<p>5.2 使用场景（极少！）</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">reinterpret_cast</span> 只应在以下情况使用：<br><span class="hljs-number">1.</span> 底层系统编程<br><span class="hljs-number">2.</span> 序列化/反序列化<br><span class="hljs-number">3.</span> 与硬件交互<br><span class="hljs-number">4.</span> 实现内存池等特殊数据结构<br><br>普通应用开发中几乎永远不要用！<br></code></pre></td></tr></table></figure>
<h1 id="new-delete"><a href="#new-delete" class="headerlink" title="new-delete"></a><a class="markdownIt-Anchor" href="#new-delete"></a> new、delete</h1>
<h2 id="一-基本概念动态内存管理"><a href="#一-基本概念动态内存管理" class="headerlink" title="一-基本概念动态内存管理"></a><a class="markdownIt-Anchor" href="#一-基本概念动态内存管理"></a> 一、基本概念：动态内存管理</h2>
<p>为什么需要 new/delete？</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 问题：编译时不知道需要多少内存</span><br><span class="hljs-type">int</span> size;<br>cout &lt;&lt; <span class="hljs-string">&quot;需要多少学生？&quot;</span>;<br>cin &gt;&gt; size;  <span class="hljs-comment">// 用户运行时输入</span><br><br><span class="hljs-comment">// ❌ 这样不行：int students[size];</span><br><span class="hljs-comment">// 因为size在编译时未知</span><br><br><span class="hljs-comment">// ✅ 这样可以：动态分配</span><br><span class="hljs-type">int</span>* students = <span class="hljs-keyword">new</span> <span class="hljs-type">int</span>[size];<br></code></pre></td></tr></table></figure>
<h2 id="与普通变量的区别栈内存自动-vs-堆内存手动"><a class="markdownIt-Anchor" href="#与普通变量的区别栈内存自动-vs-堆内存手动"></a> ​<br />
与普通变量的区别<br />
栈内存（自动）             vs   堆内存（手动）</h2>
<p>int x;                          int* p = new int;</p>
<ul>
<li>自动分配                     - 手动分配</li>
<li>函数结束自动释放             - 必须手动释放</li>
<li>大小有限                     - 大小很大（GB级）</li>
<li>分配速度快                   - 分配速度慢</li>
</ul>
<p>​</p>
<h2 id="二-new-的基本用法"><a href="#二-new-的基本用法" class="headerlink" title="二-new-的基本用法"></a><a class="markdownIt-Anchor" href="#二-new-的基本用法"></a> 二、new 的基本用法</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs cpp">分配单个变量<br><span class="hljs-comment">// 语法：类型* 指针 = new 类型;</span><br><span class="hljs-type">int</span>* p1 = <span class="hljs-keyword">new</span> <span class="hljs-type">int</span>;        <span class="hljs-comment">// 分配一个int，不初始化（随机值）</span><br><span class="hljs-type">int</span>* p2 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">int</span>(<span class="hljs-number">42</span>);    <span class="hljs-comment">// 分配并初始化为42</span><br><span class="hljs-type">double</span>* p3 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">double</span>(<span class="hljs-number">3.14</span>);<br><br><span class="hljs-comment">// 使用</span><br>*p1 = <span class="hljs-number">100</span>;<br>cout &lt;&lt; *p2 &lt;&lt; endl;  <span class="hljs-comment">// 42</span><br>cout &lt;&lt; *p3 &lt;&lt; endl;  <span class="hljs-comment">// 3.14</span><br><br>​<br>分配数组<br><span class="hljs-comment">// 语法：类型* 指针 = new 类型[大小];</span><br><span class="hljs-type">int</span>* arr1 = <span class="hljs-keyword">new</span> <span class="hljs-type">int</span>[<span class="hljs-number">5</span>];      <span class="hljs-comment">// 5个int，不初始化</span><br><span class="hljs-type">int</span>* arr2 = <span class="hljs-keyword">new</span> <span class="hljs-type">int</span>[<span class="hljs-number">5</span>]();    <span class="hljs-comment">// 5个int，初始化为0</span><br><span class="hljs-type">int</span>* arr3 = <span class="hljs-keyword">new</span> <span class="hljs-type">int</span>[<span class="hljs-number">5</span>]&#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>&#125;; <span class="hljs-comment">// 5个int，前3个初始化</span><br><br><span class="hljs-comment">// 二维数组</span><br><span class="hljs-type">int</span> rows = <span class="hljs-number">3</span>, cols = <span class="hljs-number">4</span>;<br><span class="hljs-type">int</span>** matrix = <span class="hljs-keyword">new</span> <span class="hljs-type">int</span>*[rows];  <span class="hljs-comment">// 先分配行指针</span><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; rows; i++) &#123;<br>    matrix[i] = <span class="hljs-keyword">new</span> <span class="hljs-type">int</span>[cols];  <span class="hljs-comment">// 每行分配列</span><br>&#125;<br><br><span class="hljs-comment">// 使用</span><br>arr1[<span class="hljs-number">0</span>] = <span class="hljs-number">10</span>;<br>matrix[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">100</span>;<br><br>​<br> 分配对象<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    string name;<br>    <span class="hljs-type">int</span> age;<br><br>    <span class="hljs-built_in">Student</span>(string n = <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-type">int</span> a = <span class="hljs-number">0</span>)<br>        : <span class="hljs-built_in">name</span>(n), <span class="hljs-built_in">age</span>(a) &#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;构造函数&quot;</span> &lt;&lt; endl;<br>    &#125;<br><br>    ~<span class="hljs-built_in">Student</span>() &#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;析构函数&quot;</span> &lt;&lt; endl;<br>    &#125;<br>&#125;;<br><br><span class="hljs-comment">// 分配单个对象</span><br>Student* s1 = <span class="hljs-keyword">new</span> Student;           <span class="hljs-comment">// 默认构造函数</span><br>Student* s2 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Student</span>(<span class="hljs-string">&quot;张三&quot;</span>, <span class="hljs-number">20</span>); <span class="hljs-comment">// 带参数构造</span><br><br><span class="hljs-comment">// 分配对象数组</span><br>Student* class1 = <span class="hljs-keyword">new</span> Student[<span class="hljs-number">3</span>];    <span class="hljs-comment">// 调用3次构造函数</span><br>Student* class2 = <span class="hljs-keyword">new</span> Student[<span class="hljs-number">3</span>]&#123;<br>    <span class="hljs-built_in">Student</span>(<span class="hljs-string">&quot;李四&quot;</span>, <span class="hljs-number">21</span>),<br>    <span class="hljs-built_in">Student</span>(<span class="hljs-string">&quot;王五&quot;</span>, <span class="hljs-number">22</span>),<br>    <span class="hljs-built_in">Student</span>(<span class="hljs-string">&quot;赵六&quot;</span>, <span class="hljs-number">23</span>)<br>&#125;;<br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="三-delete-的基本用法"><a href="#三-delete-的基本用法" class="headerlink" title="三-delete-的基本用法"></a><a class="markdownIt-Anchor" href="#三-delete-的基本用法"></a> 三、delete 的基本用法</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs cpp">释放单个变量<br><span class="hljs-type">int</span>* p = <span class="hljs-keyword">new</span> <span class="hljs-built_in">int</span>(<span class="hljs-number">100</span>);<br><span class="hljs-comment">// 使用 p...</span><br><span class="hljs-keyword">delete</span> p;      <span class="hljs-comment">// 释放内存</span><br>p = <span class="hljs-literal">nullptr</span>;   <span class="hljs-comment">// 好习惯：防止悬空指针</span><br><br><span class="hljs-comment">// ❌ 常见错误：</span><br><span class="hljs-comment">// delete p; delete p;  // 双重释放：崩溃</span><br><span class="hljs-comment">// int x = 10; delete &amp;x;  // 释放栈内存：崩溃</span><br><br>​<br>释放数组<br><span class="hljs-type">int</span>* arr = <span class="hljs-keyword">new</span> <span class="hljs-type">int</span>[<span class="hljs-number">100</span>];<br><span class="hljs-comment">// 使用数组...</span><br><span class="hljs-keyword">delete</span>[] arr;    <span class="hljs-comment">// 注意：必须有 []</span><br>arr = <span class="hljs-literal">nullptr</span>;<br><br><span class="hljs-comment">// ❌ 错误写法：</span><br><span class="hljs-comment">// delete arr;   // 只释放第一个元素，内存泄漏！</span><br><br>​<br>释放对象<br>Student* s = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Student</span>(<span class="hljs-string">&quot;张三&quot;</span>, <span class="hljs-number">20</span>);<br><span class="hljs-comment">// 使用对象...</span><br><span class="hljs-keyword">delete</span> s;        <span class="hljs-comment">// 调用析构函数，释放内存</span><br>s = <span class="hljs-literal">nullptr</span>;<br><br>Student* students = <span class="hljs-keyword">new</span> Student[<span class="hljs-number">5</span>];<br><span class="hljs-comment">// 使用对象数组...</span><br><span class="hljs-keyword">delete</span>[] students;  <span class="hljs-comment">// 调用5次析构函数</span><br>students = <span class="hljs-literal">nullptr</span>;<br><br>​<br>释放二维数组<br><span class="hljs-type">int</span> rows = <span class="hljs-number">3</span>;<br><span class="hljs-type">int</span>** matrix = <span class="hljs-keyword">new</span> <span class="hljs-type">int</span>*[rows];<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; rows; i++) &#123;<br>    matrix[i] = <span class="hljs-keyword">new</span> <span class="hljs-type">int</span>[<span class="hljs-number">4</span>];<br>&#125;<br><br><span class="hljs-comment">// 使用...</span><br><br><span class="hljs-comment">// 释放：先释放每行，再释放行指针数组</span><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; rows; i++) &#123;<br>    <span class="hljs-keyword">delete</span>[] matrix[i];<br>&#125;<br><span class="hljs-keyword">delete</span>[] matrix;<br>matrix = <span class="hljs-literal">nullptr</span>;<br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="四-常见错误与陷阱"><a href="#四-常见错误与陷阱" class="headerlink" title="四-常见错误与陷阱"></a><a class="markdownIt-Anchor" href="#四-常见错误与陷阱"></a> 四、常见错误与陷阱</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs cpp">内存泄漏（忘记<span class="hljs-keyword">delete</span>）<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">leakMemory</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-type">int</span>* p = <span class="hljs-keyword">new</span> <span class="hljs-type">int</span>[<span class="hljs-number">1000</span>];<br>    <span class="hljs-comment">// 忘记 delete[] p;</span><br>    <span class="hljs-comment">// 每次调用泄漏1000*4字节</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">noLeak</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-type">int</span>* p = <span class="hljs-keyword">new</span> <span class="hljs-type">int</span>[<span class="hljs-number">1000</span>];<br>    <span class="hljs-comment">// 使用...</span><br>    <span class="hljs-keyword">delete</span>[] p;  <span class="hljs-comment">// ✅ 正确释放</span><br>&#125;<br><br>​<br>悬空指针（使用已释放的内存）<br><span class="hljs-type">int</span>* p = <span class="hljs-keyword">new</span> <span class="hljs-built_in">int</span>(<span class="hljs-number">100</span>);<br><span class="hljs-keyword">delete</span> p;        <span class="hljs-comment">// 内存已释放</span><br><span class="hljs-comment">// p = nullptr;  // 应该加上这句</span><br><br>cout &lt;&lt; *p &lt;&lt; endl;  <span class="hljs-comment">// ❌ 危险！访问已释放内存</span><br>*p = <span class="hljs-number">200</span>;            <span class="hljs-comment">// ❌ 可能导致崩溃</span><br><br>​<br> 野指针（未初始化的指针）<br><span class="hljs-type">int</span>* p;  <span class="hljs-comment">// 野指针，指向随机地址</span><br><span class="hljs-comment">// cout &lt;&lt; *p &lt;&lt; endl;  // ❌ 危险！</span><br><span class="hljs-comment">// *p = 100;            // ❌ 可能破坏其他数据</span><br><br><span class="hljs-comment">// ✅ 正确做法：</span><br><span class="hljs-type">int</span>* p = <span class="hljs-literal">nullptr</span>;  <span class="hljs-comment">// 初始化为空</span><br><span class="hljs-keyword">if</span> (p != <span class="hljs-literal">nullptr</span>) &#123;<br>    *p = <span class="hljs-number">100</span>;      <span class="hljs-comment">// 安全访问</span><br>&#125;<br><br>​<br>数组越界<br><span class="hljs-type">int</span>* arr = <span class="hljs-keyword">new</span> <span class="hljs-type">int</span>[<span class="hljs-number">5</span>];<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">5</span>; i++) &#123;  <span class="hljs-comment">// ❌ 越界！</span><br>    arr[i] = i * <span class="hljs-number">10</span>;<br>&#125;<br><span class="hljs-keyword">delete</span>[] arr;<br><br><span class="hljs-comment">// 可能破坏堆内存管理结构，导致崩溃</span><br></code></pre></td></tr></table></figure>
<p>​​</p>
<h2 id="悬空指针问题"><a href="#悬空指针问题" class="headerlink" title="悬空指针问题"></a><a class="markdownIt-Anchor" href="#悬空指针问题"></a> 悬空指针问题</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">delete</span>后的状态：<br><span class="hljs-type">int</span> *ptr = <span class="hljs-keyword">new</span> <span class="hljs-built_in">int</span>(<span class="hljs-number">100</span>);<br><span class="hljs-keyword">delete</span> ptr;  <span class="hljs-comment">// 释放堆内存</span><br><br><span class="hljs-comment">// 现在：</span><br><span class="hljs-comment">// ptr值不变（还是那个地址）</span><br><span class="hljs-comment">// 但地址对应的内存已释放</span><br><span class="hljs-comment">// ptr成为&quot;悬空指针&quot;</span><br>​<br>危险操作：<br>*ptr = <span class="hljs-number">200</span>;    <span class="hljs-comment">// ❌ Use-After-Free（访问已释放内存）</span><br><span class="hljs-keyword">delete</span> ptr;    <span class="hljs-comment">// ❌ Double Free（二次释放）</span><br>​<br>解决方案：<br><span class="hljs-keyword">delete</span> ptr;<br>ptr = <span class="hljs-literal">nullptr</span>;  <span class="hljs-comment">// ✅ 立即置空，避免悬空指针</span><br><br></code></pre></td></tr></table></figure>
<h1 id="string字符串"><a href="#string字符串" class="headerlink" title="string字符串"></a><a class="markdownIt-Anchor" href="#string字符串"></a> string字符串</h1>
<h2 id="一-string-是什么为什么重要"><a href="#一-string-是什么为什么重要" class="headerlink" title="一-string-是什么为什么重要"></a><a class="markdownIt-Anchor" href="#一-string-是什么为什么重要"></a> 一、string 是什么？为什么重要？</h2>
<p>1.1 string vs C风格字符串</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// ❌ C风格字符串（麻烦、危险）</span><br><span class="hljs-type">char</span> cstr1[<span class="hljs-number">100</span>] = <span class="hljs-string">&quot;Hello&quot;</span>;      <span class="hljs-comment">// 固定大小，可能越界</span><br><span class="hljs-type">char</span>* cstr2 = <span class="hljs-keyword">new</span> <span class="hljs-type">char</span>[<span class="hljs-number">100</span>];     <span class="hljs-comment">// 手动管理内存</span><br><span class="hljs-built_in">strcpy</span>(cstr2, <span class="hljs-string">&quot;World&quot;</span>);          <span class="hljs-comment">// 可能缓冲区溢出</span><br><span class="hljs-comment">// 需要记得 delete[] cstr2;</span><br><br><span class="hljs-comment">// ✅ C++ string（安全、方便）</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string&gt;</span></span><br><span class="hljs-keyword">using</span> std::string;<br><br>string str1 = <span class="hljs-string">&quot;Hello&quot;</span>;           <span class="hljs-comment">// 自动管理内存</span><br><span class="hljs-function">string <span class="hljs-title">str2</span><span class="hljs-params">(<span class="hljs-string">&quot;World&quot;</span>)</span></span>;            <span class="hljs-comment">// 各种初始化方式</span><br><span class="hljs-comment">// 无需手动管理内存！不会缓冲区溢出！</span><br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="二-string-基本操作"><a href="#二-string-基本操作" class="headerlink" title="二-string-基本操作"></a><a class="markdownIt-Anchor" href="#二-string-基本操作"></a> 二、string 基本操作</h2>
<p>2.1 创建和初始化</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 多种初始化方式</span><br>string s1;                    <span class="hljs-comment">// 空字符串 &quot;&quot;</span><br><span class="hljs-function">string <span class="hljs-title">s2</span><span class="hljs-params">(<span class="hljs-string">&quot;Hello&quot;</span>)</span></span>;          <span class="hljs-comment">// 从C字符串初始化</span><br>string s3 = <span class="hljs-string">&quot;World&quot;</span>;         <span class="hljs-comment">// 赋值初始化</span><br><span class="hljs-function">string <span class="hljs-title">s4</span><span class="hljs-params">(<span class="hljs-number">5</span>, <span class="hljs-string">&#x27;A&#x27;</span>)</span></span>;           <span class="hljs-comment">// &quot;AAAAA&quot;（5个A）</span><br><span class="hljs-function">string <span class="hljs-title">s5</span><span class="hljs-params">(s2)</span></span>;               <span class="hljs-comment">// 拷贝构造 &quot;Hello&quot;</span><br><span class="hljs-function">string <span class="hljs-title">s6</span><span class="hljs-params">(s2, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>)</span></span>;         <span class="hljs-comment">// &quot;ell&quot;（从位置1取3个字符）</span><br><br><span class="hljs-comment">// C++11统一初始化</span><br>string s7&#123;<span class="hljs-string">&quot;C++11&quot;</span>&#125;;<br>string s8 = &#123;<span class="hljs-string">&quot;Modern&quot;</span>&#125;;<br></code></pre></td></tr></table></figure>
<p>​<br />
2.2 字符串连接</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs cpp">string s1 = <span class="hljs-string">&quot;Hello&quot;</span>;<br>string s2 = <span class="hljs-string">&quot;World&quot;</span>;<br><br><span class="hljs-comment">// 方法1：+ 运算符</span><br>string s3 = s1 + <span class="hljs-string">&quot; &quot;</span> + s2;      <span class="hljs-comment">// &quot;Hello World&quot;</span><br>string s4 = s1 + <span class="hljs-string">&quot;, &quot;</span> + s2 + <span class="hljs-string">&quot;!&quot;</span>; <span class="hljs-comment">// &quot;Hello, World!&quot;</span><br><br><span class="hljs-comment">// 方法2：+= 运算符</span><br>s1 += <span class="hljs-string">&quot; &quot;</span>;     <span class="hljs-comment">// s1变成 &quot;Hello &quot;</span><br>s1 += s2;      <span class="hljs-comment">// s1变成 &quot;Hello World&quot;</span><br><br><span class="hljs-comment">// 方法3：append()方法</span><br>string s5 = <span class="hljs-string">&quot;Hello&quot;</span>;<br>s<span class="hljs-number">5.</span><span class="hljs-built_in">append</span>(<span class="hljs-string">&quot; &quot;</span>).<span class="hljs-built_in">append</span>(<span class="hljs-string">&quot;World&quot;</span>);  <span class="hljs-comment">// &quot;Hello World&quot;</span><br>s<span class="hljs-number">5.</span><span class="hljs-built_in">append</span>(<span class="hljs-number">3</span>, <span class="hljs-string">&#x27;!&#x27;</span>);               <span class="hljs-comment">// &quot;Hello World!!!&quot;</span><br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="三-字符串访问和修改"><a href="#三-字符串访问和修改" class="headerlink" title="三-字符串访问和修改"></a><a class="markdownIt-Anchor" href="#三-字符串访问和修改"></a> 三、字符串访问和修改</h2>
<p>3.1 访问字符</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs cpp">string str = <span class="hljs-string">&quot;Hello World&quot;</span>;<br><br><span class="hljs-comment">// 方法1：[] 运算符（不检查边界）</span><br><span class="hljs-type">char</span> c1 = str[<span class="hljs-number">0</span>];      <span class="hljs-comment">// &#x27;H&#x27;</span><br>str[<span class="hljs-number">6</span>] = <span class="hljs-string">&#x27;w&#x27;</span>;          <span class="hljs-comment">// 修改为 &quot;Hello world&quot;</span><br><br><span class="hljs-comment">// 方法2：at() 方法（检查边界，越界抛异常）</span><br><span class="hljs-type">char</span> c2 = str.<span class="hljs-built_in">at</span>(<span class="hljs-number">1</span>);   <span class="hljs-comment">// &#x27;e&#x27;</span><br><span class="hljs-comment">// char c3 = str.at(100);  // 抛出 std::out_of_range</span><br><br><span class="hljs-comment">// 方法3：front() 和 back()</span><br><span class="hljs-type">char</span> first = str.<span class="hljs-built_in">front</span>();  <span class="hljs-comment">// &#x27;H&#x27;</span><br><span class="hljs-type">char</span> last = str.<span class="hljs-built_in">back</span>();    <span class="hljs-comment">// &#x27;d&#x27;</span><br><br><span class="hljs-comment">// 遍历字符串</span><br><span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; str.<span class="hljs-built_in">size</span>(); i++) &#123;<br>    cout &lt;&lt; str[i];<br>&#125;<br><br><span class="hljs-keyword">for</span> (<span class="hljs-type">char</span> ch : str) &#123;      <span class="hljs-comment">// C++11范围for循环</span><br>    cout &lt;&lt; ch;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>​<br />
3.2 修改字符串</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs cpp">string str = <span class="hljs-string">&quot;Hello&quot;</span>;<br><br><span class="hljs-comment">// 1. assign() - 替换整个字符串</span><br>str.<span class="hljs-built_in">assign</span>(<span class="hljs-string">&quot;World&quot;</span>);       <span class="hljs-comment">// &quot;World&quot;</span><br>str.<span class="hljs-built_in">assign</span>(<span class="hljs-number">3</span>, <span class="hljs-string">&#x27;X&#x27;</span>);        <span class="hljs-comment">// &quot;XXX&quot;</span><br><br><span class="hljs-comment">// 2. insert() - 插入</span><br>str = <span class="hljs-string">&quot;Hello&quot;</span>;<br>str.<span class="hljs-built_in">insert</span>(<span class="hljs-number">5</span>, <span class="hljs-string">&quot; World&quot;</span>);   <span class="hljs-comment">// &quot;Hello World&quot;</span><br>str.<span class="hljs-built_in">insert</span>(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;!&#x27;</span>);     <span class="hljs-comment">// &quot;!Hello World&quot;</span><br><br><span class="hljs-comment">// 3. erase() - 删除</span><br>str.<span class="hljs-built_in">erase</span>(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>);           <span class="hljs-comment">// &quot;Hello World&quot;（删掉!）</span><br>str.<span class="hljs-built_in">erase</span>(<span class="hljs-number">5</span>);              <span class="hljs-comment">// &quot;Hello&quot;（从位置5删到结尾）</span><br>str.<span class="hljs-built_in">erase</span>();               <span class="hljs-comment">// 清空字符串</span><br><br><span class="hljs-comment">// 4. replace() - 替换部分</span><br>str = <span class="hljs-string">&quot;Hello World&quot;</span>;<br>str.<span class="hljs-built_in">replace</span>(<span class="hljs-number">6</span>, <span class="hljs-number">5</span>, <span class="hljs-string">&quot;C++&quot;</span>);  <span class="hljs-comment">// &quot;Hello C++&quot;</span><br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="四-字符串查询操作"><a href="#四-字符串查询操作" class="headerlink" title="四-字符串查询操作"></a><a class="markdownIt-Anchor" href="#四-字符串查询操作"></a> 四、字符串查询操作</h2>
<p>4.1 查找子串</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs cpp">string text = <span class="hljs-string">&quot;Hello World, Hello C++&quot;</span>;<br><br><span class="hljs-comment">// 1. find() - 从左往右找</span><br><span class="hljs-type">size_t</span> pos1 = text.<span class="hljs-built_in">find</span>(<span class="hljs-string">&quot;Hello&quot;</span>);     <span class="hljs-comment">// 0</span><br><span class="hljs-type">size_t</span> pos2 = text.<span class="hljs-built_in">find</span>(<span class="hljs-string">&quot;Hello&quot;</span>, <span class="hljs-number">1</span>);  <span class="hljs-comment">// 13（从位置1开始找）</span><br><br><span class="hljs-comment">// 2. rfind() - 从右往左找</span><br><span class="hljs-type">size_t</span> pos3 = text.<span class="hljs-built_in">rfind</span>(<span class="hljs-string">&quot;Hello&quot;</span>);    <span class="hljs-comment">// 13（最后一个）</span><br><br><span class="hljs-comment">// 3. find_first_of() - 找任意匹配字符</span><br><span class="hljs-type">size_t</span> pos4 = text.<span class="hljs-built_in">find_first_of</span>(<span class="hljs-string">&quot; ,&quot;</span>);  <span class="hljs-comment">// 5（找到空格）</span><br><br><span class="hljs-comment">// 4. find_first_not_of() - 找不匹配的</span><br><span class="hljs-type">size_t</span> pos5 = text.<span class="hljs-built_in">find_first_not_of</span>(<span class="hljs-string">&quot;Helo &quot;</span>);  <span class="hljs-comment">// 6（找到W）</span><br><br><span class="hljs-comment">// 找不到返回 string::npos</span><br><span class="hljs-keyword">if</span> (text.<span class="hljs-built_in">find</span>(<span class="hljs-string">&quot;Java&quot;</span>) == string::npos) &#123;<br>    cout &lt;&lt; <span class="hljs-string">&quot;没有找到Java&quot;</span> &lt;&lt; endl;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>​<br />
4.2 字符串比较</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs cpp">string s1 = <span class="hljs-string">&quot;apple&quot;</span>;<br>string s2 = <span class="hljs-string">&quot;banana&quot;</span>;<br>string s3 = <span class="hljs-string">&quot;Apple&quot;</span>;  <span class="hljs-comment">// 注意大小写</span><br><br><span class="hljs-comment">// 1. compare() 方法</span><br><span class="hljs-keyword">if</span> (s<span class="hljs-number">1.</span><span class="hljs-built_in">compare</span>(s2) &lt; <span class="hljs-number">0</span>) &#123;<br>    cout &lt;&lt; s1 &lt;&lt; <span class="hljs-string">&quot; &lt; &quot;</span> &lt;&lt; s2 &lt;&lt; endl;  <span class="hljs-comment">// apple &lt; banana</span><br>&#125;<br><br><span class="hljs-keyword">if</span> (s<span class="hljs-number">1.</span><span class="hljs-built_in">compare</span>(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-string">&quot;ap&quot;</span>) == <span class="hljs-number">0</span>) &#123;<br>    cout &lt;&lt; <span class="hljs-string">&quot;前两个字符是 ap&quot;</span> &lt;&lt; endl;<br>&#125;<br><br><span class="hljs-comment">// 2. 关系运算符（更直观）</span><br><span class="hljs-keyword">if</span> (s1 &lt; s2) &#123;        <span class="hljs-comment">// true</span><br>    cout &lt;&lt; <span class="hljs-string">&quot;apple 在 banana 前面&quot;</span> &lt;&lt; endl;<br>&#125;<br><br><span class="hljs-keyword">if</span> (s1 == <span class="hljs-string">&quot;apple&quot;</span>) &#123;  <span class="hljs-comment">// true</span><br>    cout &lt;&lt; <span class="hljs-string">&quot;相等&quot;</span> &lt;&lt; endl;<br>&#125;<br><br><span class="hljs-comment">// 注意：区分大小写</span><br><span class="hljs-keyword">if</span> (s1 == s3) &#123;       <span class="hljs-comment">// false</span><br>    cout &lt;&lt; <span class="hljs-string">&quot;不会执行&quot;</span> &lt;&lt; endl;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="五-字符串容量和内存"><a href="#五-字符串容量和内存" class="headerlink" title="五-字符串容量和内存"></a><a class="markdownIt-Anchor" href="#五-字符串容量和内存"></a> 五、字符串容量和内存</h2>
<p>5.1 容量管理</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs cpp">string str;<br><br><span class="hljs-comment">// 1. size() / length() - 当前字符数</span><br>str = <span class="hljs-string">&quot;Hello&quot;</span>;<br>cout &lt;&lt; str.<span class="hljs-built_in">size</span>() &lt;&lt; endl;     <span class="hljs-comment">// 5</span><br>cout &lt;&lt; str.<span class="hljs-built_in">length</span>() &lt;&lt; endl;   <span class="hljs-comment">// 5</span><br><br><span class="hljs-comment">// 2. capacity() - 分配的内存容量</span><br>cout &lt;&lt; str.<span class="hljs-built_in">capacity</span>() &lt;&lt; endl; <span class="hljs-comment">// 可能是15（不同编译器不同）</span><br><br><span class="hljs-comment">// 3. reserve() - 预分配内存</span><br>str.<span class="hljs-built_in">reserve</span>(<span class="hljs-number">100</span>);               <span class="hljs-comment">// 提前分配100字符空间</span><br><span class="hljs-comment">// 避免多次重新分配，提高性能</span><br><br><span class="hljs-comment">// 4. shrink_to_fit() - 释放多余内存</span><br>str.<span class="hljs-built_in">shrink_to_fit</span>();            <span class="hljs-comment">// C++11，减少内存使用</span><br><br><span class="hljs-comment">// 5. empty() - 是否为空</span><br><span class="hljs-keyword">if</span> (str.<span class="hljs-built_in">empty</span>()) &#123;<br>    cout &lt;&lt; <span class="hljs-string">&quot;字符串为空&quot;</span> &lt;&lt; endl;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="六-string-与数值转换"><a href="#六-string-与数值转换" class="headerlink" title="六-string-与数值转换"></a><a class="markdownIt-Anchor" href="#六-string-与数值转换"></a> 六、string 与数值转换</h2>
<p>6.1 C++11 数值转换</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 1. string → 数值</span><br>string s1 = <span class="hljs-string">&quot;123&quot;</span>;<br>string s2 = <span class="hljs-string">&quot;3.14&quot;</span>;<br>string s3 = <span class="hljs-string">&quot;100&quot;</span>;<br><br><span class="hljs-type">int</span> i = std::<span class="hljs-built_in">stoi</span>(s1);          <span class="hljs-comment">// 123</span><br><span class="hljs-type">double</span> d = std::<span class="hljs-built_in">stod</span>(s2);       <span class="hljs-comment">// 3.14</span><br><span class="hljs-type">long</span> l = std::<span class="hljs-built_in">stol</span>(s3);         <span class="hljs-comment">// 100</span><br><span class="hljs-type">size_t</span> pos;<br><span class="hljs-type">int</span> i2 = std::<span class="hljs-built_in">stoi</span>(<span class="hljs-string">&quot;42abc&quot;</span>, &amp;pos);  <span class="hljs-comment">// i2=42, pos=2</span><br><br><span class="hljs-comment">// 2. 数值 → string</span><br>string s4 = std::<span class="hljs-built_in">to_string</span>(<span class="hljs-number">123</span>);        <span class="hljs-comment">// &quot;123&quot;</span><br>string s5 = std::<span class="hljs-built_in">to_string</span>(<span class="hljs-number">3.14159</span>);    <span class="hljs-comment">// &quot;3.141590&quot;</span><br>string s6 = std::<span class="hljs-built_in">to_string</span>(<span class="hljs-literal">true</span>);       <span class="hljs-comment">// &quot;1&quot;</span><br><br><span class="hljs-comment">// 3. 格式化（C++20有format，之前用stringstream）</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sstream&gt;</span></span><br>std::stringstream ss;<br>ss &lt;&lt; <span class="hljs-string">&quot;数值: &quot;</span> &lt;&lt; <span class="hljs-number">42</span> &lt;&lt; <span class="hljs-string">&quot;, 浮点数: &quot;</span> &lt;&lt; <span class="hljs-number">3.14</span>;<br>string result = ss.<span class="hljs-built_in">str</span>();<br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="七-实用函数和算法"><a href="#七-实用函数和算法" class="headerlink" title="七-实用函数和算法"></a><a class="markdownIt-Anchor" href="#七-实用函数和算法"></a> 七、实用函数和算法</h2>
<p>7.1 大小写转换</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs cpp">string str = <span class="hljs-string">&quot;Hello World&quot;</span>;<br><br><span class="hljs-comment">// 1. 转小写</span><br>std::<span class="hljs-built_in">transform</span>(str.<span class="hljs-built_in">begin</span>(), str.<span class="hljs-built_in">end</span>(), str.<span class="hljs-built_in">begin</span>(),<br>              [](<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> c)&#123; <span class="hljs-keyword">return</span> std::<span class="hljs-built_in">tolower</span>(c); &#125;);<br><span class="hljs-comment">// &quot;hello world&quot;</span><br><br><span class="hljs-comment">// 2. 转大写</span><br>std::<span class="hljs-built_in">transform</span>(str.<span class="hljs-built_in">begin</span>(), str.<span class="hljs-built_in">end</span>(), str.<span class="hljs-built_in">begin</span>(),<br>              [](<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> c)&#123; <span class="hljs-keyword">return</span> std::<span class="hljs-built_in">toupper</span>(c); &#125;);<br><span class="hljs-comment">// &quot;HELLO WORLD&quot;</span><br><br><span class="hljs-comment">// 3. C++23 有专门的函数</span><br><span class="hljs-comment">// std::string s = std::to_upper(&quot;hello&quot;);</span><br></code></pre></td></tr></table></figure>
<p>​<br />
7.2 字符串分割</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// C++没有内置split，需要自己实现</span><br><span class="hljs-function">vector&lt;string&gt; <span class="hljs-title">split</span><span class="hljs-params">(<span class="hljs-type">const</span> string&amp; str, <span class="hljs-type">char</span> delimiter)</span> </span>&#123;<br>    vector&lt;string&gt; tokens;<br>    <span class="hljs-type">size_t</span> start = <span class="hljs-number">0</span>, end = <span class="hljs-number">0</span>;<br><br>    <span class="hljs-keyword">while</span> ((end = str.<span class="hljs-built_in">find</span>(delimiter, start)) != string::npos) &#123;<br>        tokens.<span class="hljs-built_in">push_back</span>(str.<span class="hljs-built_in">substr</span>(start, end - start));<br>        start = end + <span class="hljs-number">1</span>;<br>    &#125;<br>    tokens.<span class="hljs-built_in">push_back</span>(str.<span class="hljs-built_in">substr</span>(start));<br>    <span class="hljs-keyword">return</span> tokens;<br>&#125;<br><br><span class="hljs-comment">// 使用</span><br>string text = <span class="hljs-string">&quot;apple,banana,orange&quot;</span>;<br>vector&lt;string&gt; fruits = <span class="hljs-built_in">split</span>(text, <span class="hljs-string">&#x27;,&#x27;</span>);<br><span class="hljs-comment">// fruits = &#123;&quot;apple&quot;, &quot;banana&quot;, &quot;orange&quot;&#125;</span><br></code></pre></td></tr></table></figure>
<p>​<br />
7.3 去除空白字符</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function">string <span class="hljs-title">trim</span><span class="hljs-params">(<span class="hljs-type">const</span> string&amp; str)</span> </span>&#123;<br>    <span class="hljs-comment">// 去除左边空白</span><br>    <span class="hljs-type">size_t</span> start = str.<span class="hljs-built_in">find_first_not_of</span>(<span class="hljs-string">&quot; \\t\\n\\r&quot;</span>);<br>    <span class="hljs-keyword">if</span> (start == string::npos) <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;<br><br>    <span class="hljs-comment">// 去除右边空白</span><br>    <span class="hljs-type">size_t</span> end = str.<span class="hljs-built_in">find_last_not_of</span>(<span class="hljs-string">&quot; \\t\\n\\r&quot;</span>);<br><br>    <span class="hljs-keyword">return</span> str.<span class="hljs-built_in">substr</span>(start, end - start + <span class="hljs-number">1</span>);<br>&#125;<br><br>string text = <span class="hljs-string">&quot;   Hello World   &quot;</span>;<br>string trimmed = <span class="hljs-built_in">trim</span>(text);  <span class="hljs-comment">// &quot;Hello World&quot;</span><br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="八-string-与流"><a href="#八-string-与流" class="headerlink" title="八-string-与流"></a><a class="markdownIt-Anchor" href="#八-string-与流"></a> 八、string 与流</h2>
<p>8.1 stringstream</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sstream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string&gt;</span></span><br><br><span class="hljs-comment">// 1. 字符串拼接（替代 sprintf）</span><br>std::stringstream ss;<br>ss &lt;&lt; <span class="hljs-string">&quot;姓名: &quot;</span> &lt;&lt; <span class="hljs-string">&quot;张三&quot;</span> &lt;&lt; <span class="hljs-string">&quot;, 年龄: &quot;</span> &lt;&lt; <span class="hljs-number">25</span>;<br>string info = ss.<span class="hljs-built_in">str</span>();  <span class="hljs-comment">// &quot;姓名: 张三, 年龄: 25&quot;</span><br><br><span class="hljs-comment">// 2. 解析字符串</span><br>string data = <span class="hljs-string">&quot;100 3.14 hello&quot;</span>;<br><span class="hljs-function">std::stringstream <span class="hljs-title">parser</span><span class="hljs-params">(data)</span></span>;<br><span class="hljs-type">int</span> n;<br><span class="hljs-type">double</span> d;<br>string s;<br>parser &gt;&gt; n &gt;&gt; d &gt;&gt; s;  <span class="hljs-comment">// n=100, d=3.14, s=&quot;hello&quot;</span><br><br><span class="hljs-comment">// 3. 类型转换</span><br>string strNum = <span class="hljs-string">&quot;123&quot;</span>;<br><span class="hljs-type">int</span> num;<br><span class="hljs-function">std::stringstream <span class="hljs-title">converter</span><span class="hljs-params">(strNum)</span></span>;<br>converter &gt;&gt; num;  <span class="hljs-comment">// num = 123</span><br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="九-性能优化技巧"><a href="#九-性能优化技巧" class="headerlink" title="九-性能优化技巧"></a><a class="markdownIt-Anchor" href="#九-性能优化技巧"></a> 九、性能优化技巧</h2>
<p>9.1 避免不必要的复制</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// ❌ 不好：多次复制</span><br><span class="hljs-function">string <span class="hljs-title">process</span><span class="hljs-params">(string str)</span> </span>&#123;  <span class="hljs-comment">// 值传递，复制一次</span><br>    str += <span class="hljs-string">&quot; processed&quot;</span>;       <span class="hljs-comment">// 修改副本</span><br>    <span class="hljs-keyword">return</span> str;                <span class="hljs-comment">// 返回时可能再复制</span><br>&#125;<br><br><span class="hljs-comment">// ✅ 好：使用引用</span><br><span class="hljs-function">string <span class="hljs-title">process</span><span class="hljs-params">(<span class="hljs-type">const</span> string&amp; str)</span> </span>&#123;  <span class="hljs-comment">// 引用，不复制</span><br>    string result = str;             <span class="hljs-comment">// 只在必要时复制</span><br>    result += <span class="hljs-string">&quot; processed&quot;</span>;<br>    <span class="hljs-keyword">return</span> result;<br>&#125;<br><br><span class="hljs-comment">// ✅ 更好：移动语义（C++11）</span><br><span class="hljs-function">string <span class="hljs-title">process</span><span class="hljs-params">(string&amp;&amp; str)</span> </span>&#123;       <span class="hljs-comment">// 右值引用</span><br>    str += <span class="hljs-string">&quot; processed&quot;</span>;<br>    <span class="hljs-keyword">return</span> std::<span class="hljs-built_in">move</span>(str);           <span class="hljs-comment">// 移动，不复制</span><br>&#125;<br><br>​<br><span class="hljs-number">9.2</span> 预分配内存<br><span class="hljs-comment">// 情景：拼接多个字符串</span><br>string result;<br>result.<span class="hljs-built_in">reserve</span>(<span class="hljs-number">1000</span>);  <span class="hljs-comment">// 预分配足够空间</span><br><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) &#123;<br>    result += <span class="hljs-string">&quot;string&quot;</span> + std::<span class="hljs-built_in">to_string</span>(i) + <span class="hljs-string">&quot;, &quot;</span>;<br>&#125;<br><span class="hljs-comment">// 避免了多次重新分配内存！</span><br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="十-常见陷阱"><a href="#十-常见陷阱" class="headerlink" title="十-常见陷阱"></a><a class="markdownIt-Anchor" href="#十-常见陷阱"></a> 十、常见陷阱</h2>
<p>10.1 string 的生命周期</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 危险：返回局部string的c_str()</span><br><span class="hljs-function"><span class="hljs-type">const</span> <span class="hljs-type">char</span>* <span class="hljs-title">badFunction</span><span class="hljs-params">()</span> </span>&#123;<br>    string local = <span class="hljs-string">&quot;Hello&quot;</span>;<br>    <span class="hljs-keyword">return</span> local.<span class="hljs-built_in">c_str</span>();  <span class="hljs-comment">// ❌ local销毁后指针无效！</span><br>&#125;<br><br><span class="hljs-comment">// 正确：返回string对象</span><br><span class="hljs-function">string <span class="hljs-title">goodFunction</span><span class="hljs-params">()</span> </span>&#123;<br>    string local = <span class="hljs-string">&quot;Hello&quot;</span>;<br>    <span class="hljs-keyword">return</span> local;  <span class="hljs-comment">// ✅ 返回值优化或移动</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>​<br />
10.2 中文字符处理</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs cpp">string chinese = <span class="hljs-string">&quot;你好世界&quot;</span>;  <span class="hljs-comment">// UTF-8编码</span><br><br><span class="hljs-comment">// ❌ 错误：下标访问得到的是字节，不是字符</span><br>cout &lt;&lt; chinese[<span class="hljs-number">0</span>] &lt;&lt; endl;  <span class="hljs-comment">// 乱码！</span><br><br><span class="hljs-comment">// ✅ 正确：需要特殊处理（C++20有更好支持）</span><br><span class="hljs-comment">// 当前需要第三方库如ICU，或自己处理UTF-8</span><br><br><span class="hljs-comment">// 获取字符数（不是字节数）</span><br><span class="hljs-type">size_t</span> charCount = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">char</span> c : chinese) &#123;<br>    <span class="hljs-keyword">if</span> ((c &amp; <span class="hljs-number">0xC0</span>) != <span class="hljs-number">0x80</span>) charCount++;<br>&#125;<br>cout &lt;&lt; <span class="hljs-string">&quot;字符数: &quot;</span> &lt;&lt; charCount &lt;&lt; endl;  <span class="hljs-comment">// </span><br></code></pre></td></tr></table></figure>
<h1 id="函数重载"><a href="#函数重载" class="headerlink" title="函数重载"></a><a class="markdownIt-Anchor" href="#函数重载"></a> 函数重载</h1>
<hr />
<h2 id="一-什么是函数重载"><a href="#一-什么是函数重载" class="headerlink" title="一-什么是函数重载"></a><a class="markdownIt-Anchor" href="#一-什么是函数重载"></a> 一、什么是函数重载？</h2>
<p>在同一个作用域内，定义多个同名函数，但参数列表不同。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 三个同名函数，构成重载</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">print</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span>;        <span class="hljs-comment">// 1</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">print</span><span class="hljs-params">(<span class="hljs-type">double</span> x)</span></span>;     <span class="hljs-comment">// 2</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">print</span><span class="hljs-params">(string x)</span></span>;     <span class="hljs-comment">// 3</span><br><br></code></pre></td></tr></table></figure>
<hr />
<h2 id="二-重载的判定规则"><a href="#二-重载的判定规则" class="headerlink" title="二-重载的判定规则"></a><a class="markdownIt-Anchor" href="#二-重载的判定规则"></a> 二、重载的判定规则</h2>
<p>编译器根据「参数列表」区分，不看返回值！</p>
<p>✅ 可以重载（参数不同）</p>
<p>差异类型 示例<br />
参数个数不同 void f(int) vs void f(int, int)<br />
参数类型不同 void f(int) vs void f(double)<br />
参数顺序不同 void f(int, double) vs void f(double, int)</p>
<p>❌ 不可以重载（编译器无法区分）</p>
<p>错误示例 原因<br />
void f(int)  vs int f(int)        仅返回值不同<br />
void f(int)  vs void f(const int) 顶层const被忽略<br />
void f(int*) vs void f(int[])     数组退化为指针</p>
<hr />
<h2 id="三-重载-vs-默认参数"><a href="#三-重载-vs-默认参数" class="headerlink" title="三-重载-vs-默认参数"></a><a class="markdownIt-Anchor" href="#三-重载-vs-默认参数"></a> 三、重载 vs 默认参数</h2>
<p>特性 函数重载 默认参数<br />
本质 多个不同函数 同一个函数<br />
内存 多份代码 一份代码<br />
调用 编译器静态匹配 编译器补全参数<br />
灵活性 可做完全不同的事 只能省略尾部参数</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 重载：两个独立函数</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">log</span><span class="hljs-params">(string msg)</span></span>;        <span class="hljs-comment">// 只记消息</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">log</span><span class="hljs-params">(string msg, <span class="hljs-type">int</span> level)</span></span>; <span class="hljs-comment">// 记消息+级别</span><br><br><span class="hljs-comment">// 默认参数：一个函数</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">log</span><span class="hljs-params">(string msg, <span class="hljs-type">int</span> level = <span class="hljs-number">0</span>)</span></span>;  <span class="hljs-comment">// level可省略</span><br><br></code></pre></td></tr></table></figure>
<hr />
<h2 id="四-重载的匹配过程"><a href="#四-重载的匹配过程" class="headerlink" title="四-重载的匹配过程"></a><a class="markdownIt-Anchor" href="#四-重载的匹配过程"></a> 四、重载的匹配过程</h2>
<p>编译器按优先级找最佳匹配：</p>
<ol>
<li>精确匹配（类型完全相同）</li>
<li>提升匹配（char→int, float→double）</li>
<li>转换匹配（int→double, double→int）</li>
<li>用户定义转换</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">f</span><span class="hljs-params">(<span class="hljs-type">int</span>)</span></span>;    <span class="hljs-comment">// 1</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">f</span><span class="hljs-params">(<span class="hljs-type">double</span>)</span></span>; <span class="hljs-comment">// 2</span><br><br><span class="hljs-built_in">f</span>(<span class="hljs-string">&#x27;a&#x27;</span>);  <span class="hljs-comment">// char→int 精确提升，调用1</span><br><span class="hljs-built_in">f</span>(<span class="hljs-number">3.14f</span>); <span class="hljs-comment">// float→double 提升，调用2</span><br><br></code></pre></td></tr></table></figure>
<hr />
<h2 id="五-常见用途"><a href="#五-常见用途" class="headerlink" title="五-常见用途"></a><a class="markdownIt-Anchor" href="#五-常见用途"></a> 五、常见用途</h2>
<ol>
<li>提供不同调用方式</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 快排：排整个数组 vs 排指定范围</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">quickSort</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; arr)</span></span>;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">quickSort</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; arr, <span class="hljs-type">int</span> low, <span class="hljs-type">int</span> high)</span></span>;<br><br></code></pre></td></tr></table></figure>
<ol start="2">
<li>处理不同类型</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">show</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span>;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">show</span><span class="hljs-params">(<span class="hljs-type">double</span> x)</span></span>;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">show</span><span class="hljs-params">(string x)</span></span>;<br><br></code></pre></td></tr></table></figure>
<ol start="3">
<li>可选参数组合</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">connect</span><span class="hljs-params">(string host)</span></span>;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">connect</span><span class="hljs-params">(string host, <span class="hljs-type">int</span> port)</span></span>;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">connect</span><span class="hljs-params">(string host, <span class="hljs-type">int</span> port, <span class="hljs-type">bool</span> ssl)</span></span>;<br><br></code></pre></td></tr></table></figure>
<hr />
<h2 id="六-常见陷阱"><a href="#六-常见陷阱" class="headerlink" title="六-常见陷阱"></a><a class="markdownIt-Anchor" href="#六-常见陷阱"></a> 六、常见陷阱</h2>
<p>陷阱1：形参名不重要，类型才重要</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">f</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span></span>;  <span class="hljs-comment">// 这两个</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">f</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span></span>;  <span class="hljs-comment">// 是同一个函数 ❌ 不是重载</span><br><br></code></pre></td></tr></table></figure>
<p>陷阱2：const位置影响重载</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">f</span><span class="hljs-params">(<span class="hljs-type">int</span>* p)</span></span>;        <span class="hljs-comment">// 1</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">f</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">int</span>* p)</span></span>;  <span class="hljs-comment">// 2 ✅ 指向const，不同</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">f</span><span class="hljs-params">(<span class="hljs-type">int</span>* <span class="hljs-type">const</span> p)</span></span>;  <span class="hljs-comment">// 与1相同 ❌ 指针自身const</span><br><br></code></pre></td></tr></table></figure>
<p>陷阱3：引用与值</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">f</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span>;    <span class="hljs-comment">// 1</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">f</span><span class="hljs-params">(<span class="hljs-type">int</span>&amp; x)</span></span>;   <span class="hljs-comment">// 2 ✅ 重载</span><br><span class="hljs-comment">// 调用时 f(a) 会歧义！需要明确 f(&amp;a) 或 f(a) ？</span><br><br></code></pre></td></tr></table></figure>
<hr />
<h2 id="七-形象理解"><a href="#七-形象理解" class="headerlink" title="七-形象理解"></a><a class="markdownIt-Anchor" href="#七-形象理解"></a> 七、形象理解</h2>
<p>重载就像「多义词」：</p>
<p>· “打”字 → 打人、打饭、打电话、打毛衣<br />
· 同一个词，不同对象，不同动作</p>
<p>编译器就像聪明的读者，根据上下文（参数）自动理解你要表达哪个意思。</p>
<h1 id="const"><a href="#const" class="headerlink" title="const"></a><a class="markdownIt-Anchor" href="#const"></a> const</h1>
<h2 id="一-const-基础创建常量"><a href="#一-const-基础创建常量" class="headerlink" title="一-const-基础创建常量"></a><a class="markdownIt-Anchor" href="#一-const-基础创建常量"></a> 一、const 基础：创建常量</h2>
<p>1.1 基本用法</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 1. 创建常量</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> MAX_SIZE = <span class="hljs-number">100</span>;    <span class="hljs-comment">// int常量</span><br><span class="hljs-type">const</span> <span class="hljs-type">double</span> PI = <span class="hljs-number">3.14159</span>;   <span class="hljs-comment">// double常量</span><br><span class="hljs-type">const</span> <span class="hljs-type">char</span> NEWLINE = <span class="hljs-string">&#x27;\\n&#x27;</span>;   <span class="hljs-comment">// char常量</span><br><br><span class="hljs-comment">// 2. 必须初始化</span><br><span class="hljs-comment">// const int x;  // ❌ 错误！必须初始化</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> y = <span class="hljs-number">42</span>;  <span class="hljs-comment">// ✅ 正确</span><br><br><span class="hljs-comment">// 3. 不可修改</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> age = <span class="hljs-number">25</span>;<br><span class="hljs-comment">// age = 30;  // ❌ 错误！不能修改常量</span><br></code></pre></td></tr></table></figure>
<p>​<br />
1.2 const vs #define（重要区别）</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// ❌ C语言的宏（不要用！）</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAX_USERS 100        <span class="hljs-comment">// 没有类型，只是文本替换</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> PI 3.14159</span><br><br><span class="hljs-comment">// ✅ C++的const（推荐用！）</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> MAX_USERS = <span class="hljs-number">100</span>;   <span class="hljs-comment">// 有类型，类型安全</span><br><span class="hljs-type">const</span> <span class="hljs-type">double</span> PI = <span class="hljs-number">3.14159</span>;   <span class="hljs-comment">// 有作用域，可调试</span><br><br><span class="hljs-comment">// 宏的问题：</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> SQUARE(x) x * x</span><br><span class="hljs-type">int</span> result = <span class="hljs-built_in">SQUARE</span>(<span class="hljs-number">2</span> + <span class="hljs-number">3</span>);  <span class="hljs-comment">// 变成 2 + 3 * 2 + 3 = 11（错误！）</span><br><span class="hljs-comment">// const函数没有这个问题</span><br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="二-const-与指针重要"><a href="#二-const-与指针重要" class="headerlink" title="二-const-与指针重要"></a><a class="markdownIt-Anchor" href="#二-const-与指针重要"></a> 二、const 与指针（重要！）</h2>
<p>2.1 四种组合（必须掌握）</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">int</span> value = <span class="hljs-number">10</span>;<br><span class="hljs-type">int</span> other = <span class="hljs-number">20</span>;<br><br><span class="hljs-comment">// 1. 指向常量的指针（指针指向的内容不能改）</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span>* ptr1 = &amp;value;  <span class="hljs-comment">// 读作：ptr1指向const int</span><br><span class="hljs-comment">// *ptr1 = 100;            // ❌ 错误！不能通过ptr1修改value</span><br>ptr1 = &amp;other;             <span class="hljs-comment">// ✅ 正确！指针本身可以指向别处</span><br><br><span class="hljs-comment">// 2. 常量指针（指针本身不能指向别处）</span><br><span class="hljs-type">int</span>* <span class="hljs-type">const</span> ptr2 = &amp;value;  <span class="hljs-comment">// 读作：const指针指向int</span><br>*ptr2 = <span class="hljs-number">100</span>;               <span class="hljs-comment">// ✅ 正确！可以修改指向的值</span><br><span class="hljs-comment">// ptr2 = &amp;other;          // ❌ 错误！指针不能指向别处</span><br><br><span class="hljs-comment">// 3. 指向常量的常量指针（都不能改）</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span>* <span class="hljs-type">const</span> ptr3 = &amp;value;<br><span class="hljs-comment">// *ptr3 = 100;            // ❌ 错误！</span><br><span class="hljs-comment">// ptr3 = &amp;other;          // ❌ 错误！</span><br><br><span class="hljs-comment">// 4. 非常量指针（都能改）</span><br><span class="hljs-type">int</span>* ptr4 = &amp;value;<br>*ptr4 = <span class="hljs-number">100</span>;               <span class="hljs-comment">// ✅ 正确！</span><br>ptr4 = &amp;other;             <span class="hljs-comment">// ✅ 正确！</span><br></code></pre></td></tr></table></figure>
<p>​<br />
2.2 记忆技巧：从右向左读</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">const</span> <span class="hljs-type">int</span>* p1;       <span class="hljs-comment">// 读：p1是指针，指向const int（内容不能改）</span><br><span class="hljs-type">int</span> <span class="hljs-type">const</span>* p2;       <span class="hljs-comment">// 同上！const int* 和 int const* 等价</span><br><span class="hljs-type">int</span>* <span class="hljs-type">const</span> p3;       <span class="hljs-comment">// 读：p3是const指针，指向int（指针不能改）</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span>* <span class="hljs-type">const</span> p4; <span class="hljs-comment">// 读：p4是const指针，指向const int（都不能改）</span><br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="三-const-与函数参数"><a href="#三-const-与函数参数" class="headerlink" title="三-const-与函数参数"></a><a class="markdownIt-Anchor" href="#三-const-与函数参数"></a> 三、const 与函数参数</h2>
<p>3.1 保护传入的参数</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 场景1：值传递 + const（通常不需要）</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">func1</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">int</span> x)</span> </span>&#123;  <span class="hljs-comment">// const在这里意义不大</span><br>    <span class="hljs-comment">// x = 10;  // ❌ 不能修改（但x本来就是副本）</span><br>&#125;<br><br><span class="hljs-comment">// 场景2：指针参数 + const（重要！）</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">printData</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">int</span>* data, <span class="hljs-type">int</span> size)</span> </span>&#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; size; i++) &#123;<br>        <span class="hljs-comment">// data[i] = 0;  // ❌ 不能修改原始数据</span><br>        cout &lt;&lt; data[i] &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 场景3：引用参数 + const（最重要！最常用！）</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">processString</span><span class="hljs-params">(<span class="hljs-type">const</span> string&amp; str)</span> </span>&#123;<br>    <span class="hljs-comment">// str.append(&quot;!&quot;);  // ❌ 不能修改</span><br>    cout &lt;&lt; str.<span class="hljs-built_in">length</span>() &lt;&lt; endl;  <span class="hljs-comment">// ✅ 可以读取</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-type">int</span> arr[] = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>&#125;;<br>    string name = <span class="hljs-string">&quot;张三&quot;</span>;<br><br>    <span class="hljs-built_in">printData</span>(arr, <span class="hljs-number">5</span>);       <span class="hljs-comment">// 保证我不会修改你的数组</span><br>    <span class="hljs-built_in">processString</span>(name);     <span class="hljs-comment">// 保证我不会修改你的字符串</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>​<br />
3.2 const引用避免拷贝（性能优化）</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// ❌ 不好：拷贝整个大对象</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">printObject</span><span class="hljs-params">(MyClass obj)</span> </span>&#123;  <span class="hljs-comment">// 调用拷贝构造函数</span><br>    obj.<span class="hljs-built_in">display</span>();<br>&#125;<br><br><span class="hljs-comment">// ✅ 好：const引用，没有拷贝</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">printObject</span><span class="hljs-params">(<span class="hljs-type">const</span> MyClass&amp; obj)</span> </span>&#123;  <span class="hljs-comment">// 不拷贝，不修改</span><br>    obj.<span class="hljs-built_in">display</span>();<br>&#125;<br><br><span class="hljs-comment">// 特别重要：string、vector等大对象一定要用const引用！</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">processBigData</span><span class="hljs-params">(<span class="hljs-type">const</span> vector&lt;<span class="hljs-type">int</span>&gt;&amp; data)</span> </span>&#123;<br>    <span class="hljs-comment">// 处理但不修改</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="四-const-成员函数类的核心特性"><a href="#四-const-成员函数类的核心特性" class="headerlink" title="四-const-成员函数类的核心特性"></a><a class="markdownIt-Anchor" href="#四-const-成员函数类的核心特性"></a> 四、const 成员函数（类的核心特性）</h2>
<p>4.1 基本概念</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">BankAccount</span> &#123;<br><span class="hljs-keyword">private</span>:<br>    <span class="hljs-type">double</span> balance;<br>    <span class="hljs-keyword">mutable</span> <span class="hljs-type">int</span> accessCount;  <span class="hljs-comment">// 特殊：可以在const函数中修改</span><br><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">BankAccount</span>(<span class="hljs-type">double</span> b) : <span class="hljs-built_in">balance</span>(b), <span class="hljs-built_in">accessCount</span>(<span class="hljs-number">0</span>) &#123;&#125;<br><br>    <span class="hljs-comment">// const成员函数：承诺不修改对象状态</span><br>    <span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">getBalance</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>&#123;<br>        accessCount++;        <span class="hljs-comment">// ✅ mutable成员可以修改</span><br>        <span class="hljs-keyword">return</span> balance;       <span class="hljs-comment">// ✅ 可以读取成员</span><br>        <span class="hljs-comment">// balance = 1000;    // ❌ 不能修改非mutable成员</span><br>    &#125;<br><br>    <span class="hljs-comment">// 非const成员函数：可以修改对象</span><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">deposit</span><span class="hljs-params">(<span class="hljs-type">double</span> amount)</span> </span>&#123;<br>        balance += amount;    <span class="hljs-comment">// ✅ 可以修改</span><br>    &#125;<br><br>    <span class="hljs-comment">// const对象只能调用const函数</span><br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-function">BankAccount <span class="hljs-title">acc1</span><span class="hljs-params">(<span class="hljs-number">1000</span>)</span></span>;      <span class="hljs-comment">// 非const对象</span><br>    <span class="hljs-function"><span class="hljs-type">const</span> BankAccount <span class="hljs-title">acc2</span><span class="hljs-params">(<span class="hljs-number">2000</span>)</span></span>; <span class="hljs-comment">// const对象</span><br><br>    acc<span class="hljs-number">1.</span><span class="hljs-built_in">getBalance</span>();    <span class="hljs-comment">// ✅ 可以</span><br>    acc<span class="hljs-number">1.</span><span class="hljs-built_in">deposit</span>(<span class="hljs-number">100</span>);    <span class="hljs-comment">// ✅ 可以</span><br><br>    acc<span class="hljs-number">2.</span><span class="hljs-built_in">getBalance</span>();    <span class="hljs-comment">// ✅ 可以（getBalance是const）</span><br>    <span class="hljs-comment">// acc2.deposit(100); // ❌ 错误！const对象不能调用非const函数</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>​<br />
4.2 const重载</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Array</span> &#123;<br><span class="hljs-keyword">private</span>:<br>    <span class="hljs-type">int</span>* data;<br>    <span class="hljs-type">int</span> size;<br><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-comment">// 非const版本：可以修改元素</span><br>    <span class="hljs-type">int</span>&amp; <span class="hljs-keyword">operator</span>[](<span class="hljs-type">int</span> index) &#123;<br>        <span class="hljs-keyword">return</span> data[index];  <span class="hljs-comment">// 返回引用，可以修改</span><br>    &#125;<br><br>    <span class="hljs-comment">// const版本：只读访问</span><br>    <span class="hljs-type">const</span> <span class="hljs-type">int</span>&amp; <span class="hljs-keyword">operator</span>[](<span class="hljs-type">int</span> index) <span class="hljs-type">const</span> &#123;<br>        <span class="hljs-keyword">return</span> data[index];  <span class="hljs-comment">// 返回const引用，不能修改</span><br>    &#125;<br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    Array arr1;               <span class="hljs-comment">// 非const对象</span><br>    <span class="hljs-type">const</span> Array arr2;         <span class="hljs-comment">// const对象</span><br><br>    arr1[<span class="hljs-number">0</span>] = <span class="hljs-number">100</span>;            <span class="hljs-comment">// ✅ 调用非const版本，可以修改</span><br>    <span class="hljs-type">int</span> x = arr2[<span class="hljs-number">0</span>];          <span class="hljs-comment">// ✅ 调用const版本，只能读取</span><br>    <span class="hljs-comment">// arr2[0] = 200;         // ❌ 错误！</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="五-const-与返回值"><a href="#五-const-与返回值" class="headerlink" title="五-const-与返回值"></a><a class="markdownIt-Anchor" href="#五-const-与返回值"></a> 五、const 与返回值</h2>
<p>5.1 返回const值</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Point</span> &#123;<br><span class="hljs-keyword">private</span>:<br>    <span class="hljs-type">int</span> x, y;<br><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">Point</span>(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y) : <span class="hljs-built_in">x</span>(x), <span class="hljs-built_in">y</span>(y) &#123;&#125;<br><br>    <span class="hljs-comment">// 返回const引用，防止修改成员</span><br>    <span class="hljs-function"><span class="hljs-type">const</span> <span class="hljs-type">int</span>&amp; <span class="hljs-title">getX</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>&#123; <span class="hljs-keyword">return</span> x; &#125;<br>    <span class="hljs-function"><span class="hljs-type">const</span> <span class="hljs-type">int</span>&amp; <span class="hljs-title">getY</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>&#123; <span class="hljs-keyword">return</span> y; &#125;<br><br>    <span class="hljs-comment">// 不好的设计：返回非const引用</span><br>    <span class="hljs-function"><span class="hljs-type">int</span>&amp; <span class="hljs-title">badGetX</span><span class="hljs-params">()</span> </span>&#123; <span class="hljs-keyword">return</span> x; &#125;  <span class="hljs-comment">// 危险！外部可以修改x</span><br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-function">Point <span class="hljs-title">p</span><span class="hljs-params">(<span class="hljs-number">10</span>, <span class="hljs-number">20</span>)</span></span>;<br><br>    <span class="hljs-comment">// 好的设计：不能通过返回值修改</span><br>    <span class="hljs-type">const</span> <span class="hljs-type">int</span>&amp; x = p.<span class="hljs-built_in">getX</span>();<br>    <span class="hljs-comment">// x = 100;  // ❌ 错误！</span><br><br>    <span class="hljs-comment">// 不好的设计：可以修改私有成员！</span><br>    <span class="hljs-type">int</span>&amp; badX = p.<span class="hljs-built_in">badGetX</span>();<br>    badX = <span class="hljs-number">999</span>;  <span class="hljs-comment">// ✅ 编译通过，但破坏了封装！</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>​<br />
5.2 返回const指针/引用</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Database</span> &#123;<br><span class="hljs-keyword">private</span>:<br>    <span class="hljs-type">static</span> Database* instance;<br><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-comment">// 返回const指针，防止调用者修改单例</span><br>    <span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">const</span> Database* <span class="hljs-title">getInstance</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> instance;<br>    &#125;<br>&#125;;<br><br><span class="hljs-comment">// 使用：只能读取，不能修改</span><br><span class="hljs-type">const</span> Database* db = Database::<span class="hljs-built_in">getInstance</span>();<br><span class="hljs-comment">// db-&gt;clear();  // ❌ 如果clear()不是const函数，就不能调用</span><br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="六-constexprc11-编译时常量"><a href="#六-constexprc11-编译时常量" class="headerlink" title="六-constexprc11-编译时常量"></a><a class="markdownIt-Anchor" href="#六-constexprc11-编译时常量"></a> 六、constexpr（C++11 编译时常量）</h2>
<p>6.1 constexpr vs const</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// const：运行时常量（可能编译时不知道值）</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> size1 = <span class="hljs-built_in">getSize</span>();  <span class="hljs-comment">// 如果getSize()运行时才知道</span><br><br><span class="hljs-comment">// constexpr：必须是编译时常量</span><br><span class="hljs-keyword">constexpr</span> <span class="hljs-type">int</span> size2 = <span class="hljs-number">100</span>;    <span class="hljs-comment">// ✅ 编译时确定</span><br><span class="hljs-keyword">constexpr</span> <span class="hljs-type">int</span> size3 = size2 * <span class="hljs-number">2</span>;  <span class="hljs-comment">// ✅ 编译时计算</span><br><br><span class="hljs-comment">// constexpr函数：在编译时计算</span><br><span class="hljs-function"><span class="hljs-keyword">constexpr</span> <span class="hljs-type">int</span> <span class="hljs-title">square</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> x * x;<br>&#125;<br><br><span class="hljs-keyword">constexpr</span> <span class="hljs-type">int</span> val = <span class="hljs-built_in">square</span>(<span class="hljs-number">10</span>);  <span class="hljs-comment">// 编译时计算，val=100</span><br><br><span class="hljs-comment">// 数组大小必须用编译时常量</span><br><span class="hljs-type">int</span> arr1[<span class="hljs-number">100</span>];            <span class="hljs-comment">// ✅ 字面量</span><br><span class="hljs-type">int</span> arr2[size2];          <span class="hljs-comment">// ✅ constexpr</span><br><span class="hljs-comment">// int arr3[size1];       // ❌ 如果size1不是编译时常量</span><br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="七-mutable-关键字"><a href="#七-mutable-关键字" class="headerlink" title="七-mutable-关键字"></a><a class="markdownIt-Anchor" href="#七-mutable-关键字"></a> 七、mutable 关键字</h2>
<p>7.1 特殊场景：const函数中修改</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Cache</span> &#123;<br><span class="hljs-keyword">private</span>:<br>    <span class="hljs-keyword">mutable</span> <span class="hljs-type">bool</span> cacheValid;      <span class="hljs-comment">// 缓存是否有效</span><br>    <span class="hljs-keyword">mutable</span> string cachedValue;   <span class="hljs-comment">// 缓存的值</span><br>    string realValue;             <span class="hljs-comment">// 真实数据</span><br><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-comment">// const函数中需要修改mutable成员</span><br>    <span class="hljs-function"><span class="hljs-type">const</span> string&amp; <span class="hljs-title">getValue</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (!cacheValid) &#123;<br>            <span class="hljs-comment">// 虽然是const函数，但可以修改mutable成员</span><br>            cachedValue = realValue;  <span class="hljs-comment">// 假设这里计算</span><br>            cacheValid = <span class="hljs-literal">true</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> cachedValue;<br>    &#125;<br>&#125;;<br><br><span class="hljs-comment">// 使用场景：缓存、访问计数、调试信息等</span><br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="八-实际应用指南"><a href="#八-实际应用指南" class="headerlink" title="八-实际应用指南"></a><a class="markdownIt-Anchor" href="#八-实际应用指南"></a> 八、实际应用指南</h2>
<p>8.1 什么时候用const？</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs cpp">✅ 应该用<span class="hljs-type">const</span>的场景：<br><span class="hljs-number">1.</span> 函数参数（除非需要修改）<br>   <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">func</span><span class="hljs-params">(<span class="hljs-type">const</span> string&amp; str)</span>  <span class="hljs-comment">// ✅</span></span><br><span class="hljs-function"></span><br><span class="hljs-function">2. 成员函数（除非需要修改对象）</span><br><span class="hljs-function">   <span class="hljs-type">int</span> <span class="hljs-title">getValue</span><span class="hljs-params">()</span> <span class="hljs-type">const</span>  <span class="hljs-comment">// ✅</span></span><br><span class="hljs-function"></span><br><span class="hljs-function">3. 局部常量</span><br><span class="hljs-function">   <span class="hljs-type">const</span> <span class="hljs-type">int</span> max </span>= <span class="hljs-number">100</span>;  <span class="hljs-comment">// ✅</span><br><br><span class="hljs-number">4.</span> 类成员（如果不应被修改）<br>   <span class="hljs-type">const</span> <span class="hljs-type">int</span> id;  <span class="hljs-comment">// ✅</span><br><br><span class="hljs-number">5.</span> 返回值（如果不希望调用者修改）<br>   <span class="hljs-function"><span class="hljs-type">const</span> vector&lt;<span class="hljs-type">int</span>&gt;&amp; <span class="hljs-title">getData</span><span class="hljs-params">()</span>  <span class="hljs-comment">// ✅</span></span><br></code></pre></td></tr></table></figure>
<p>​<br />
8.2 const的安全优势</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 示例：const如何防止错误</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> &#123;<br>    string name;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-comment">// 错误设计：返回非const引用</span><br>    <span class="hljs-function">string&amp; <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>&#123; <span class="hljs-keyword">return</span> name; &#125;<br><br>    <span class="hljs-comment">// 正确设计：返回const引用</span><br>    <span class="hljs-function"><span class="hljs-type">const</span> string&amp; <span class="hljs-title">getName</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>&#123; <span class="hljs-keyword">return</span> name; &#125;<br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">badCode</span><span class="hljs-params">(User&amp; user)</span> </span>&#123;<br>    string&amp; name = user.<span class="hljs-built_in">getName</span>();<br>    name = <span class="hljs-string">&quot;黑客修改&quot;</span>;  <span class="hljs-comment">// ❌ 直接修改了私有成员！</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">goodCode</span><span class="hljs-params">(<span class="hljs-type">const</span> User&amp; user)</span> </span>&#123;<br>    <span class="hljs-type">const</span> string&amp; name = user.<span class="hljs-built_in">getName</span>();<br>    <span class="hljs-comment">// name = &quot;尝试修改&quot;;  // ❌ 编译错误！const保护</span><br>&#125;<br></code></pre></td></tr></table></figure>
<hr />
<h1 id="static"><a href="#static" class="headerlink" title="static"></a><a class="markdownIt-Anchor" href="#static"></a> Static</h1>
<p>static 改变变量/函数的存储期和链接属性，不改变类型！</p>
<h2 id="三种不同用法"><a href="#三种不同用法" class="headerlink" title="三种不同用法"></a><a class="markdownIt-Anchor" href="#三种不同用法"></a> 三种不同用法</h2>
<ol>
<li>局部变量 + static（函数内使用）</li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">counter</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">static</span> <span class="hljs-type">int</span> count = <span class="hljs-number">0</span>;  <span class="hljs-comment">// 关键！</span><br>    count++;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;调用次数: %d\\n&quot;</span>, count);<br>&#125;<br><br></code></pre></td></tr></table></figure>
<p>作用：</p>
<p>· ✅ 变量只在第一次调用时初始化<br />
· ✅ 生命周期延长到程序结束<br />
· ✅ 存储位置：数据段(.data/.bss)，不在栈上！<br />
· ✅ 保持上次调用结束时的值（有记忆！）</p>
<hr />
<ol start="2">
<li>全局变量/函数 + static（文件作用域）</li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// file.c</span><br><span class="hljs-type">static</span> <span class="hljs-type">int</span> internal_var = <span class="hljs-number">42</span>;  <span class="hljs-comment">// 只能在本文件使用</span><br><span class="hljs-type">static</span> <span class="hljs-type">void</span> <span class="hljs-title function_">helper</span><span class="hljs-params">()</span> &#123;         <span class="hljs-comment">// 只能在本文件调用</span><br>    <span class="hljs-comment">// ...</span><br>&#125;<br><br></code></pre></td></tr></table></figure>
<p>作用：</p>
<p>· ✅ 限制作用域到当前文件<br />
· ✅ 避免命名冲突（内部链接）<br />
· ✅ 信息隐藏（封装）</p>
<p>比喻： 公司内部文件（不外传）</p>
<hr />
<ol start="3">
<li>C++类成员 + static</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-type">static</span> <span class="hljs-type">int</span> shared_count;  <span class="hljs-comment">// 所有对象共享</span><br>&#125;;<br><span class="hljs-type">int</span> MyClass::shared_count = <span class="hljs-number">0</span>;<br><br></code></pre></td></tr></table></figure>
<p>作用：</p>
<p>· ✅ 类级别变量，所有实例共享<br />
· ✅ 无需创建对象即可访问<br />
· ✅ 常用于计数器、配置等</p>
<hr />
<h2 id="生动记忆法"><a href="#生动记忆法" class="headerlink" title="生动记忆法"></a><a class="markdownIt-Anchor" href="#生动记忆法"></a> 生动记忆法</h2>
<p>普通变量 = 临时工</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">每天上班（函数调用）→ 分配工位（分配内存）<br>每天下班（函数返回）→ 清空工位（释放内存）<br>第二天是新开始（值不保留）<br></code></pre></td></tr></table></figure>
<p>static变量 = 正式员工</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">入职时（第一次调用）→ 分配固定工位（数据段）<br>每天下班（函数返回）→ 工位保留（内存不释放）<br>第二天继续昨天的工作（值保留）<br></code></pre></td></tr></table></figure>
<hr />
<h2 id="关键理解点"><a href="#关键理解点" class="headerlink" title="关键理解点"></a><a class="markdownIt-Anchor" href="#关键理解点"></a> 关键理解点</h2>
<ol>
<li>static不改变数据类型！</li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">static</span> <span class="hljs-type">int</span> x;      <span class="hljs-comment">// 还是int类型，只是存储方式变了</span><br><span class="hljs-type">static</span> <span class="hljs-type">char</span> c;     <span class="hljs-comment">// 还是char类型</span><br><br></code></pre></td></tr></table></figure>
<ol start="2">
<li>初始化的特殊性</li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">func</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">static</span> <span class="hljs-type">int</span> x = expensive_computation();  <span class="hljs-comment">// 只计算一次！</span><br>    <span class="hljs-comment">// 后续调用直接使用计算好的值</span><br>&#125;<br><br></code></pre></td></tr></table></figure>
<hr />
<h1 id="宏"><a href="#宏" class="headerlink" title="宏"></a><a class="markdownIt-Anchor" href="#宏"></a> 宏</h1>
<h2 id="一-什么是宏"><a href="#一-什么是宏" class="headerlink" title="一-什么是宏"></a><a class="markdownIt-Anchor" href="#一-什么是宏"></a> 一、什么是宏？</h2>
<p>宏是预处理器指令，在编译前进行文本替换。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">define</span> PI 3.14159          <span class="hljs-comment">// 定义常量</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> SQUARE(x) ((x)*(x)) <span class="hljs-comment">// 定义函数式宏</span></span><br></code></pre></td></tr></table></figure>
<h2 id="二-基本用法"><a href="#二-基本用法" class="headerlink" title="二-基本用法"></a><a class="markdownIt-Anchor" href="#二-基本用法"></a> 二、基本用法</h2>
<ol>
<li>对象宏（常量替换）</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAX_SIZE 100        <span class="hljs-comment">// 定义常量</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> APP_NAME <span class="hljs-string">&quot;MyApp&quot;</span>    <span class="hljs-comment">// 字符串常量</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> DEBUG_MODE          <span class="hljs-comment">// 无值宏（条件编译用）</span></span><br><br><span class="hljs-type">int</span> array[MAX_SIZE];        <span class="hljs-comment">// 编译前替换为：int array[100];</span><br></code></pre></td></tr></table></figure>
<ol start="2">
<li>函数式宏（带参数）</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">define</span> MIN(a, b) ((a) &lt; (b) ? (a) : (b))</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ABS(x) ((x) &lt; 0 ? -(x) : (x))</span><br><br><span class="hljs-type">int</span> result = <span class="hljs-built_in">MIN</span>(<span class="hljs-number">10</span>, <span class="hljs-number">20</span>);   <span class="hljs-comment">// 替换为：((10) &lt; (20) ? (10) : (20))</span><br></code></pre></td></tr></table></figure>
<ol start="3">
<li>多行宏</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">define</span> LOG_ERROR(msg) \\</span><br><span class="hljs-meta">    std::cerr &lt;&lt; <span class="hljs-string">&quot;ERROR: &quot;</span> &lt;&lt; msg &lt;&lt; std::endl; \\</span><br><span class="hljs-meta">    std::cerr &lt;&lt; <span class="hljs-string">&quot;File: &quot;</span> &lt;&lt; __FILE__ &lt;&lt; std::endl; \\</span><br><span class="hljs-meta">    std::cerr &lt;&lt; <span class="hljs-string">&quot;Line: &quot;</span> &lt;&lt; __LINE__ &lt;&lt; std::endl;</span><br><br><span class="hljs-comment">// 使用</span><br><span class="hljs-built_in">LOG_ERROR</span>(<span class="hljs-string">&quot;File not found&quot;</span>);<br></code></pre></td></tr></table></figure>
<h2 id="三-特殊符号"><a href="#三-特殊符号" class="headerlink" title="三-特殊符号"></a><a class="markdownIt-Anchor" href="#三-特殊符号"></a> 三、特殊符号</h2>
<ol>
<li>字符串化（#）</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">define</span> STRINGIFY(x) #x     <span class="hljs-comment">// 将参数转为字符串</span></span><br><br><span class="hljs-type">const</span> <span class="hljs-type">char</span>* str = <span class="hljs-built_in">STRINGIFY</span>(hello);  <span class="hljs-comment">// 变为 &quot;hello&quot;</span><br><span class="hljs-type">const</span> <span class="hljs-type">char</span>* str2 = <span class="hljs-built_in">STRINGIFY</span>(<span class="hljs-number">3.14</span>);  <span class="hljs-comment">// 变为 &quot;3.14&quot;</span><br></code></pre></td></tr></table></figure>
<ol start="2">
<li>连接符（##）</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">define</span> CONCAT(a, b) a##b   <span class="hljs-comment">// 连接两个标识符</span></span><br><br><span class="hljs-type">int</span> var1, var2, var3;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">CONCAT</span><span class="hljs-params">(var, <span class="hljs-number">1</span>)</span> </span>= <span class="hljs-number">10</span>;    <span class="hljs-comment">// 变为 int var1 = 10;</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">CONCAT</span><span class="hljs-params">(var, <span class="hljs-number">2</span>)</span> </span>= <span class="hljs-number">20</span>;    <span class="hljs-comment">// 变为 int var2 = 20;</span><br></code></pre></td></tr></table></figure>
<ol start="3">
<li>变长参数宏（C++11）</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">define</span> LOG(format, ...) \\</span><br><span class="hljs-meta">    printf(<span class="hljs-string">&quot;[LOG] &quot;</span> format, ##__VA_ARGS__)</span><br><br><span class="hljs-built_in">LOG</span>(<span class="hljs-string">&quot;Value: %d, Name: %s\\n&quot;</span>, <span class="hljs-number">42</span>, <span class="hljs-string">&quot;John&quot;</span>);<br><span class="hljs-comment">// 展开：printf(&quot;[LOG] &quot; &quot;Value: %d, Name: %s\\n&quot;, 42, &quot;John&quot;);</span><br></code></pre></td></tr></table></figure>
<h2 id="四-预定义宏"><a href="#四-预定义宏" class="headerlink" title="四-预定义宏"></a><a class="markdownIt-Anchor" href="#四-预定义宏"></a> 四、预定义宏</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs cpp">cout &lt;&lt; <span class="hljs-string">&quot;文件: &quot;</span> &lt;&lt; __FILE__ &lt;&lt; endl;     <span class="hljs-comment">// 当前文件名</span><br>cout &lt;&lt; <span class="hljs-string">&quot;行号: &quot;</span> &lt;&lt; __LINE__ &lt;&lt; endl;     <span class="hljs-comment">// 当前行号</span><br>cout &lt;&lt; <span class="hljs-string">&quot;日期: &quot;</span> &lt;&lt; __DATE__ &lt;&lt; endl;     <span class="hljs-comment">// 编译日期</span><br>cout &lt;&lt; <span class="hljs-string">&quot;时间: &quot;</span> &lt;&lt; __TIME__ &lt;&lt; endl;     <span class="hljs-comment">// 编译时间</span><br>cout &lt;&lt; <span class="hljs-string">&quot;C++标准: &quot;</span> &lt;&lt; __cplusplus &lt;&lt; endl;<br><br><span class="hljs-comment">// 函数名宏（不同编译器）</span><br>cout &lt;&lt; <span class="hljs-string">&quot;函数: &quot;</span> &lt;&lt; __func__ &lt;&lt; endl;     <span class="hljs-comment">// C++11标准</span><br>cout &lt;&lt; <span class="hljs-string">&quot;函数: &quot;</span> &lt;&lt; __FUNCTION__ &lt;&lt; endl; <span class="hljs-comment">// GCC/MSVC</span><br>cout &lt;&lt; <span class="hljs-string">&quot;函数: &quot;</span> &lt;&lt; __PRETTY_FUNCTION__ &lt;&lt; endl; <span class="hljs-comment">// GCC详细名</span><br></code></pre></td></tr></table></figure>
<p>​</p>
<h1 id="内联函数"><a href="#内联函数" class="headerlink" title="内联函数"></a><a class="markdownIt-Anchor" href="#内联函数"></a> 内联函数</h1>
<h2 id="一-什么是内联函数"><a href="#一-什么是内联函数" class="headerlink" title="一-什么是内联函数"></a><a class="markdownIt-Anchor" href="#一-什么是内联函数"></a> 一、什么是内联函数？</h2>
<ol>
<li>基本概念</li>
</ol>
<p>内联函数是一种编译器优化技术，将函数调用替换为函数体代码，消除函数调用的开销。</p>
<ol start="2">
<li>关键特性</li>
</ol>
<p>· 编译时行为：由编译器决定是否内联<br />
· 空间换时间：代码膨胀换取执行速度<br />
· 建议而非命令：inline 关键字只是建议</p>
<h2 id="二-三种写法"><a href="#二-三种写法" class="headerlink" title="二-三种写法"></a><a class="markdownIt-Anchor" href="#二-三种写法"></a> 二、三种写法</h2>
<ol>
<li>使用 inline 关键字</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 传统写法，在头文件中</span><br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">int</span> <span class="hljs-title">max</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> (a &gt; b) ? a : b;<br>&#125;<br></code></pre></td></tr></table></figure>
<ol start="2">
<li>类内定义（隐式内联）</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Vector</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">getX</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>&#123; <span class="hljs-keyword">return</span> x; &#125;  <span class="hljs-comment">// 自动成为内联候选</span><br><span class="hljs-keyword">private</span>:<br>    <span class="hljs-type">double</span> x;<br>&#125;;<br></code></pre></td></tr></table></figure>
<ol start="3">
<li>类外定义需显式声明</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Vector</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">getX</span><span class="hljs-params">()</span> <span class="hljs-type">const</span></span>;  <span class="hljs-comment">// 声明</span><br>&#125;;<br><br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">double</span> <span class="hljs-title">Vector::getX</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>&#123;  <span class="hljs-comment">// 定义时加 inline</span><br>    <span class="hljs-keyword">return</span> x;<br>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="三-现代-c-的扩展"><a href="#三-现代-c-的扩展" class="headerlink" title="三-现代-c-的扩展"></a><a class="markdownIt-Anchor" href="#三-现代-c-的扩展"></a> 三、现代 C++ 的扩展</h2>
<ol>
<li>constexpr 函数（C++11+）</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">constexpr</span> <span class="hljs-type">int</span> <span class="hljs-title">factorial</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span> </span>&#123;  <span class="hljs-comment">// 编译时计算，隐式内联</span><br>    <span class="hljs-keyword">return</span> n &lt;= <span class="hljs-number">1</span> ? <span class="hljs-number">1</span> : n * <span class="hljs-built_in">factorial</span>(n<span class="hljs-number">-1</span>);<br>&#125;<br><br><span class="hljs-keyword">constexpr</span> <span class="hljs-type">int</span> result = <span class="hljs-built_in">factorial</span>(<span class="hljs-number">5</span>);  <span class="hljs-comment">// 编译时计算：120</span><br></code></pre></td></tr></table></figure>
<ol start="2">
<li>consteval 函数（C++20）</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">consteval</span> <span class="hljs-type">int</span> <span class="hljs-title">square</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span> </span>&#123;  <span class="hljs-comment">// 必须编译时执行</span><br>    <span class="hljs-keyword">return</span> n * n;<br>&#125;<br><br><span class="hljs-keyword">constexpr</span> <span class="hljs-type">int</span> val = <span class="hljs-built_in">square</span>(<span class="hljs-number">10</span>);  <span class="hljs-comment">// OK，编译时计算</span><br><span class="hljs-comment">// int runtime = square(x);      // 错误！x不是常量表达式</span><br></code></pre></td></tr></table></figure>
<ol start="3">
<li>Lambda 表达式</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">auto</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> -&gt; <span class="hljs-type">int</span> </span>&#123;<br>    <span class="hljs-keyword">auto</span> sum = [](<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b) -&gt; <span class="hljs-type">int</span> &#123;<br>        <span class="hljs-keyword">return</span> a + b;<br>    &#125;;  <span class="hljs-comment">// Lambda通常被内联优化</span><br><br>    <span class="hljs-type">int</span> result = <span class="hljs-built_in">sum</span>(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>);  <span class="hljs-comment">// 很可能内联</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<h1 id="析构函数"><a href="#析构函数" class="headerlink" title="析构函数"></a><a class="markdownIt-Anchor" href="#析构函数"></a> 析构函数</h1>
<h2 id="一-什么是析构函数"><a href="#一-什么是析构函数" class="headerlink" title="一-什么是析构函数"></a><a class="markdownIt-Anchor" href="#一-什么是析构函数"></a> 一、什么是析构函数？</h2>
<p>析构函数是对象被销毁时自动调用的特殊成员函数，用于清理资源。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">File</span> &#123;<br>    FILE* handle;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-comment">// 构造函数：获取资源</span><br>    <span class="hljs-built_in">File</span>(<span class="hljs-type">const</span> <span class="hljs-type">char</span>* filename) &#123;<br>        handle = <span class="hljs-built_in">fopen</span>(filename, <span class="hljs-string">&quot;r&quot;</span>);<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;文件打开\\n&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// 析构函数：释放资源</span><br>    ~<span class="hljs-built_in">File</span>() &#123;  <span class="hljs-comment">// 注意：以 ~ 开头，与类名相同，无参数无返回值</span><br>        <span class="hljs-keyword">if</span> (handle) &#123;<br>            <span class="hljs-built_in">fclose</span>(handle);<br>            std::cout &lt;&lt; <span class="hljs-string">&quot;文件关闭\\n&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="二-基本语法和特性"><a href="#二-基本语法和特性" class="headerlink" title="二-基本语法和特性"></a><a class="markdownIt-Anchor" href="#二-基本语法和特性"></a> 二、基本语法和特性</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><br>语法：<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    ~<span class="hljs-built_in">MyClass</span>() &#123;  <span class="hljs-comment">// 析构函数</span><br>        <span class="hljs-comment">// 清理代码</span><br>    &#125;<br>&#125;;<br><br>​<br>特性：<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Example</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-comment">// 1. 名称：~类名</span><br>    ~<span class="hljs-built_in">Example</span>() &#123; std::cout &lt;&lt; <span class="hljs-string">&quot;析构\\n&quot;</span>; &#125;<br><br>    <span class="hljs-comment">// 2. 无参数</span><br>    <span class="hljs-comment">// ~Example(int x) &#123; &#125;  // ❌ 错误！不能有参数</span><br><br>    <span class="hljs-comment">// 3. 无返回值（连void都没有）</span><br>    <span class="hljs-comment">// ~Example() &#123; return 0; &#125;  // ❌ 错误！</span><br><br>    <span class="hljs-comment">// 4. 每个类只有一个析构函数</span><br>    <span class="hljs-comment">// ~Example(int) &#123; &#125;  // ❌ 不能重载！</span><br><br>    <span class="hljs-comment">// 5. 通常是public</span><br><span class="hljs-keyword">private</span>:<br>    <span class="hljs-comment">// ~Example() &#123; &#125;  // 可以private，但很少用</span><br>&#125;;<br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="三-什么时候调用析构函数"><a href="#三-什么时候调用析构函数" class="headerlink" title="三-什么时候调用析构函数"></a><a class="markdownIt-Anchor" href="#三-什么时候调用析构函数"></a> 三、什么时候调用析构函数？</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><br>场景<span class="hljs-number">1</span>：局部对象离开作用域<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-function">File <span class="hljs-title">file</span><span class="hljs-params">(<span class="hljs-string">&quot;data.txt&quot;</span>)</span></span>;  <span class="hljs-comment">// 构造函数调用</span><br>    <span class="hljs-comment">// 使用文件...</span><br>&#125;  <span class="hljs-comment">// 离开作用域，自动调用 ~File()</span><br><br>​<br>场景<span class="hljs-number">2</span>：动态对象被<span class="hljs-keyword">delete</span><br>File* file = <span class="hljs-keyword">new</span> <span class="hljs-built_in">File</span>(<span class="hljs-string">&quot;data.txt&quot;</span>);<br><span class="hljs-comment">// 使用文件...</span><br><span class="hljs-keyword">delete</span> file;  <span class="hljs-comment">// 调用 ~File()</span><br><br>​<br>场景<span class="hljs-number">3</span>：容器中的对象被销毁<br>std::vector&lt;File&gt; files;<br>files.<span class="hljs-built_in">push_back</span>(<span class="hljs-built_in">File</span>(<span class="hljs-string">&quot;1.txt&quot;</span>));<br>files.<span class="hljs-built_in">push_back</span>(<span class="hljs-built_in">File</span>(<span class="hljs-string">&quot;2.txt&quot;</span>));<br><span class="hljs-comment">// vector销毁时，所有元素的析构函数被调用</span><br><br>​<br>场景<span class="hljs-number">4</span>：临时对象使用结束<br><span class="hljs-built_in">File</span>(<span class="hljs-string">&quot;temp.txt&quot;</span>).<span class="hljs-built_in">read</span>();<br><span class="hljs-comment">// 临时对象使用后立即销毁，调用 ~File()</span><br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="四-析构函数的实际应用"><a href="#四-析构函数的实际应用" class="headerlink" title="四-析构函数的实际应用"></a><a class="markdownIt-Anchor" href="#四-析构函数的实际应用"></a> 四、析构函数的实际应用</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><br>应用<span class="hljs-number">1</span>：管理动态内存<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Buffer</span> &#123;<br><span class="hljs-keyword">private</span>:<br>    <span class="hljs-type">int</span>* data;<br>    <span class="hljs-type">size_t</span> size;<br><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-comment">// 构造函数：分配内存</span><br>    <span class="hljs-built_in">Buffer</span>(<span class="hljs-type">size_t</span> sz) : <span class="hljs-built_in">size</span>(sz) &#123;<br>        data = <span class="hljs-keyword">new</span> <span class="hljs-type">int</span>[sz];<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;分配 &quot;</span> &lt;&lt; sz &lt;&lt; <span class="hljs-string">&quot; 个int\\n&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// 析构函数：释放内存</span><br>    ~<span class="hljs-built_in">Buffer</span>() &#123;<br>        <span class="hljs-keyword">delete</span>[] data;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;释放内存\\n&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// 禁止拷贝（避免双重释放）</span><br>    <span class="hljs-built_in">Buffer</span>(<span class="hljs-type">const</span> Buffer&amp;) = <span class="hljs-keyword">delete</span>;<br>    Buffer&amp; <span class="hljs-keyword">operator</span>=(<span class="hljs-type">const</span> Buffer&amp;) = <span class="hljs-keyword">delete</span>;<br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-function">Buffer <span class="hljs-title">buf</span><span class="hljs-params">(<span class="hljs-number">100</span>)</span></span>;  <span class="hljs-comment">// 分配内存</span><br>    <span class="hljs-comment">// 使用buf...</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;  <span class="hljs-comment">// 自动释放内存，无泄漏！</span><br>&#125;<br><br>​<br>应用<span class="hljs-number">2</span>：管理文件资源<br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;fstream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string&gt;</span></span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">LogFile</span> &#123;<br><span class="hljs-keyword">private</span>:<br>    std::ofstream file;<br><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">LogFile</span>(<span class="hljs-type">const</span> std::string&amp; filename)<br>        : <span class="hljs-built_in">file</span>(filename, std::ios::app) &#123;<br>        <span class="hljs-keyword">if</span> (!file.<span class="hljs-built_in">is_open</span>()) &#123;<br>            <span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">runtime_error</span>(<span class="hljs-string">&quot;无法打开日志文件&quot;</span>);<br>        &#125;<br>        file &lt;&lt; <span class="hljs-string">&quot;=== 日志开始 ===\\n&quot;</span>;<br>    &#125;<br><br>    ~<span class="hljs-built_in">LogFile</span>() &#123;<br>        <span class="hljs-keyword">if</span> (file.<span class="hljs-built_in">is_open</span>()) &#123;<br>            file &lt;&lt; <span class="hljs-string">&quot;=== 日志结束 ===\\n&quot;</span>;<br>            file.<span class="hljs-built_in">close</span>();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">write</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; message)</span> </span>&#123;<br>        file &lt;&lt; message &lt;&lt; std::endl;<br>    &#125;<br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-function">LogFile <span class="hljs-title">log</span><span class="hljs-params">(<span class="hljs-string">&quot;app.log&quot;</span>)</span></span>;<br>        log.<span class="hljs-built_in">write</span>(<span class="hljs-string">&quot;程序启动&quot;</span>);<br>        <span class="hljs-comment">// ... 其他代码</span><br>        log.<span class="hljs-built_in">write</span>(<span class="hljs-string">&quot;处理数据&quot;</span>);<br>        <span class="hljs-comment">// 程序结束或异常时，自动关闭文件并写结束标记</span><br>    &#125; <span class="hljs-built_in">catch</span> (<span class="hljs-type">const</span> std::exception&amp; e) &#123;<br>        std::cerr &lt;&lt; <span class="hljs-string">&quot;错误: &quot;</span> &lt;&lt; e.<span class="hljs-built_in">what</span>() &lt;&lt; std::endl;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br>​<br>应用<span class="hljs-number">3</span>：管理网络连接<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">DatabaseConnection</span> &#123;<br><span class="hljs-keyword">private</span>:<br>    <span class="hljs-type">void</span>* connection;  <span class="hljs-comment">// 假设的数据库连接</span><br><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">DatabaseConnection</span>(<span class="hljs-type">const</span> std::string&amp; url) &#123;<br>        <span class="hljs-comment">// 建立连接</span><br>        std::cout &lt;&lt; <span class="hljs-string">&quot;连接数据库: &quot;</span> &lt;&lt; url &lt;&lt; std::endl;<br>        <span class="hljs-comment">// connection = db_connect(url);</span><br>    &#125;<br><br>    ~<span class="hljs-built_in">DatabaseConnection</span>() &#123;<br>        <span class="hljs-comment">// 断开连接</span><br>        std::cout &lt;&lt; <span class="hljs-string">&quot;断开数据库连接\\n&quot;</span>;<br>        <span class="hljs-comment">// db_disconnect(connection);</span><br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">execute</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; query)</span> </span>&#123;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;执行: &quot;</span> &lt;&lt; query &lt;&lt; std::endl;<br>        <span class="hljs-comment">// db_execute(connection, query);</span><br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="五-raii模式析构函数的哲学"><a href="#五-raii模式析构函数的哲学" class="headerlink" title="五-raii模式析构函数的哲学"></a><a class="markdownIt-Anchor" href="#五-raii模式析构函数的哲学"></a> 五、RAII模式（析构函数的哲学）</h2>
<p>RAII = Resource Acquisition Is Initialization（资源获取即初始化）<br />
核心思想：对象的生命周期 = 资源的生命周期<br />
// RAII的黄金法则：在构造函数中获取资源，在析构函数中释放资源</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">RAII_Example</span> &#123;<br>    Resource* res;<br><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">RAII_Example</span>() : <span class="hljs-built_in">res</span>(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Resource</span>()) &#123;  <span class="hljs-comment">// 获取</span><br>        <span class="hljs-comment">// 如果这里失败，析构函数不会被调用</span><br>    &#125;<br><br>    ~<span class="hljs-built_in">RAII_Example</span>() &#123; <span class="hljs-keyword">delete</span> res; &#125;  <span class="hljs-comment">// 保证释放</span><br>&#125;;<br><br>​<br>RAII的威力：异常安全<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">risky_operation</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-function">File <span class="hljs-title">file</span><span class="hljs-params">(<span class="hljs-string">&quot;data.txt&quot;</span>)</span></span>;      <span class="hljs-comment">// RAII：文件</span><br>    <span class="hljs-function">DatabaseConnection <span class="hljs-title">db</span><span class="hljs-params">(<span class="hljs-string">&quot;...&quot;</span>)</span></span>; <span class="hljs-comment">// RAII：数据库连接</span><br>    <span class="hljs-function">NetworkSocket <span class="hljs-title">socket</span><span class="hljs-params">(<span class="hljs-string">&quot;...&quot;</span>)</span></span>;  <span class="hljs-comment">// RAII：网络连接</span><br><br>    <span class="hljs-comment">// 如果这里抛出异常...</span><br>    <span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">runtime_error</span>(<span class="hljs-string">&quot;出错了！&quot;</span>);<br><br>    <span class="hljs-comment">// 所有资源都会自动释放！</span><br>    <span class="hljs-comment">// 析构函数按创建相反的顺序调用：</span><br>    <span class="hljs-comment">// 1. ~NetworkSocket()</span><br>    <span class="hljs-comment">// 2. ~DatabaseConnection()</span><br>    <span class="hljs-comment">// 3. ~File()</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="六-继承中的析构函数"><a href="#六-继承中的析构函数" class="headerlink" title="六-继承中的析构函数"></a><a class="markdownIt-Anchor" href="#六-继承中的析构函数"></a> 六、继承中的析构函数</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><br>规则<span class="hljs-number">1</span>：虚析构函数<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Base</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-keyword">virtual</span> ~<span class="hljs-built_in">Base</span>() &#123;  <span class="hljs-comment">// ✅ 虚析构函数</span><br>        std::cout &lt;&lt; <span class="hljs-string">&quot;~Base()\\n&quot;</span>;<br>    &#125;<br>&#125;;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Derived</span> : <span class="hljs-keyword">public</span> Base &#123;<br>    <span class="hljs-type">int</span>* data;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">Derived</span>() : <span class="hljs-built_in">data</span>(<span class="hljs-keyword">new</span> <span class="hljs-type">int</span>[<span class="hljs-number">100</span>]) &#123;&#125;<br><br>    ~<span class="hljs-built_in">Derived</span>() <span class="hljs-keyword">override</span> &#123;  <span class="hljs-comment">// ✅ override 正确释放派生类资源</span><br>        <span class="hljs-keyword">delete</span>[] data;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;~Derived()\\n&quot;</span>;<br>    &#125;<br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    Base* ptr = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Derived</span>();<br>    <span class="hljs-keyword">delete</span> ptr;  <span class="hljs-comment">// ✅ 正确调用 ~Derived()，然后 ~Base()</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br>​<br>❌ 错误示例：没有虚析构函数<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">BadBase</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    ~<span class="hljs-built_in">BadBase</span>() &#123; std::cout &lt;&lt; <span class="hljs-string">&quot;~BadBase()\\n&quot;</span>; &#125;<br>&#125;;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">BadDerived</span> : <span class="hljs-keyword">public</span> BadBase &#123;<br>    <span class="hljs-type">int</span>* data;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">BadDerived</span>() : <span class="hljs-built_in">data</span>(<span class="hljs-keyword">new</span> <span class="hljs-type">int</span>[<span class="hljs-number">100</span>]) &#123;&#125;<br><br>    ~<span class="hljs-built_in">BadDerived</span>() &#123;<br>        <span class="hljs-keyword">delete</span>[] data;  <span class="hljs-comment">// 可能不会被调用！</span><br>        std::cout &lt;&lt; <span class="hljs-string">&quot;~BadDerived()\\n&quot;</span>;<br>    &#125;<br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    BadBase* ptr = <span class="hljs-keyword">new</span> <span class="hljs-built_in">BadDerived</span>();<br>    <span class="hljs-keyword">delete</span> ptr;  <span class="hljs-comment">// ❌ 只调用 ~BadBase()，内存泄漏！</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="八-析构函数的执行顺序"><a href="#八-析构函数的执行顺序" class="headerlink" title="八-析构函数的执行顺序"></a><a class="markdownIt-Anchor" href="#八-析构函数的执行顺序"></a> 八、析构函数的执行顺序</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Member</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    ~<span class="hljs-built_in">Member</span>() &#123; std::cout &lt;&lt; <span class="hljs-string">&quot;~Member()\\n&quot;</span>; &#125;<br>&#125;;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Container</span> &#123;<br>    Member m1, m2;<br>    <span class="hljs-type">int</span>* data;<br><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">Container</span>() : <span class="hljs-built_in">data</span>(<span class="hljs-keyword">new</span> <span class="hljs-type">int</span>[<span class="hljs-number">10</span>]) &#123;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;Container()\\n&quot;</span>;<br>    &#125;<br><br>    ~<span class="hljs-built_in">Container</span>() &#123;<br>        <span class="hljs-keyword">delete</span>[] data;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;~Container()\\n&quot;</span>;<br>        <span class="hljs-comment">// 成员 m2, m1 自动析构</span><br>    &#125;<br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    Container c;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-comment">// 输出：</span><br><span class="hljs-comment">// Container()</span><br><span class="hljs-comment">// ~Container()</span><br><span class="hljs-comment">// ~Member()</span><br><span class="hljs-comment">// ~Member()</span><br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="九-常见错误和陷阱"><a href="#九-常见错误和陷阱" class="headerlink" title="九-常见错误和陷阱"></a><a class="markdownIt-Anchor" href="#九-常见错误和陷阱"></a> 九、常见错误和陷阱</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs cpp">错误<span class="hljs-number">1</span>：忘记释放资源<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">BadClass</span> &#123;<br>    <span class="hljs-type">int</span>* data;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">BadClass</span>() : <span class="hljs-built_in">data</span>(<span class="hljs-keyword">new</span> <span class="hljs-type">int</span>[<span class="hljs-number">100</span>]) &#123;&#125;<br>    <span class="hljs-comment">// ❌ 忘记写析构函数！</span><br>    <span class="hljs-comment">// 内存泄漏！</span><br>&#125;;<br><br>​<br>错误<span class="hljs-number">2</span>：双重释放<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">DoubleFree</span> &#123;<br>    <span class="hljs-type">int</span>* data;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">DoubleFree</span>() : <span class="hljs-built_in">data</span>(<span class="hljs-keyword">new</span> <span class="hljs-type">int</span>[<span class="hljs-number">10</span>]) &#123;&#125;<br><br>    ~<span class="hljs-built_in">DoubleFree</span>() &#123;<br>        <span class="hljs-keyword">delete</span>[] data;<br>    &#125;<br><br>    <span class="hljs-comment">// ❌ 拷贝构造函数导致两个对象共享同一内存</span><br>    <span class="hljs-built_in">DoubleFree</span>(<span class="hljs-type">const</span> DoubleFree&amp; other) : <span class="hljs-built_in">data</span>(other.data) &#123;&#125;<br><br>    <span class="hljs-comment">// 当两个对象析构时，delete[] 会被调用两次！</span><br>&#125;;<br><br>​<br>错误<span class="hljs-number">3</span>：部分构造问题<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Problematic</span> &#123;<br>    <span class="hljs-type">int</span>* ptr1;<br>    <span class="hljs-type">int</span>* ptr2;<br><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">Problematic</span>() &#123;<br>        ptr1 = <span class="hljs-keyword">new</span> <span class="hljs-type">int</span>[<span class="hljs-number">100</span>];<br>        <span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">runtime_error</span>(<span class="hljs-string">&quot;构造失败！&quot;</span>);  <span class="hljs-comment">// ❌ 异常！</span><br>        ptr2 = <span class="hljs-keyword">new</span> <span class="hljs-type">int</span>[<span class="hljs-number">100</span>];  <span class="hljs-comment">// 不会执行</span><br>    &#125;<br><br>    ~<span class="hljs-built_in">Problematic</span>() &#123;<br>        <span class="hljs-keyword">delete</span>[] ptr1;  <span class="hljs-comment">// 会被调用吗？</span><br>        <span class="hljs-keyword">delete</span>[] ptr2;<br>    &#125;<br>&#125;;<br><br><span class="hljs-comment">// 如果构造函数抛出异常，析构函数不会被调用！</span><br><span class="hljs-comment">// ptr1 的内存泄漏！</span><br></code></pre></td></tr></table></figure>
<p>​<br />
十、最佳实践</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs cpp">遵循RAII原则<br><span class="hljs-comment">// ✅ 好：构造函数获取，析构函数释放</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">GoodResource</span> &#123;<br>    std::unique_ptr&lt;Resource&gt; res;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">GoodResource</span>() : <span class="hljs-built_in">res</span>(<span class="hljs-built_in">acquire_resource</span>()) &#123;&#125;<br>    <span class="hljs-comment">// 不需要写析构函数，unique_ptr自动处理</span><br>&#125;;<br><br>​<br>基类总是用虚析构函数<br><span class="hljs-comment">// ✅ 好：多态基类必须有虚析构函数</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Base</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-keyword">virtual</span> ~<span class="hljs-built_in">Base</span>() = <span class="hljs-keyword">default</span>;  <span class="hljs-comment">// C++11 简洁写法</span><br>&#125;;<br><br>​<br>使用智能指针避免手动管理<br><span class="hljs-comment">// ✅ 好：让智能指针处理释放</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Modern</span> &#123;<br>    std::unique_ptr&lt;<span class="hljs-type">int</span>[]&gt; data;<br>    std::shared_ptr&lt;Connection&gt; conn;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">Modern</span>()<br>        : <span class="hljs-built_in">data</span>(std::<span class="hljs-built_in">make_unique</span>&lt;<span class="hljs-type">int</span>[]&gt;(<span class="hljs-number">100</span>)),<br>          <span class="hljs-built_in">conn</span>(std::<span class="hljs-built_in">make_shared</span>&lt;Connection&gt;()) &#123;&#125;<br>    <span class="hljs-comment">// 不需要写析构函数！</span><br>&#125;;<br><br>​<br>处理异常安全<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ExceptionSafe</span> &#123;<br>    Resource* res1;<br>    Resource* res2;<br><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">ExceptionSafe</span>() : <span class="hljs-built_in">res1</span>(<span class="hljs-literal">nullptr</span>), <span class="hljs-built_in">res2</span>(<span class="hljs-literal">nullptr</span>) &#123;<br>        res1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Resource</span>();      <span class="hljs-comment">// 可能失败</span><br>        <span class="hljs-keyword">try</span> &#123;<br>            res2 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Resource</span>();  <span class="hljs-comment">// 可能失败</span><br>        &#125; <span class="hljs-built_in">catch</span> (...) &#123;<br>            <span class="hljs-keyword">delete</span> res1;            <span class="hljs-comment">// 清理部分构造的资源</span><br>            <span class="hljs-keyword">throw</span>;<br>        &#125;<br>    &#125;<br><br>    ~<span class="hljs-built_in">ExceptionSafe</span>() &#123;<br>        <span class="hljs-keyword">delete</span> res2;<br>        <span class="hljs-keyword">delete</span> res1;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h1 id="lambda"><a href="#lambda" class="headerlink" title="lambda"></a><a class="markdownIt-Anchor" href="#lambda"></a> Lambda</h1>
<h2 id="一-什么是lambda"><a href="#一-什么是lambda" class="headerlink" title="一-什么是lambda"></a><a class="markdownIt-Anchor" href="#一-什么是lambda"></a> 一、什么是Lambda？</h2>
<p>Lambda是匿名函数对象，可以在需要函数的地方直接定义，不需要单独的函数声明。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 传统函数</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span> </span>&#123; <span class="hljs-keyword">return</span> a + b; &#125;<br><br><span class="hljs-comment">// Lambda表达式</span><br><span class="hljs-keyword">auto</span> add_lambda = [](<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b) &#123; <span class="hljs-keyword">return</span> a + b; &#125;;<br></code></pre></td></tr></table></figure>
<h2 id="二-lambda的基本语法"><a href="#二-lambda的基本语法" class="headerlink" title="二-lambda的基本语法"></a><a class="markdownIt-Anchor" href="#二-lambda的基本语法"></a> 二、Lambda的基本语法</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs cpp">[捕获列表](参数列表) -&gt; 返回类型 &#123; 函数体 &#125;<br>​<br>最简形式：<br>[]()&#123;&#125;  <span class="hljs-comment">// 什么都不做的最简lambda</span><br>​<br>实际例子：<br><span class="hljs-comment">// 1. 无参数，无返回值</span><br><span class="hljs-keyword">auto</span> sayHello = []() &#123;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;Hello, World!&quot;</span> &lt;&lt; std::endl;<br>&#125;;<br><br><span class="hljs-comment">// 2. 有参数，有返回值</span><br><span class="hljs-keyword">auto</span> add = [](<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b) -&gt; <span class="hljs-type">int</span> &#123;<br>    <span class="hljs-keyword">return</span> a + b;<br>&#125;;<br><br><span class="hljs-comment">// 3. 省略返回类型（编译器自动推导）</span><br><span class="hljs-keyword">auto</span> multiply = [](<span class="hljs-type">double</span> x, <span class="hljs-type">double</span> y) &#123;<br>    <span class="hljs-keyword">return</span> x * y;  <span class="hljs-comment">// 自动推导为double</span><br>&#125;;<br><br><span class="hljs-comment">// 4. 立即调用（IIFE）</span><br><span class="hljs-type">int</span> result = [](<span class="hljs-type">int</span> x) &#123; <span class="hljs-keyword">return</span> x * x; &#125;(<span class="hljs-number">5</span>);  <span class="hljs-comment">// 25</span><br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="三-捕获列表详解"><a href="#三-捕获列表详解" class="headerlink" title="三-捕获列表详解"></a><a class="markdownIt-Anchor" href="#三-捕获列表详解"></a> 三、捕获列表详解</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs cpp">不捕获任何变量 []<br><span class="hljs-type">int</span> x = <span class="hljs-number">10</span>, y = <span class="hljs-number">20</span>;<br><span class="hljs-keyword">auto</span> func = []() &#123;<br>    <span class="hljs-comment">// ❌ 不能访问x, y</span><br>    <span class="hljs-comment">// return x + y;  // 错误！</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;;<br>​<br>值捕获 [var]<br><span class="hljs-type">int</span> value = <span class="hljs-number">42</span>;<br><span class="hljs-keyword">auto</span> copy_capture = [value]() &#123;<br>    std::cout &lt;&lt; value &lt;&lt; std::endl;  <span class="hljs-comment">// 42</span><br>    <span class="hljs-comment">// value = 100;  // ❌ 错误！不能修改（默认const）</span><br>&#125;;<br>value = <span class="hljs-number">50</span>;  <span class="hljs-comment">// 修改原始变量</span><br><span class="hljs-built_in">copy_capture</span>();  <span class="hljs-comment">// 仍然输出42（捕获的是副本）</span><br>​<br>引用捕获 [&amp;var]<br><span class="hljs-type">int</span> counter = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">auto</span> ref_capture = [&amp;counter]() &#123;<br>    counter++;  <span class="hljs-comment">// ✅ 可以修改原始变量</span><br>    std::cout &lt;&lt; counter &lt;&lt; std::endl;<br>&#125;;<br><span class="hljs-built_in">ref_capture</span>();  <span class="hljs-comment">// 输出1，counter变为1</span><br>​<br>隐式值捕获 [=]<br><span class="hljs-type">int</span> a = <span class="hljs-number">1</span>, b = <span class="hljs-number">2</span>, c = <span class="hljs-number">3</span>;<br><span class="hljs-keyword">auto</span> implicit_copy = [=]() &#123;<br>    <span class="hljs-comment">// 可以访问a, b, c的副本</span><br>    <span class="hljs-keyword">return</span> a + b + c;<br>&#125;;<br>​<br>隐式引用捕获 [&amp;]<br><span class="hljs-type">int</span> x = <span class="hljs-number">10</span>, y = <span class="hljs-number">20</span>;<br><span class="hljs-keyword">auto</span> implicit_ref = [&amp;]() &#123;<br>    x = <span class="hljs-number">100</span>;  <span class="hljs-comment">// 修改原始x</span><br>    y = <span class="hljs-number">200</span>;  <span class="hljs-comment">// 修改原始y</span><br>&#125;;<br><span class="hljs-built_in">implicit_ref</span>();<br><span class="hljs-comment">// 现在 x=100, y=200</span><br>​<br>混合捕获<br><span class="hljs-type">int</span> a = <span class="hljs-number">1</span>, b = <span class="hljs-number">2</span>, c = <span class="hljs-number">3</span>;<br><span class="hljs-keyword">auto</span> mixed = [a, &amp;b, c]() &#123;  <span class="hljs-comment">// a值捕获，b引用捕获，c值捕获</span><br>    <span class="hljs-comment">// a是副本，b是引用，c是副本</span><br>&#125;;<br><br><span class="hljs-keyword">auto</span> mixed2 = [=, &amp;b]() &#123;     <span class="hljs-comment">// 除了b是引用，其他都是值捕获</span><br>    <span class="hljs-comment">// a, c是副本，b是引用</span><br>&#125;;<br><br><span class="hljs-keyword">auto</span> mixed3 = [&amp;, a]() &#123;      <span class="hljs-comment">// 除了a是值捕获，其他都是引用捕获</span><br>    <span class="hljs-comment">// a是副本，b, c是引用</span><br>&#125;;<br>​<br>移动捕获（C+<span class="hljs-number">+14</span>） [var = std::<span class="hljs-built_in">move</span>(var)]<br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;memory&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><br><span class="hljs-keyword">auto</span> big_data = std::make_unique&lt;std::vector&lt;<span class="hljs-type">int</span>&gt;&gt;();<br><span class="hljs-comment">// 移动捕获：转移所有权，避免拷贝</span><br><span class="hljs-keyword">auto</span> lambda = [data = std::<span class="hljs-built_in">move</span>(big_data)]() &#123;<br>    <span class="hljs-comment">// data现在拥有原来的big_data</span><br>    <span class="hljs-comment">// big_data变为nullptr</span><br>&#125;;<br></code></pre></td></tr></table></figure>
<h2 id="五-lambda的类型和存储"><a href="#五-lambda的类型和存储" class="headerlink" title="五-lambda的类型和存储"></a><a class="markdownIt-Anchor" href="#五-lambda的类型和存储"></a> 五、Lambda的类型和存储</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs cpp">Lambda是唯一的类型<br><span class="hljs-keyword">auto</span> lambda1 = []() &#123; <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>; &#125;;<br><span class="hljs-keyword">auto</span> lambda2 = []() &#123; <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>; &#125;;<br><br><span class="hljs-comment">// 每个lambda都有不同的类型</span><br><span class="hljs-built_in">static_assert</span>(!std::is_same&lt;<span class="hljs-keyword">decltype</span>(lambda1), <span class="hljs-keyword">decltype</span>(lambda2)&gt;::value,<br>              <span class="hljs-string">&quot;两个lambda类型不同！&quot;</span>);<br><br>​<br>如何存储Lambda<br><span class="hljs-comment">// 方法1：auto（最常见）</span><br><span class="hljs-keyword">auto</span> lambda = []() &#123; <span class="hljs-keyword">return</span> <span class="hljs-number">42</span>; &#125;;<br><br><span class="hljs-comment">// 方法2：std::function（有类型擦除开销，但更灵活）</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;functional&gt;</span></span><br>std::function&lt;<span class="hljs-type">void</span>()&gt; func = []() &#123; std::cout &lt;&lt; <span class="hljs-string">&quot;Hello&quot;</span>; &#125;;<br><br><span class="hljs-comment">// 方法3：函数指针（仅适用于无捕获的lambda）</span><br><span class="hljs-built_in">void</span> (*func_ptr)() = []() &#123; std::cout &lt;&lt; <span class="hljs-string">&quot;无捕获lambda可转函数指针&quot;</span>; &#125;;<br></code></pre></td></tr></table></figure>
<h2 id="六-lambda与函数对象的对比"><a href="#六-lambda与函数对象的对比" class="headerlink" title="六-lambda与函数对象的对比"></a><a class="markdownIt-Anchor" href="#六-lambda与函数对象的对比"></a> 六、Lambda与函数对象的对比</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs cpp">传统函数对象（仿函数）：<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Adder</span> &#123;<br>    <span class="hljs-type">int</span> value;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">Adder</span>(<span class="hljs-type">int</span> v) : <span class="hljs-built_in">value</span>(v) &#123;&#125;<br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">operator</span><span class="hljs-params">()</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span> <span class="hljs-type">const</span> </span>&#123; <span class="hljs-keyword">return</span> x + value; &#125;<br>&#125;;<br><br><span class="hljs-function">Adder <span class="hljs-title">add5</span><span class="hljs-params">(<span class="hljs-number">5</span>)</span></span>;<br><span class="hljs-type">int</span> result = <span class="hljs-built_in">add5</span>(<span class="hljs-number">10</span>);  <span class="hljs-comment">// 15</span><br>​<br>Lambda（更简洁）：<br><span class="hljs-type">int</span> value = <span class="hljs-number">5</span>;<br><span class="hljs-keyword">auto</span> add5 = [value](<span class="hljs-type">int</span> x) &#123; <span class="hljs-keyword">return</span> x + value; &#125;;<br><span class="hljs-type">int</span> result = <span class="hljs-built_in">add5</span>(<span class="hljs-number">10</span>);  <span class="hljs-comment">// 15</span><br></code></pre></td></tr></table></figure>
<h2 id="七-lambda的高级特性"><a href="#七-lambda的高级特性" class="headerlink" title="七-lambda的高级特性"></a><a class="markdownIt-Anchor" href="#七-lambda的高级特性"></a> 七、Lambda的高级特性</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs cpp">可变Lambda（C+<span class="hljs-number">+11</span>） <span class="hljs-keyword">mutable</span><br><span class="hljs-type">int</span> counter = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">auto</span> incrementer = [counter]() <span class="hljs-keyword">mutable</span> &#123;<br>    counter++;  <span class="hljs-comment">// ✅ 现在可以修改捕获的副本</span><br>    <span class="hljs-keyword">return</span> counter;<br>&#125;;<br><br>std::cout &lt;&lt; <span class="hljs-built_in">incrementer</span>() &lt;&lt; std::endl;  <span class="hljs-comment">// 1</span><br>std::cout &lt;&lt; <span class="hljs-built_in">incrementer</span>() &lt;&lt; std::endl;  <span class="hljs-comment">// 2</span><br>std::cout &lt;&lt; <span class="hljs-string">&quot;原始counter: &quot;</span> &lt;&lt; counter &lt;&lt; std::endl;  <span class="hljs-comment">// 0（副本被修改，原值不变）</span><br><br>​<br><span class="hljs-keyword">constexpr</span> Lambda（C+<span class="hljs-number">+17</span>）<br><span class="hljs-comment">// 可以在编译时计算的lambda</span><br><span class="hljs-keyword">constexpr</span> <span class="hljs-keyword">auto</span> square = [](<span class="hljs-type">int</span> n) &#123; <span class="hljs-keyword">return</span> n * n; &#125;;<br><span class="hljs-built_in">static_assert</span>(<span class="hljs-built_in">square</span>(<span class="hljs-number">5</span>) == <span class="hljs-number">25</span>, <span class="hljs-string">&quot;编译时计算&quot;</span>);<br><br><span class="hljs-keyword">constexpr</span> <span class="hljs-type">int</span> result = <span class="hljs-built_in">square</span>(<span class="hljs-number">10</span>);  <span class="hljs-comment">// 编译时计算</span><br><br>​<br>模板Lambda（C+<span class="hljs-number">+20</span>）<br><span class="hljs-comment">// 泛型lambda（C++14起）</span><br><span class="hljs-keyword">auto</span> generic = [](<span class="hljs-keyword">auto</span> a, <span class="hljs-keyword">auto</span> b) &#123; <span class="hljs-keyword">return</span> a + b; &#125;;<br><br><span class="hljs-comment">// C++20：显式模板参数</span><br><span class="hljs-keyword">auto</span> typed = []&lt;<span class="hljs-keyword">typename</span> T&gt;(T a, T b) &#123; <span class="hljs-keyword">return</span> a + b; &#125;;<br><br><span class="hljs-comment">// 使用</span><br>std::cout &lt;&lt; <span class="hljs-built_in">generic</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>) &lt;&lt; std::endl;     <span class="hljs-comment">// 3</span><br>std::cout &lt;&lt; <span class="hljs-built_in">generic</span>(<span class="hljs-number">1.5</span>, <span class="hljs-number">2.5</span>) &lt;&lt; std::endl; <span class="hljs-comment">// 4.0</span><br>std::cout &lt;&lt; <span class="hljs-built_in">typed</span>(<span class="hljs-number">3</span>, <span class="hljs-number">4</span>) &lt;&lt; std::endl;       <span class="hljs-comment">// 7</span><br><br>​<br>在成员函数中使用 [<span class="hljs-keyword">this</span>]<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span> &#123;<br>    <span class="hljs-type">int</span> value = <span class="hljs-number">42</span>;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">process</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-comment">// 捕获this指针</span><br>        <span class="hljs-keyword">auto</span> lambda = [<span class="hljs-keyword">this</span>]() &#123;<br>            std::cout &lt;&lt; <span class="hljs-string">&quot;value: &quot;</span> &lt;&lt; value &lt;&lt; std::endl;  <span class="hljs-comment">// 访问成员</span><br>            value = <span class="hljs-number">100</span>;  <span class="hljs-comment">// 修改成员</span><br>        &#125;;<br>        <span class="hljs-built_in">lambda</span>();<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<p>​</p>
<h2 id="八-常见陷阱和最佳实践"><a href="#八-常见陷阱和最佳实践" class="headerlink" title="八-常见陷阱和最佳实践"></a><a class="markdownIt-Anchor" href="#八-常见陷阱和最佳实践"></a> 八、常见陷阱和最佳实践</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs cpp">陷阱<span class="hljs-number">1</span>：悬挂引用<br><span class="hljs-function">std::function&lt;<span class="hljs-title">int</span><span class="hljs-params">()</span>&gt; <span class="hljs-title">create_bad_lambda</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-type">int</span> local = <span class="hljs-number">42</span>;<br>    <span class="hljs-keyword">return</span> [&amp;local]() &#123; <span class="hljs-keyword">return</span> local; &#125;;  <span class="hljs-comment">// ❌ 危险！返回后local被销毁</span><br>&#125;<br><br><span class="hljs-comment">// 正确：值捕获</span><br><span class="hljs-function">std::function&lt;<span class="hljs-title">int</span><span class="hljs-params">()</span>&gt; <span class="hljs-title">create_good_lambda</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-type">int</span> local = <span class="hljs-number">42</span>;<br>    <span class="hljs-keyword">return</span> [local]() &#123; <span class="hljs-keyword">return</span> local; &#125;;  <span class="hljs-comment">// ✅ 安全</span><br>&#125;<br><br>​<br>陷阱<span class="hljs-number">2</span>：默认捕获的隐患<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Resource</span> &#123;<br>    std::vector&lt;<span class="hljs-type">int</span>&gt; data;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">auto</span> <span class="hljs-title">get_processor</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-comment">// ❌ 不好：隐式引用捕获[&amp;]可能捕获不想要的变量</span><br>        <span class="hljs-keyword">return</span> [&amp;]() &#123; <span class="hljs-keyword">return</span> data.<span class="hljs-built_in">size</span>(); &#125;;<br><br>        <span class="hljs-comment">// ✅ 更好：显式指定要捕获的</span><br>        <span class="hljs-keyword">return</span> [<span class="hljs-keyword">this</span>]() &#123; <span class="hljs-keyword">return</span> data.<span class="hljs-built_in">size</span>(); &#125;;<br>    &#125;<br>&#125;;<br><br>​<br>最佳实践：<br><span class="hljs-comment">// 1. 尽量使用值捕获，除非需要修改外部变量</span><br><span class="hljs-keyword">auto</span> safe_lambda = [x]() &#123; <span class="hljs-keyword">return</span> x * <span class="hljs-number">2</span>; &#125;;  <span class="hljs-comment">// 值捕获</span><br><br><span class="hljs-comment">// 2. 避免[&amp;]和[=]的隐式捕获，显式列出需要捕获的变量</span><br><span class="hljs-keyword">auto</span> explicit_lambda = [&amp;counter, data]() &#123; <span class="hljs-comment">/* ... */</span> &#125;;  <span class="hljs-comment">// 明确</span><br><br><span class="hljs-comment">// 3. 小心生命周期</span><br><span class="hljs-comment">//    返回的lambda不要捕获局部变量的引用</span><br><br><span class="hljs-comment">// 4. 简单逻辑用lambda，复杂逻辑考虑单独函数</span><br></code></pre></td></tr></table></figure>
<h1 id="智能指针"><a href="#智能指针" class="headerlink" title="智能指针"></a><a class="markdownIt-Anchor" href="#智能指针"></a> 智能指针</h1>
<h2 id="一-为什么需要智能指针"><a href="#一-为什么需要智能指针" class="headerlink" title="一-为什么需要智能指针"></a><a class="markdownIt-Anchor" href="#一-为什么需要智能指针"></a> 一、为什么需要智能指针？</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs cpp">传统指针的问题<br><span class="hljs-comment">// ❌ 问题1：内存泄漏</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">bad_function</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-type">int</span>* ptr = <span class="hljs-keyword">new</span> <span class="hljs-built_in">int</span>(<span class="hljs-number">100</span>);  <span class="hljs-comment">// 分配内存</span><br>    <span class="hljs-keyword">if</span> (error_occurred) &#123;<br>        <span class="hljs-keyword">return</span>;  <span class="hljs-comment">// ⚠️ 忘记delete！内存泄漏！</span><br>    &#125;<br>    <span class="hljs-keyword">delete</span> ptr;  <span class="hljs-comment">// 可能执行不到这里</span><br>&#125;<br><br><span class="hljs-comment">// ❌ 问题2：重复释放</span><br><span class="hljs-type">int</span>* p1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">int</span>(<span class="hljs-number">10</span>);<br><span class="hljs-type">int</span>* p2 = p1;      <span class="hljs-comment">// 两个指针指向同一内存</span><br><span class="hljs-keyword">delete</span> p1;         <span class="hljs-comment">// 释放一次</span><br><span class="hljs-keyword">delete</span> p2;         <span class="hljs-comment">// ⚠️ 再次释放！程序崩溃！</span><br><br><span class="hljs-comment">// ❌ 问题3：空悬指针</span><br><span class="hljs-type">int</span>* ptr = <span class="hljs-keyword">new</span> <span class="hljs-built_in">int</span>(<span class="hljs-number">20</span>);<br><span class="hljs-keyword">delete</span> ptr;        <span class="hljs-comment">// 释放内存</span><br>*ptr = <span class="hljs-number">30</span>;         <span class="hljs-comment">// ⚠️ 访问已释放内存！未定义行为！</span><br>​<br>智能指针解决方案<br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;memory&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">safe_function</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">auto</span> ptr = std::<span class="hljs-built_in">make_unique</span>&lt;<span class="hljs-type">int</span>&gt;(<span class="hljs-number">100</span>);  <span class="hljs-comment">// 自动管理内存</span><br>    <span class="hljs-keyword">if</span> (error_occurred) &#123;<br>        <span class="hljs-keyword">return</span>;  <span class="hljs-comment">// ✅ 自动释放内存，无泄漏！</span><br>    &#125;<br>    <span class="hljs-comment">// ✅ 自动在作用域结束时释放</span><br>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="二-三种智能指针对比"><a href="#二-三种智能指针对比" class="headerlink" title="二-三种智能指针对比"></a><a class="markdownIt-Anchor" href="#二-三种智能指针对比"></a> 二、三种智能指针对比</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">类型 所有权 复制行为 使用场景 性能<br>unique_ptr 独占 禁止复制，可移动 单一所有者资源 ⭐⭐⭐⭐⭐ 最快<br>shared_ptr 共享 引用计数，可复制 共享资源，多所有者 ⭐⭐⭐ 中等<br>weak_ptr 弱引用 不增加引用计数 打破循环引用 ⭐⭐⭐⭐ 快<br></code></pre></td></tr></table></figure>
<h2 id="三-unique_ptr独占指针"><a href="#三-unique_ptr独占指针" class="headerlink" title="三-unique_ptr独占指针"></a><a class="markdownIt-Anchor" href="#三-unique_ptr独占指针"></a> 三、unique_ptr（独占指针）</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs cpp">基本用法<br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;memory&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Resource</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">Resource</span>() &#123; std::cout &lt;&lt; <span class="hljs-string">&quot;Resource acquired\\n&quot;</span>; &#125;<br>    ~<span class="hljs-built_in">Resource</span>() &#123; std::cout &lt;&lt; <span class="hljs-string">&quot;Resource destroyed\\n&quot;</span>; &#125;<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">use</span><span class="hljs-params">()</span> </span>&#123; std::cout &lt;&lt; <span class="hljs-string">&quot;Using resource\\n&quot;</span>; &#125;<br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-comment">// 创建unique_ptr（推荐make_unique）</span><br>    <span class="hljs-keyword">auto</span> ptr1 = std::<span class="hljs-built_in">make_unique</span>&lt;Resource&gt;();  <span class="hljs-comment">// C++14</span><br>    ptr1-&gt;<span class="hljs-built_in">use</span>();  <span class="hljs-comment">// 像普通指针一样使用</span><br><br>    <span class="hljs-comment">// 传统方式（不推荐）</span><br>    <span class="hljs-function">std::unique_ptr&lt;Resource&gt; <span class="hljs-title">ptr2</span><span class="hljs-params">(<span class="hljs-keyword">new</span> Resource())</span></span>;<br><br>    <span class="hljs-comment">// unique_ptr不能复制，只能移动</span><br>    <span class="hljs-keyword">auto</span> ptr3 = std::<span class="hljs-built_in">move</span>(ptr1);  <span class="hljs-comment">// ptr1变为nullptr</span><br>    <span class="hljs-keyword">if</span> (!ptr1) &#123;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;ptr1 is now empty\\n&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// 自动在作用域结束时释放</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br>​<br>管理数组<br><span class="hljs-comment">// 管理单个对象（默认）</span><br><span class="hljs-keyword">auto</span> single = std::<span class="hljs-built_in">make_unique</span>&lt;<span class="hljs-type">int</span>&gt;(<span class="hljs-number">42</span>);<br><br><span class="hljs-comment">// 管理数组</span><br><span class="hljs-keyword">auto</span> array = std::<span class="hljs-built_in">make_unique</span>&lt;<span class="hljs-type">int</span>[]&gt;(<span class="hljs-number">10</span>);  <span class="hljs-comment">// 10个int的数组</span><br>array[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;<br>array[<span class="hljs-number">1</span>] = <span class="hljs-number">2</span>;<br><br><span class="hljs-comment">// 传统方式（需要指定删除器）</span><br><span class="hljs-function">std::unique_ptr&lt;<span class="hljs-type">int</span>[]&gt; <span class="hljs-title">arr</span><span class="hljs-params">(<span class="hljs-keyword">new</span> <span class="hljs-type">int</span>[<span class="hljs-number">5</span>]&#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>&#125;)</span></span>;<br>​<br>自定义删除器<br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdio&gt;</span></span><br><br><span class="hljs-comment">// 文件自动关闭</span><br><span class="hljs-keyword">auto</span> file_closer = [](FILE* f) &#123;<br>    <span class="hljs-keyword">if</span> (f) &#123;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;Closing file\\n&quot;</span>;<br>        <span class="hljs-built_in">fclose</span>(f);<br>    &#125;<br>&#125;;<br><br><span class="hljs-function">std::unique_ptr&lt;FILE, <span class="hljs-title">decltype</span><span class="hljs-params">(file_closer)</span>&gt;</span><br><span class="hljs-function">    <span class="hljs-title">filePtr</span><span class="hljs-params">(fopen(<span class="hljs-string">&quot;test.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>), file_closer)</span></span>;<br></code></pre></td></tr></table></figure>
<h2 id="四-shared_ptr共享指针"><a href="#四-shared_ptr共享指针" class="headerlink" title="四-shared_ptr共享指针"></a><a class="markdownIt-Anchor" href="#四-shared_ptr共享指针"></a> 四、shared_ptr（共享指针）</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs cpp">基本用法<br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;memory&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SharedResource</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">SharedResource</span>() &#123; std::cout &lt;&lt; <span class="hljs-string">&quot;Resource created\\n&quot;</span>; &#125;<br>    ~<span class="hljs-built_in">SharedResource</span>() &#123; std::cout &lt;&lt; <span class="hljs-string">&quot;Resource destroyed\\n&quot;</span>; &#125;<br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-comment">// 创建shared_ptr（推荐make_shared）</span><br>    <span class="hljs-keyword">auto</span> ptr1 = std::<span class="hljs-built_in">make_shared</span>&lt;SharedResource&gt;();<br><br>    &#123;<br>        <span class="hljs-comment">// 复制shared_ptr，引用计数+1</span><br>        <span class="hljs-keyword">auto</span> ptr2 = ptr1;  <span class="hljs-comment">// 现在引用计数=2</span><br>        std::cout &lt;&lt; <span class="hljs-string">&quot;Inside block, use_count: &quot;</span><br>                  &lt;&lt; ptr<span class="hljs-number">1.</span><span class="hljs-built_in">use_count</span>() &lt;&lt; std::endl;<br>    &#125;  <span class="hljs-comment">// ptr2销毁，引用计数-1</span><br><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;Outside block, use_count: &quot;</span><br>              &lt;&lt; ptr<span class="hljs-number">1.</span><span class="hljs-built_in">use_count</span>() &lt;&lt; std::endl;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;  <span class="hljs-comment">// 引用计数=0时自动释放</span><br>&#125;<br>​<br>引用计数机制<br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;memory&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">auto</span> sp1 = std::<span class="hljs-built_in">make_shared</span>&lt;<span class="hljs-type">int</span>&gt;(<span class="hljs-number">100</span>);<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;sp1 use_count: &quot;</span> &lt;&lt; sp<span class="hljs-number">1.</span><span class="hljs-built_in">use_count</span>() &lt;&lt; std::endl;  <span class="hljs-comment">// 1</span><br><br>    <span class="hljs-keyword">auto</span> sp2 = sp1;  <span class="hljs-comment">// 复制构造，引用计数+1</span><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;sp1 use_count: &quot;</span> &lt;&lt; sp<span class="hljs-number">1.</span><span class="hljs-built_in">use_count</span>() &lt;&lt; std::endl;  <span class="hljs-comment">// 2</span><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;sp2 use_count: &quot;</span> &lt;&lt; sp<span class="hljs-number">2.</span><span class="hljs-built_in">use_count</span>() &lt;&lt; std::endl;  <span class="hljs-comment">// 2</span><br><br>    sp<span class="hljs-number">1.</span><span class="hljs-built_in">reset</span>();  <span class="hljs-comment">// sp1放弃所有权，引用计数-1</span><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;sp2 use_count: &quot;</span> &lt;&lt; sp<span class="hljs-number">2.</span><span class="hljs-built_in">use_count</span>() &lt;&lt; std::endl;  <span class="hljs-comment">// 1</span><br><br>    <span class="hljs-comment">// sp2离开作用域，引用计数=0，资源释放</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br>​<br>循环引用问题<br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;memory&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    std::shared_ptr&lt;Node&gt; next;<br>    std::shared_ptr&lt;Node&gt; prev;<br><br>    ~<span class="hljs-built_in">Node</span>() &#123; std::cout &lt;&lt; <span class="hljs-string">&quot;Node destroyed\\n&quot;</span>; &#125;<br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-comment">// 创建循环引用</span><br>    <span class="hljs-keyword">auto</span> node1 = std::<span class="hljs-built_in">make_shared</span>&lt;Node&gt;();<br>    <span class="hljs-keyword">auto</span> node2 = std::<span class="hljs-built_in">make_shared</span>&lt;Node&gt;();<br><br>    node1-&gt;next = node2;  <span class="hljs-comment">// node2引用计数=2</span><br>    node2-&gt;prev = node1;  <span class="hljs-comment">// node1引用计数=2</span><br><br>    <span class="hljs-comment">// 程序结束，但内存泄漏！</span><br>    <span class="hljs-comment">// node1引用计数=1 (node2的prev持有)</span><br>    <span class="hljs-comment">// node2引用计数=1 (node1的next持有)</span><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;End of main - memory leak!\\n&quot;</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="五-weak_ptr弱指针"><a href="#五-weak_ptr弱指针" class="headerlink" title="五-weak_ptr弱指针"></a><a class="markdownIt-Anchor" href="#五-weak_ptr弱指针"></a> 五、weak_ptr（弱指针）</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs cpp">解决循环引用<br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;memory&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    std::shared_ptr&lt;Node&gt; next;<br>    std::weak_ptr&lt;Node&gt; prev;  <span class="hljs-comment">// 使用weak_ptr打破循环</span><br><br>    ~<span class="hljs-built_in">Node</span>() &#123; std::cout &lt;&lt; <span class="hljs-string">&quot;Node destroyed\\n&quot;</span>; &#125;<br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">auto</span> node1 = std::<span class="hljs-built_in">make_shared</span>&lt;Node&gt;();<br>    <span class="hljs-keyword">auto</span> node2 = std::<span class="hljs-built_in">make_shared</span>&lt;Node&gt;();<br><br>    node1-&gt;next = node2;      <span class="hljs-comment">// node2引用计数=2</span><br>    node2-&gt;prev = node1;      <span class="hljs-comment">// node1引用计数=1（weak_ptr不增加计数）</span><br><br>    <span class="hljs-comment">// ✅ 没有内存泄漏！</span><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;node1 use_count: &quot;</span> &lt;&lt; node<span class="hljs-number">1.</span><span class="hljs-built_in">use_count</span>() &lt;&lt; std::endl;  <span class="hljs-comment">// 1</span><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;node2 use_count: &quot;</span> &lt;&lt; node<span class="hljs-number">2.</span><span class="hljs-built_in">use_count</span>() &lt;&lt; std::endl;  <span class="hljs-comment">// 2</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;  <span class="hljs-comment">// 正确释放内存</span><br>&#125;<br>​<br>weak_ptr基本操作<br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;memory&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">auto</span> sp = std::<span class="hljs-built_in">make_shared</span>&lt;<span class="hljs-type">int</span>&gt;(<span class="hljs-number">42</span>);<br>    std::weak_ptr&lt;<span class="hljs-type">int</span>&gt; wp = sp;  <span class="hljs-comment">// 创建weak_ptr</span><br><br>    <span class="hljs-comment">// 检查资源是否还存在</span><br>    <span class="hljs-keyword">if</span> (!wp.<span class="hljs-built_in">expired</span>()) &#123;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;Resource still exists\\n&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// 获取shared_ptr（如果资源还存在）</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">auto</span> locked = wp.<span class="hljs-built_in">lock</span>()) &#123;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;Value: &quot;</span> &lt;&lt; *locked &lt;&lt; std::endl;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;use_count: &quot;</span> &lt;&lt; locked.<span class="hljs-built_in">use_count</span>() &lt;&lt; std::endl;  <span class="hljs-comment">// 2</span><br>    &#125;<br><br>    sp.<span class="hljs-built_in">reset</span>();  <span class="hljs-comment">// 释放资源</span><br><br>    <span class="hljs-keyword">if</span> (wp.<span class="hljs-built_in">expired</span>()) &#123;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;Resource has been released\\n&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="六-性能考虑"><a href="#六-性能考虑" class="headerlink" title="六-性能考虑"></a><a class="markdownIt-Anchor" href="#六-性能考虑"></a> 六、性能考虑</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs cpp">make_shared vs <span class="hljs-keyword">new</span> + shared_ptr<br><span class="hljs-comment">// ✅ 推荐：make_shared（一次内存分配）</span><br><span class="hljs-keyword">auto</span> sp1 = std::<span class="hljs-built_in">make_shared</span>&lt;MyClass&gt;(args);<br><br><span class="hljs-comment">// ❌ 不推荐：new + shared_ptr（两次内存分配）</span><br><span class="hljs-keyword">auto</span> sp2 = std::<span class="hljs-built_in">shared_ptr</span>&lt;MyClass&gt;(<span class="hljs-keyword">new</span> <span class="hljs-built_in">MyClass</span>(args));<br><br><span class="hljs-comment">// 原因：</span><br><span class="hljs-comment">// 1. make_shared：对象和控制块一次分配，更快</span><br><span class="hljs-comment">// 2. 异常安全：make_shared保证原子性</span><br><span class="hljs-comment">// 3. 内存局部性更好</span><br>​<br>何时使用哪种智能指针<br><span class="hljs-comment">// 规则1：默认使用unique_ptr</span><br><span class="hljs-comment">// 除非需要共享，否则都用unique_ptr</span><br><span class="hljs-keyword">auto</span> config = std::<span class="hljs-built_in">make_unique</span>&lt;Config&gt;();<br><br><span class="hljs-comment">// 规则2：需要共享时用shared_ptr</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Connection</span> &#123;<br>    <span class="hljs-function"><span class="hljs-type">static</span> std::shared_ptr&lt;Connection&gt; <span class="hljs-title">create</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> std::<span class="hljs-built_in">make_shared</span>&lt;Connection&gt;();<br>    &#125;<br>&#125;;<br><br><span class="hljs-comment">// 规则3：可能循环引用时用weak_ptr</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">TreeNode</span> &#123;<br>    std::shared_ptr&lt;TreeNode&gt; child;<br>    std::weak_ptr&lt;TreeNode&gt; parent;  <span class="hljs-comment">// 父节点用weak_ptr</span><br>&#125;;<br><br><span class="hljs-comment">// 规则4：简单情况用值语义（不要过度使用智能指针）</span><br><span class="hljs-comment">// 能用栈变量就不用堆分配</span><br>std::vector&lt;<span class="hljs-type">int</span>&gt; data;  <span class="hljs-comment">// 直接用，不要vector&lt;unique_ptr&lt;int&gt;&gt;</span><br></code></pre></td></tr></table></figure>
<h2 id="八-常见错误和陷阱"><a href="#八-常见错误和陷阱" class="headerlink" title="八-常见错误和陷阱"></a><a class="markdownIt-Anchor" href="#八-常见错误和陷阱"></a> 八、常见错误和陷阱</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs cpp">错误<span class="hljs-number">1</span>：混用智能指针和裸指针<br><span class="hljs-comment">// ❌ 错误：智能指针和裸指针混用</span><br><span class="hljs-type">int</span>* raw_ptr = <span class="hljs-keyword">new</span> <span class="hljs-built_in">int</span>(<span class="hljs-number">100</span>);<br><span class="hljs-function">std::shared_ptr&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">sp1</span><span class="hljs-params">(raw_ptr)</span></span>;<br><span class="hljs-function">std::shared_ptr&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">sp2</span><span class="hljs-params">(raw_ptr)</span></span>;  <span class="hljs-comment">// ⚠️ 双重释放！</span><br><br><span class="hljs-comment">// ✅ 正确：始终从make_shared开始</span><br><span class="hljs-keyword">auto</span> sp1 = std::<span class="hljs-built_in">make_shared</span>&lt;<span class="hljs-type">int</span>&gt;(<span class="hljs-number">100</span>);<br><span class="hljs-keyword">auto</span> sp2 = sp1;  <span class="hljs-comment">// 共享所有权</span><br>​<br>错误<span class="hljs-number">2</span>：误用<span class="hljs-built_in">get</span>()获取的裸指针<br><span class="hljs-keyword">auto</span> sp = std::<span class="hljs-built_in">make_shared</span>&lt;<span class="hljs-type">int</span>&gt;(<span class="hljs-number">42</span>);<br><span class="hljs-type">int</span>* raw = sp.<span class="hljs-built_in">get</span>();  <span class="hljs-comment">// 获取内部裸指针</span><br><br><span class="hljs-comment">// ❌ 错误：用raw指针创建新的智能指针</span><br><span class="hljs-function">std::shared_ptr&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">sp2</span><span class="hljs-params">(raw)</span></span>;  <span class="hljs-comment">// ⚠️ 双重管理！</span><br><br><span class="hljs-comment">// ❌ 错误：删除get()返回的指针</span><br><span class="hljs-keyword">delete</span> sp.<span class="hljs-built_in">get</span>();  <span class="hljs-comment">// ⚠️ 智能指针会再次删除！</span><br><br><span class="hljs-comment">// ✅ 正确：只用get()进行只读操作</span><br><span class="hljs-type">int</span> value = *sp.<span class="hljs-built_in">get</span>();  <span class="hljs-comment">// 只读取值</span><br><span class="hljs-built_in">some_c_api</span>(sp.<span class="hljs-built_in">get</span>());   <span class="hljs-comment">// 传给只使用不管理的C函数</span><br>​<br>错误<span class="hljs-number">3</span>：错误的删除器<br><span class="hljs-comment">// ❌ 错误：数组用默认删除器</span><br><span class="hljs-function">std::shared_ptr&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">arr</span><span class="hljs-params">(<span class="hljs-keyword">new</span> <span class="hljs-type">int</span>[<span class="hljs-number">10</span>])</span></span>;  <span class="hljs-comment">// ⚠️ 应该用delete[]</span><br><br><span class="hljs-comment">// ✅ 正确：数组用正确的删除器</span><br><span class="hljs-function">std::shared_ptr&lt;<span class="hljs-type">int</span>[]&gt; <span class="hljs-title">arr</span><span class="hljs-params">(<span class="hljs-keyword">new</span> <span class="hljs-type">int</span>[<span class="hljs-number">10</span>])</span></span>;  <span class="hljs-comment">// C++17</span><br><span class="hljs-comment">// 或</span><br><span class="hljs-function">std::shared_ptr&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">arr</span><span class="hljs-params">(<span class="hljs-keyword">new</span> <span class="hljs-type">int</span>[<span class="hljs-number">10</span>], std::default_delete&lt;<span class="hljs-type">int</span>[]&gt;())</span></span>;<br></code></pre></td></tr></table></figure>
<h2 id="九-最佳实践总结"><a href="#九-最佳实践总结" class="headerlink" title="九-最佳实践总结"></a><a class="markdownIt-Anchor" href="#九-最佳实践总结"></a> 九、最佳实践总结</h2>
<p>黄金法则</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 1. 优先使用栈对象，其次unique_ptr，最后shared_ptr</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">process</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-type">int</span> local = <span class="hljs-number">10</span>;                    <span class="hljs-comment">// 栈对象（最快）</span><br>    <span class="hljs-keyword">auto</span> unique = std::<span class="hljs-built_in">make_unique</span>&lt;Resource&gt;();  <span class="hljs-comment">// 独占资源</span><br>    <span class="hljs-keyword">auto</span> shared = std::<span class="hljs-built_in">make_shared</span>&lt;SharedResource&gt;();  <span class="hljs-comment">// 共享资源</span><br>&#125;<br><br><span class="hljs-comment">// 2. 使用make_unique/make_shared，不要用new</span><br><span class="hljs-keyword">auto</span> ptr = std::<span class="hljs-built_in">make_unique</span>&lt;MyClass&gt;();  <span class="hljs-comment">// ✅</span><br><span class="hljs-keyword">auto</span> ptr = std::<span class="hljs-built_in">unique_ptr</span>&lt;MyClass&gt;(<span class="hljs-keyword">new</span> <span class="hljs-built_in">MyClass</span>());  <span class="hljs-comment">// ❌</span><br><br><span class="hljs-comment">// 3. 传递智能指针时考虑所有权语义</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">take_ownership</span><span class="hljs-params">(std::unique_ptr&lt;Data&gt; data)</span></span>;  <span class="hljs-comment">// 接收所有权</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">share_ownership</span><span class="hljs-params">(std::shared_ptr&lt;Data&gt; data)</span></span>;  <span class="hljs-comment">// 共享所有权</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">observe</span><span class="hljs-params">(std::weak_ptr&lt;Data&gt; data)</span></span>;  <span class="hljs-comment">// 观察，不拥有</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">use_only</span><span class="hljs-params">(<span class="hljs-type">const</span> Data* data)</span></span>;  <span class="hljs-comment">// 只使用，不管理</span><br><br><span class="hljs-comment">// 4. 避免循环引用，父节点用weak_ptr</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span> &#123;<br>    std::shared_ptr&lt;Node&gt; child;<br>    std::weak_ptr&lt;Node&gt; parent;  <span class="hljs-comment">// 打破循环</span><br>&#125;;<br></code></pre></td></tr></table></figure>
<h1 id="链表"><a href="#链表" class="headerlink" title="链表"></a><a class="markdownIt-Anchor" href="#链表"></a> 链表</h1>
<h2 id="一-核心概念什么是链表"><a href="#一-核心概念什么是链表" class="headerlink" title="一-核心概念什么是链表"></a><a class="markdownIt-Anchor" href="#一-核心概念什么是链表"></a> 一、核心概念：什么是链表？</h2>
<p>链表 vs 数组（vector）内存对比</p>
<p>数组（vector）：连续内存<br />
[元素1][元素2][元素3][元素4][    ]<br />
↑ 所有元素挨在一起</p>
<p>链表：非连续内存（指针连接）<br />
[数据1|next] → [数据2|next] → [数据3|next] → nullptr<br />
↑             ↑               ↑<br />
堆地址A       堆地址B          堆地址C（完全不连续！）<br />
​<br />
链表的本质：<br />
// 每个节点 = 数据 + 指针</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ListNode</span> &#123;<br>    <span class="hljs-type">int</span> data;           <span class="hljs-comment">// 数据部分</span><br>    ListNode* next;     <span class="hljs-comment">// 指向下一个节点的指针</span><br><br>    <span class="hljs-built_in">ListNode</span>(<span class="hljs-type">int</span> val) : <span class="hljs-built_in">data</span>(val), <span class="hljs-built_in">next</span>(<span class="hljs-literal">nullptr</span>) &#123;&#125;<br>&#125;;<br><br><span class="hljs-comment">// 双向链表节点</span><br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">DoublyListNode</span> &#123;<br>    <span class="hljs-type">int</span> data;<br>    DoublyListNode* prev;  <span class="hljs-comment">// 指向前一个节点</span><br>    DoublyListNode* next;  <span class="hljs-comment">// 指向后一个节点</span><br>&#125;;<br></code></pre></td></tr></table></figure>
<h2 id="二-stl中的链表工作中实际用的"><a href="#二-stl中的链表工作中实际用的" class="headerlink" title="二-stl中的链表工作中实际用的"></a><a class="markdownIt-Anchor" href="#二-stl中的链表工作中实际用的"></a> 二、STL中的链表（工作中实际用的）</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><code class="hljs cpp">std::list（双向链表）<br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;list&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-comment">// 创建和初始化</span><br>    std::list&lt;<span class="hljs-type">int</span>&gt; lst1;                    <span class="hljs-comment">// 空链表</span><br>    std::list&lt;<span class="hljs-type">int</span>&gt; lst2 = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>&#125;;  <span class="hljs-comment">// 初始值</span><br>    <span class="hljs-function">std::list&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">lst3</span><span class="hljs-params">(<span class="hljs-number">10</span>, <span class="hljs-number">42</span>)</span></span>;            <span class="hljs-comment">// 10个42</span><br><br>    <span class="hljs-comment">// 🔥 核心操作（都是O(1)复杂度）</span><br><br>    <span class="hljs-comment">// 插入</span><br>    lst<span class="hljs-number">1.</span><span class="hljs-built_in">push_front</span>(<span class="hljs-number">0</span>);       <span class="hljs-comment">// 头部插入：0</span><br>    lst<span class="hljs-number">1.</span><span class="hljs-built_in">push_back</span>(<span class="hljs-number">1</span>);        <span class="hljs-comment">// 尾部插入：0→1</span><br>    <span class="hljs-keyword">auto</span> it = lst<span class="hljs-number">1.</span><span class="hljs-built_in">begin</span>();<br>    ++it;                     <span class="hljs-comment">// 移动到第二个位置</span><br>    lst<span class="hljs-number">1.</span><span class="hljs-built_in">insert</span>(it, <span class="hljs-number">99</span>);      <span class="hljs-comment">// 中间插入：0→99→1</span><br><br>    <span class="hljs-comment">// 删除</span><br>    lst<span class="hljs-number">1.</span><span class="hljs-built_in">pop_front</span>();         <span class="hljs-comment">// 删除头部：99→1</span><br>    lst<span class="hljs-number">1.</span><span class="hljs-built_in">pop_back</span>();          <span class="hljs-comment">// 删除尾部：99</span><br>    lst<span class="hljs-number">1.</span><span class="hljs-built_in">erase</span>(lst<span class="hljs-number">1.</span><span class="hljs-built_in">begin</span>()); <span class="hljs-comment">// 删除指定位置</span><br><br>    <span class="hljs-comment">// 访问（链表不能随机访问！）</span><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;第一个元素: &quot;</span> &lt;&lt; lst<span class="hljs-number">2.f</span>ront() &lt;&lt; std::endl;  <span class="hljs-comment">// 1</span><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;最后一个元素: &quot;</span> &lt;&lt; lst<span class="hljs-number">2.</span><span class="hljs-built_in">back</span>() &lt;&lt; std::endl; <span class="hljs-comment">// 5</span><br><br>    <span class="hljs-comment">// 遍历（只能用迭代器）</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> it = lst<span class="hljs-number">2.</span><span class="hljs-built_in">begin</span>(); it != lst<span class="hljs-number">2.</span><span class="hljs-built_in">end</span>(); ++it) &#123;<br>        std::cout &lt;&lt; *it &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;  <span class="hljs-comment">// 1 2 3 4 5</span><br>    &#125;<br>    <span class="hljs-comment">// 或范围for</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> val : lst2) &#123;<br>        std::cout &lt;&lt; val &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// 其他有用操作</span><br>    lst<span class="hljs-number">2.</span><span class="hljs-built_in">sort</span>();               <span class="hljs-comment">// 排序 O(n log n)</span><br>    lst<span class="hljs-number">2.</span><span class="hljs-built_in">unique</span>();             <span class="hljs-comment">// 删除连续重复元素</span><br>    lst<span class="hljs-number">2.</span><span class="hljs-built_in">reverse</span>();            <span class="hljs-comment">// 反转链表 O(n)</span><br><br>    <span class="hljs-comment">// 合并链表（拼接，不是合并排序）</span><br>    std::list&lt;<span class="hljs-type">int</span>&gt; lstA = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>&#125;;<br>    std::list&lt;<span class="hljs-type">int</span>&gt; lstB = &#123;<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>&#125;;<br>    lstA.<span class="hljs-built_in">splice</span>(lstA.<span class="hljs-built_in">end</span>(), lstB);  <span class="hljs-comment">// lstA: 1,2,3,4,5,6</span><br>                                    <span class="hljs-comment">// lstB变为空！</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br>​<br>std::forward_list（单向链表，C+<span class="hljs-number">+11</span>）<br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;forward_list&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    std::forward_list&lt;<span class="hljs-type">int</span>&gt; flist = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>&#125;;<br><br>    <span class="hljs-comment">// 单向链表特点：</span><br>    <span class="hljs-comment">// 1. 只有push_front，没有push_back！</span><br>    <span class="hljs-comment">// 2. 更省内存（每个节点少</span><br><br>    <span class="hljs-comment">// 遍历一样</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> n : flist) &#123;<br>        std::cout &lt;&lt; n &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;  <span class="hljs-comment">// 0 1 2 3 4 5</span><br>    &#125;<br><br>    <span class="hljs-comment">// 删除下一个元素（因为单向，要知道前一个节点）</span><br>    <span class="hljs-keyword">auto</span> it = flist.<span class="hljs-built_in">begin</span>();<br>    ++it;  <span class="hljs-comment">// 指向第二个元素</span><br>    flist.<span class="hljs-built_in">erase_after</span>(flist.<span class="hljs-built_in">begin</span>());  <span class="hljs-comment">// 删除第二个元素</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="三-手动实现链表"><a href="#三-手动实现链表" class="headerlink" title="三-手动实现链表"></a><a class="markdownIt-Anchor" href="#三-手动实现链表"></a> 三、手动实现链表</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><code class="hljs cpp">单向链表基本实现<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleLinkedList</span> &#123;<br><span class="hljs-keyword">private</span>:<br>    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">Node</span> &#123;<br>        <span class="hljs-type">int</span> data;<br>        Node* next;<br>        <span class="hljs-built_in">Node</span>(<span class="hljs-type">int</span> val) : <span class="hljs-built_in">data</span>(val), <span class="hljs-built_in">next</span>(<span class="hljs-literal">nullptr</span>) &#123;&#125;<br>    &#125;;<br><br>    Node* head;<br>    Node* tail;<br>    <span class="hljs-type">int</span> size;<br><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">SimpleLinkedList</span>() : <span class="hljs-built_in">head</span>(<span class="hljs-literal">nullptr</span>), <span class="hljs-built_in">tail</span>(<span class="hljs-literal">nullptr</span>), <span class="hljs-built_in">size</span>(<span class="hljs-number">0</span>) &#123;&#125;<br><br>    ~<span class="hljs-built_in">SimpleLinkedList</span>() &#123;<br>        <span class="hljs-comment">// 必须手动释放所有节点！</span><br>        Node* current = head;<br>        <span class="hljs-keyword">while</span> (current) &#123;<br>            Node* next = current-&gt;next;<br>            <span class="hljs-keyword">delete</span> current;<br>            current = next;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// 在尾部添加</span><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">append</span><span class="hljs-params">(<span class="hljs-type">int</span> val)</span> </span>&#123;<br>        Node* newNode = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Node</span>(val);<br>        <span class="hljs-keyword">if</span> (!head) &#123;<br>            head = tail = newNode;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            tail-&gt;next = newNode;<br>            tail = newNode;<br>        &#125;<br>        size++;<br>    &#125;<br><br>    <span class="hljs-comment">// 在头部添加</span><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">prepend</span><span class="hljs-params">(<span class="hljs-type">int</span> val)</span> </span>&#123;<br>        Node* newNode = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Node</span>(val);<br>        newNode-&gt;next = head;<br>        head = newNode;<br>        <span class="hljs-keyword">if</span> (!tail) tail = head;<br>        size++;<br>    &#125;<br><br>    <span class="hljs-comment">// 打印链表</span><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">print</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>&#123;<br>        Node* current = head;<br>        <span class="hljs-keyword">while</span> (current) &#123;<br>            std::cout &lt;&lt; current-&gt;data;<br>            <span class="hljs-keyword">if</span> (current-&gt;next) std::cout &lt;&lt; <span class="hljs-string">&quot; -&gt; &quot;</span>;<br>            current = current-&gt;next;<br>        &#125;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot; -&gt; nullptr&quot;</span> &lt;&lt; std::endl;<br>    &#125;<br><br>    <span class="hljs-comment">// 反转链表（面试常考！）</span><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">reverse</span><span class="hljs-params">()</span> </span>&#123;<br>        Node* prev = <span class="hljs-literal">nullptr</span>;<br>        Node* current = head;<br>        tail = head;  <span class="hljs-comment">// 头变尾</span><br><br>        <span class="hljs-keyword">while</span> (current) &#123;<br>            Node* next = current-&gt;next;<br>            current-&gt;next = prev;<br>            prev = current;<br>            current = next;<br>        &#125;<br>        head = prev;  <span class="hljs-comment">// 新的头</span><br>    &#125;<br><br>    <span class="hljs-comment">// 查找</span><br>    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">contains</span><span class="hljs-params">(<span class="hljs-type">int</span> val)</span> <span class="hljs-type">const</span> </span>&#123;<br>        Node* current = head;<br>        <span class="hljs-keyword">while</span> (current) &#123;<br>            <span class="hljs-keyword">if</span> (current-&gt;data == val) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>            current = current-&gt;next;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;;<br><br><span class="hljs-comment">// 使用</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    SimpleLinkedList list;<br>    list.<span class="hljs-built_in">append</span>(<span class="hljs-number">1</span>);<br>    list.<span class="hljs-built_in">append</span>(<span class="hljs-number">2</span>);<br>    list.<span class="hljs-built_in">append</span>(<span class="hljs-number">3</span>);<br>    list.<span class="hljs-built_in">prepend</span>(<span class="hljs-number">0</span>);<br><br>    list.<span class="hljs-built_in">print</span>();  <span class="hljs-comment">// 0 -&gt; 1 -&gt; 2 -&gt; 3 -&gt; nullptr</span><br><br>    list.<span class="hljs-built_in">reverse</span>();<br>    list.<span class="hljs-built_in">print</span>();  <span class="hljs-comment">// 3 -&gt; 2 -&gt; 1 -&gt; 0 -&gt; nullptr</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="四-链表经典题必须掌握"><a href="#四-链表经典题必须掌握" class="headerlink" title="四-链表经典题必须掌握"></a><a class="markdownIt-Anchor" href="#四-链表经典题必须掌握"></a> 四、链表经典题（必须掌握）</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><code class="hljs cpp">反转链表<br><span class="hljs-function">ListNode* <span class="hljs-title">reverseList</span><span class="hljs-params">(ListNode* head)</span> </span>&#123;<br>    ListNode* prev = <span class="hljs-literal">nullptr</span>;<br>    ListNode* curr = head;<br>    <span class="hljs-keyword">while</span> (curr) &#123;<br>        ListNode* next = curr-&gt;next;<br>        curr-&gt;next = prev;<br>        prev = curr;<br>        curr = next;<br>    &#125;<br>    <span class="hljs-keyword">return</span> prev;<br>&#125;<br>​<br>检测环（快慢指针）<br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">hasCycle</span><span class="hljs-params">(ListNode* head)</span> </span>&#123;<br>    <span class="hljs-keyword">if</span> (!head || !head-&gt;next) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br><br>    ListNode* slow = head;<br>    ListNode* fast = head-&gt;next;<br><br>    <span class="hljs-keyword">while</span> (slow != fast) &#123;<br>        <span class="hljs-keyword">if</span> (!fast || !fast-&gt;next) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        slow = slow-&gt;next;<br>        fast = fast-&gt;next-&gt;next;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br>​<br>合并两个有序链表<br><span class="hljs-function">ListNode* <span class="hljs-title">mergeTwoLists</span><span class="hljs-params">(ListNode* l1, ListNode* l2)</span> </span>&#123;<br>    <span class="hljs-function">ListNode <span class="hljs-title">dummy</span><span class="hljs-params">(<span class="hljs-number">0</span>)</span></span>;<br>    ListNode* tail = &amp;dummy;<br><br>    <span class="hljs-keyword">while</span> (l1 &amp;&amp; l2) &#123;<br>        <span class="hljs-keyword">if</span> (l1-&gt;val &lt; l2-&gt;val) &#123;<br>            tail-&gt;next = l1;<br>            l1 = l1-&gt;next;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            tail-&gt;next = l2;<br>            l2 = l2-&gt;next;<br>        &#125;<br>        tail = tail-&gt;next;<br>    &#125;<br><br>    tail-&gt;next = l1 ? l1 : l2;<br>    <span class="hljs-keyword">return</span> dummy.next;<br>&#125;<br>​<br>删除倒数第N个节点<br><span class="hljs-function">ListNode* <span class="hljs-title">removeNthFromEnd</span><span class="hljs-params">(ListNode* head, <span class="hljs-type">int</span> n)</span> </span>&#123;<br>    <span class="hljs-function">ListNode <span class="hljs-title">dummy</span><span class="hljs-params">(<span class="hljs-number">0</span>)</span></span>;<br>    dummy.next = head;<br><br>    ListNode* fast = &amp;dummy;<br>    ListNode* slow = &amp;dummy;<br><br>    <span class="hljs-comment">// fast先走n步</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt;= n; ++i) &#123;<br>        fast = fast-&gt;next;<br>    &#125;<br><br>    <span class="hljs-comment">// 一起走到fast到末尾</span><br>    <span class="hljs-keyword">while</span> (fast) &#123;<br>        fast = fast-&gt;next;<br>        slow = slow-&gt;next;<br>    &#125;<br><br>    <span class="hljs-comment">// 删除slow的下一个节点</span><br>    ListNode* to_delete = slow-&gt;next;<br>    slow-&gt;next = slow-&gt;next-&gt;next;<br>    <span class="hljs-keyword">delete</span> to_delete;<br><br>    <span class="hljs-keyword">return</span> dummy.next;<br>&#125;<br></code></pre></td></tr></table></figure>
<h1 id="继承多态"><a href="#继承多态" class="headerlink" title="继承多态"></a><a class="markdownIt-Anchor" href="#继承多态"></a> 继承&amp;多态</h1>
<h2 id="一-继承基础"><a href="#一-继承基础" class="headerlink" title="一-继承基础"></a><a class="markdownIt-Anchor" href="#一-继承基础"></a> 一、继承基础</h2>
<p>三种继承方式</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Base</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-type">int</span> public_var;<br><span class="hljs-keyword">protected</span>:<br>    <span class="hljs-type">int</span> protected_var;<br><span class="hljs-keyword">private</span>:<br>    <span class="hljs-type">int</span> private_var;<br>&#125;;<br><br><span class="hljs-comment">// 公有继承（最常用）：保持原有访问权限</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">PublicDerived</span> : <span class="hljs-keyword">public</span> Base &#123;<br>    <span class="hljs-comment">// public_var 仍是 public</span><br>    <span class="hljs-comment">// protected_var 仍是 protected</span><br>    <span class="hljs-comment">// private_var 不可访问</span><br>&#125;;<br><br><span class="hljs-comment">// 保护继承：public降级为protected</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ProtectedDerived</span> : <span class="hljs-keyword">protected</span> Base &#123;<br>    <span class="hljs-comment">// public_var 变为 protected</span><br>    <span class="hljs-comment">// protected_var 仍是 protected</span><br>    <span class="hljs-comment">// private_var 不可访问</span><br>&#125;;<br><br><span class="hljs-comment">// 私有继承：全部变为private</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">PrivateDerived</span> : <span class="hljs-keyword">private</span> Base &#123;<br>    <span class="hljs-comment">// public_var 变为 private</span><br>    <span class="hljs-comment">// protected_var 变为 private</span><br>    <span class="hljs-comment">// private_var 不可访问</span><br>&#125;;<br></code></pre></td></tr></table></figure>
<p>构造和析构顺序</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Base</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">Base</span>() &#123; cout &lt;&lt; <span class="hljs-string">&quot;Base构造&quot;</span> &lt;&lt; endl; &#125;<br>    ~<span class="hljs-built_in">Base</span>() &#123; cout &lt;&lt; <span class="hljs-string">&quot;Base析构&quot;</span> &lt;&lt; endl; &#125;<br>&#125;;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Derived</span> : <span class="hljs-keyword">public</span> Base &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">Derived</span>() &#123; cout &lt;&lt; <span class="hljs-string">&quot;Derived构造&quot;</span> &lt;&lt; endl; &#125;<br>    ~<span class="hljs-built_in">Derived</span>() &#123; cout &lt;&lt; <span class="hljs-string">&quot;Derived析构&quot;</span> &lt;&lt; endl; &#125;<br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    Derived d;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-comment">// 输出：</span><br><span class="hljs-comment">// Base构造</span><br><span class="hljs-comment">// Derived构造</span><br><span class="hljs-comment">// Derived析构</span><br><span class="hljs-comment">// Base析构</span><br><span class="hljs-comment">// 构造：先父后子，析构：先子后父</span><br>​<br>初始化列表调用父类构造<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Base</span> &#123;<br>    <span class="hljs-type">int</span> value;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">Base</span>(<span class="hljs-type">int</span> v) : <span class="hljs-built_in">value</span>(v) &#123;&#125;<br>&#125;;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Derived</span> : <span class="hljs-keyword">public</span> Base &#123;<br>    <span class="hljs-type">int</span> extra;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-comment">// 必须初始化父类</span><br>    <span class="hljs-built_in">Derived</span>(<span class="hljs-type">int</span> v, <span class="hljs-type">int</span> e) : <span class="hljs-built_in">Base</span>(v), <span class="hljs-built_in">extra</span>(e) &#123;&#125;<br><br>    <span class="hljs-comment">// 错误：没有调用Base构造</span><br>    <span class="hljs-comment">// Derived(int v, int e) &#123; extra = e; &#125; ❌</span><br>&#125;;<br></code></pre></td></tr></table></figure>
<h2 id="二-函数重写与隐藏"><a href="#二-函数重写与隐藏" class="headerlink" title="二-函数重写与隐藏"></a><a class="markdownIt-Anchor" href="#二-函数重写与隐藏"></a> 二、函数重写与隐藏</h2>
<p>函数隐藏（不是多态！）</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Base</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">func</span><span class="hljs-params">()</span> </span>&#123; cout &lt;&lt; <span class="hljs-string">&quot;Base::func&quot;</span> &lt;&lt; endl; &#125;<br>&#125;;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Derived</span> : <span class="hljs-keyword">public</span> Base &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">func</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span> </span>&#123; cout &lt;&lt; <span class="hljs-string">&quot;Derived::func&quot;</span> &lt;&lt; endl; &#125; <span class="hljs-comment">// 隐藏了Base::func</span><br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    Derived d;<br>    d.<span class="hljs-built_in">func</span>(<span class="hljs-number">1</span>);      <span class="hljs-comment">// ✅ 调用Derived::func</span><br>    <span class="hljs-comment">// d.func();    // ❌ 错误！Base::func被隐藏</span><br>    d.Base::<span class="hljs-built_in">func</span>(); <span class="hljs-comment">// ✅ 指定调用父类的</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br>​<br>使用<span class="hljs-keyword">using</span>恢复隐藏函数<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Base</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">func</span><span class="hljs-params">()</span> </span>&#123; cout &lt;&lt; <span class="hljs-string">&quot;Base::func&quot;</span> &lt;&lt; endl; &#125;<br>&#125;;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Derived</span> : <span class="hljs-keyword">public</span> Base &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-keyword">using</span> Base::func;  <span class="hljs-comment">// 恢复Base::func</span><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">func</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span> </span>&#123; cout &lt;&lt; <span class="hljs-string">&quot;Derived::func&quot;</span> &lt;&lt; endl; &#125;<br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    Derived d;<br>    d.<span class="hljs-built_in">func</span>();    <span class="hljs-comment">// ✅ 现在可以调用</span><br>    d.<span class="hljs-built_in">func</span>(<span class="hljs-number">1</span>);   <span class="hljs-comment">// ✅ 也可以调用</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="三-多态基础"><a href="#三-多态基础" class="headerlink" title="三-多态基础"></a><a class="markdownIt-Anchor" href="#三-多态基础"></a> 三、多态基础</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs cpp">虚函数与<span class="hljs-keyword">override</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">speak</span><span class="hljs-params">()</span> </span>&#123; cout &lt;&lt; <span class="hljs-string">&quot;动物叫&quot;</span> &lt;&lt; endl; &#125;  <span class="hljs-comment">// 虚函数</span><br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">eat</span><span class="hljs-params">()</span> </span>= <span class="hljs-number">0</span>;  <span class="hljs-comment">// 纯虚函数，抽象类</span><br><br>    <span class="hljs-comment">// 虚析构函数（多态基类必须！）</span><br>    <span class="hljs-keyword">virtual</span> ~<span class="hljs-built_in">Animal</span>() &#123; cout &lt;&lt; <span class="hljs-string">&quot;~Animal&quot;</span> &lt;&lt; endl; &#125;<br>&#125;;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span> : <span class="hljs-keyword">public</span> Animal &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">speak</span><span class="hljs-params">()</span> <span class="hljs-keyword">override</span> </span>&#123;  <span class="hljs-comment">// C++11: override确保正确重写</span><br>        cout &lt;&lt; <span class="hljs-string">&quot;汪汪&quot;</span> &lt;&lt; endl;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">eat</span><span class="hljs-params">()</span> <span class="hljs-keyword">override</span> </span>&#123;    <span class="hljs-comment">// 必须实现纯虚函数</span><br>        cout &lt;&lt; <span class="hljs-string">&quot;吃狗粮&quot;</span> &lt;&lt; endl;<br>    &#125;<br><br>    ~<span class="hljs-built_in">Dog</span>() <span class="hljs-keyword">override</span> &#123; cout &lt;&lt; <span class="hljs-string">&quot;~Dog&quot;</span> &lt;&lt; endl; &#125;<br>&#125;;<br>​<br>多态使用示例<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">animalAction</span><span class="hljs-params">(Animal* animal)</span> </span>&#123;<br>    animal-&gt;<span class="hljs-built_in">speak</span>();  <span class="hljs-comment">// 多态调用</span><br>    animal-&gt;<span class="hljs-built_in">eat</span>();<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    Animal* zoo[] = &#123;<span class="hljs-keyword">new</span> <span class="hljs-built_in">Dog</span>(), <span class="hljs-keyword">new</span> <span class="hljs-built_in">Cat</span>(), <span class="hljs-keyword">new</span> <span class="hljs-built_in">Bird</span>()&#125;;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> animal : zoo) &#123;<br>        <span class="hljs-built_in">animalAction</span>(animal);<br>    &#125;<br><br>    <span class="hljs-comment">// 必须用delete，会调用正确的析构函数</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> animal : zoo) &#123;<br>        <span class="hljs-keyword">delete</span> animal;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="四-虚函数表vtable机制"><a href="#四-虚函数表vtable机制" class="headerlink" title="四-虚函数表vtable机制"></a><a class="markdownIt-Anchor" href="#四-虚函数表vtable机制"></a> 四、虚函数表（vtable）机制</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs cpp">vtable内存布局<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Base</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">func1</span><span class="hljs-params">()</span> </span>&#123;&#125;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">func2</span><span class="hljs-params">()</span> </span>&#123;&#125;<br>    <span class="hljs-type">int</span> data;<br>&#125;;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Derived</span> : <span class="hljs-keyword">public</span> Base &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">func1</span><span class="hljs-params">()</span> <span class="hljs-keyword">override</span> </span>&#123;&#125;  <span class="hljs-comment">// 覆盖</span><br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">func3</span><span class="hljs-params">()</span> </span>&#123;&#125;   <span class="hljs-comment">// 新增</span><br>    <span class="hljs-type">int</span> extra_data;<br>&#125;;<br><br><span class="hljs-comment">// vtable布局：</span><br><span class="hljs-comment">// Base vtable:    [Base::func1][Base::func2]</span><br><span class="hljs-comment">// Derived vtable: [Derived::func1][Base::func2][Derived::func3]</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// 对象内存：</span><br><span class="hljs-comment">// Base对象:     [vptr→Base vtable][data]</span><br><span class="hljs-comment">// Derived对象:  [vptr→Derived vtable][data][extra_data]</span><br>​<br>虚函数调用过程<br>Base* ptr = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Derived</span>();<br>ptr-&gt;<span class="hljs-built_in">func1</span>();  <span class="hljs-comment">// 运行时：</span><br><span class="hljs-comment">// 1. 通过ptr找到对象</span><br><span class="hljs-comment">// 2. 读取对象头部的vptr</span><br><span class="hljs-comment">// 3. 通过vptr找到vtable</span><br><span class="hljs-comment">// 4. 在vtable中找到func1的地址</span><br><span class="hljs-comment">// 5. 调用Derived::func1()</span><br></code></pre></td></tr></table></figure>
<h2 id="五-多重继承与虚继承"><a href="#五-多重继承与虚继承" class="headerlink" title="五-多重继承与虚继承"></a><a class="markdownIt-Anchor" href="#五-多重继承与虚继承"></a> 五、多重继承与虚继承</h2>
<p>多重继承</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Printer</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">print</span><span class="hljs-params">()</span> </span>&#123; cout &lt;&lt; <span class="hljs-string">&quot;打印&quot;</span> &lt;&lt; endl; &#125;<br>&#125;;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Scanner</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">scan</span><span class="hljs-params">()</span> </span>&#123; cout &lt;&lt; <span class="hljs-string">&quot;扫描&quot;</span> &lt;&lt; endl; &#125;<br>&#125;;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MultiFunction</span> : <span class="hljs-keyword">public</span> Printer, <span class="hljs-keyword">public</span> Scanner &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">print</span><span class="hljs-params">()</span> <span class="hljs-keyword">override</span> </span>&#123; cout &lt;&lt; <span class="hljs-string">&quot;多功能打印&quot;</span> &lt;&lt; endl; &#125;<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">scan</span><span class="hljs-params">()</span> <span class="hljs-keyword">override</span> </span>&#123; cout &lt;&lt; <span class="hljs-string">&quot;多功能扫描&quot;</span> &lt;&lt; endl; &#125;<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">copy</span><span class="hljs-params">()</span> </span>&#123; <span class="hljs-built_in">print</span>(); <span class="hljs-built_in">scan</span>(); &#125;  <span class="hljs-comment">// 新增功能</span><br>&#125;;<br><br><span class="hljs-comment">// 内存布局：有两个vptr！</span><br><span class="hljs-comment">// [Printer vptr][Scanner vptr][MultiFunction数据]</span><br></code></pre></td></tr></table></figure>
<p>钻石继承问题与虚继承</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Base</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-type">int</span> data;<br>&#125;;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Middle1</span> : <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">public</span> Base &#123;&#125;;  <span class="hljs-comment">// 虚继承</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Middle2</span> : <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">public</span> Base &#123;&#125;;  <span class="hljs-comment">// 虚继承</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Derived</span> : <span class="hljs-keyword">public</span> Middle1, <span class="hljs-keyword">public</span> Middle2 &#123;&#125;;<br><br><span class="hljs-comment">// Derived只有一个Base副本</span><br><span class="hljs-comment">// 避免了菱形继承的数据冗余</span><br></code></pre></td></tr></table></figure>
<h2 id="六-dynamic_cast与rtti"><a href="#六-dynamic_cast与rtti" class="headerlink" title="六-dynamic_cast与rtti"></a><a class="markdownIt-Anchor" href="#六-dynamic_cast与rtti"></a> 六、dynamic_cast与RTTI</h2>
<p>类型安全向下转型</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Base</span> &#123; <span class="hljs-keyword">virtual</span> ~<span class="hljs-built_in">Base</span>() &#123;&#125; &#125;;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Derived</span> : <span class="hljs-keyword">public</span> Base &#123;&#125;;<br><br>Base* base_ptr = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Derived</span>();<br></code></pre></td></tr></table></figure>
<p>安全的向下转型</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs cpp">Derived* derived_ptr = <span class="hljs-built_in">dynamic_cast</span>&lt;Derived*&gt;(base_ptr);<br><span class="hljs-keyword">if</span> (derived_ptr) &#123;  <span class="hljs-comment">// 转换成功</span><br>    <span class="hljs-comment">// 使用Derived特有功能</span><br>&#125;<br><br><span class="hljs-comment">// 失败时返回nullptr（指针）或抛异常（引用）</span><br>​<br><span class="hljs-keyword">typeid</span>操作符<br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;typeinfo&gt;</span></span><br><br>Base* ptr = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Derived</span>();<br>cout &lt;&lt; <span class="hljs-built_in">typeid</span>(*ptr).<span class="hljs-built_in">name</span>() &lt;&lt; endl;  <span class="hljs-comment">// 输出：class Derived</span><br>cout &lt;&lt; <span class="hljs-built_in">typeid</span>(ptr).<span class="hljs-built_in">name</span>() &lt;&lt; endl;   <span class="hljs-comment">// 输出：class Base*</span><br><br><span class="hljs-keyword">if</span> (<span class="hljs-built_in">typeid</span>(*ptr) == <span class="hljs-built_in">typeid</span>(Derived)) &#123;<br>    cout &lt;&lt; <span class="hljs-string">&quot;确实是Derived对象&quot;</span> &lt;&lt; endl;<br>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="七-设计模式中的多态应用"><a href="#七-设计模式中的多态应用" class="headerlink" title="七-设计模式中的多态应用"></a><a class="markdownIt-Anchor" href="#七-设计模式中的多态应用"></a> 七、设计模式中的多态应用</h2>
<p>工厂模式</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Product</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">use</span><span class="hljs-params">()</span> </span>= <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">virtual</span> ~<span class="hljs-built_in">Product</span>() &#123;&#125;<br>&#125;;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteProductA</span> : <span class="hljs-keyword">public</span> Product &#123;<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">use</span><span class="hljs-params">()</span> <span class="hljs-keyword">override</span> </span>&#123; cout &lt;&lt; <span class="hljs-string">&quot;使用产品A&quot;</span> &lt;&lt; endl; &#125;<br>&#125;;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteProductB</span> : <span class="hljs-keyword">public</span> Product &#123;<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">use</span><span class="hljs-params">()</span> <span class="hljs-keyword">override</span> </span>&#123; cout &lt;&lt; <span class="hljs-string">&quot;使用产品B&quot;</span> &lt;&lt; endl; &#125;<br>&#125;;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Factory</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">static</span> Product* <span class="hljs-title">createProduct</span><span class="hljs-params">(<span class="hljs-type">const</span> string&amp; type)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (type == <span class="hljs-string">&quot;A&quot;</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">ConcreteProductA</span>();<br>        <span class="hljs-keyword">if</span> (type == <span class="hljs-string">&quot;B&quot;</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">ConcreteProductB</span>();<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<p>​<br />
策略模式</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Strategy</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">execute</span><span class="hljs-params">()</span> </span>= <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">virtual</span> ~<span class="hljs-built_in">Strategy</span>() &#123;&#125;<br>&#125;;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">StrategyA</span> : <span class="hljs-keyword">public</span> Strategy &#123;<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">execute</span><span class="hljs-params">()</span> <span class="hljs-keyword">override</span> </span>&#123; cout &lt;&lt; <span class="hljs-string">&quot;策略A&quot;</span> &lt;&lt; endl; &#125;<br>&#125;;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">StrategyB</span> : <span class="hljs-keyword">public</span> Strategy &#123;<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">execute</span><span class="hljs-params">()</span> <span class="hljs-keyword">override</span> </span>&#123; cout &lt;&lt; <span class="hljs-string">&quot;策略B&quot;</span> &lt;&lt; endl; &#125;<br>&#125;;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Context</span> &#123;<br>    Strategy* strategy;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">setStrategy</span><span class="hljs-params">(Strategy* s)</span> </span>&#123; strategy = s; &#125;<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">executeStrategy</span><span class="hljs-params">()</span> </span>&#123; strategy-&gt;<span class="hljs-built_in">execute</span>(); &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>
<h1 id="移动语义"><a href="#移动语义" class="headerlink" title="移动语义"></a><a class="markdownIt-Anchor" href="#移动语义"></a> 移动语义</h1>
<h1 id="完美转发"><a href="#完美转发" class="headerlink" title="完美转发"></a><a class="markdownIt-Anchor" href="#完美转发"></a> 完美转发</h1>
<h1 id="类型推导"><a href="#类型推导" class="headerlink" title="类型推导"></a><a class="markdownIt-Anchor" href="#类型推导"></a> 类型推导</h1>
<h1 id="结构化绑定"><a href="#结构化绑定" class="headerlink" title="结构化绑定"></a><a class="markdownIt-Anchor" href="#结构化绑定"></a> 结构化绑定</h1>
<h1 id="vcpkg"><a href="#vcpkg" class="headerlink" title="vcpkg"></a><a class="markdownIt-Anchor" href="#vcpkg"></a> vcpkg</h1>
<h2 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a><a class="markdownIt-Anchor" href="#目录结构"></a> 目录结构</h2>
<h3 id="核心目录结构"><a href="#核心目录结构" class="headerlink" title="核心目录结构"></a><a class="markdownIt-Anchor" href="#核心目录结构"></a> 📚  核心目录结构</h3>
<p>一、ports/ 目录 - “食谱库”</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">#作用：如何获取和构建库<br>ports/<br>├── fmt/          # 每个库一个目录<br>│   ├── vcpkg.json       # 库的元数据：名称、版本、依赖、描述<br>│   ├── portfile.cmake   # 构建脚本：下载的URL、编译选项、安装步骤<br>│   └── (patch文件)      # 补丁<br>├── zlib/<br>├── curl/<br>└── ... (2737个库)<br></code></pre></td></tr></table></figure>
<hr />
<p>二、downloads/ 目录 - “下载缓存”</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">#作用：避免重复下载<br>downloads/<br>├── fmt-8.0.0.tar.gz           # 库源码压缩包<br>├── ninja-win-1.13.1.zip       # 构建工具<br>├── curl-curl-curl-8_17_0.tar.gz<br>└── madler-zlib-v1.3.1.tar.gz<br></code></pre></td></tr></table></figure>
<hr />
<p>三、installed/ 目录 - “成品仓库”</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">installed/<br>├── x64-windows/               # triplet：平台架构<br>│   ├── include/               # 头文件目录<br>│   │   └── fmt/<br>│   │       ├── core.h<br>│   │       └── format.h<br>│   ├── lib/                   # 静态库/导入库<br>│   │   ├── fmt.lib<br>│   │   └── debug/fmt.lib<br>│   ├── bin/                   # 动态库（Windows的DLL）<br>│   │   ├── fmt.dll<br>│   │   └── debug/fmt.dll<br>│   └── share/                 # 配置文件<br>│       └── fmt/<br>│           ├── vcpkg.json<br>│           └── copyright<br>├── x64-windows-static/        # 静态链接版本<br>└── x86-windows/               # 32位版本<br></code></pre></td></tr></table></figure>
<hr />
<p>四、vcpkg.exe - “总厨师”</p>
<p>作用：命令行管理工具</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 包管理</span><br>vcpkg install <span class="hljs-built_in">fmt</span>        <span class="hljs-comment"># 下载→编译→安装</span><br>vcpkg remove <span class="hljs-built_in">fmt</span>         <span class="hljs-comment"># 卸载</span><br>vcpkg list              <span class="hljs-comment"># 查看已安装</span><br>vcpkg search boost      <span class="hljs-comment"># 搜索库</span><br><br><span class="hljs-comment"># 项目管理</span><br>vcpkg integrate install <span class="hljs-comment"># 集成到Visual Studio</span><br>vcpkg new              <span class="hljs-comment"># 创建新项目</span><br><br><span class="hljs-comment"># 信息查询</span><br>vcpkg depend-info <span class="hljs-built_in">fmt</span>  <span class="hljs-comment"># 查看依赖</span><br>vcpkg triplet list     <span class="hljs-comment"># 查看支持的平台</span><br></code></pre></td></tr></table></figure>
<hr />
<p>五、buildtrees/ - “厨房”</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">#作用：编译过程的中间文件<br>buildtrees/<br>└── fmt/<br>    ├── src/                    # 解压后的源码<br>    │   └── fmt-8.0.0/<br>    ├── x64-windows-dbg/        # 调试版编译文件<br>    ├── x64-windows-rel/        # 发布版编译文件<br>    └── install-x64-windows-dbg-out.log  # 安装日志<br></code></pre></td></tr></table></figure>
<hr />
<p>六、triplets/ - “平台配方”</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">triplets/<br>├── x64-windows.cmake          # 64位Windows动态库<br>├── x64-windows-static.cmake   # 64位Windows静态库<br>├── x86-windows.cmake          # 32位Windows<br>├── x64-linux.cmake           # Linux<br>└── x64-osx.cmake             # macOS<br></code></pre></td></tr></table></figure>
<p>作用：定义不同平台的构建配置</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext"># x64-windows.cmake 示例<br>set(VCPKG_TARGET_ARCHITECTURE x64)<br>set(VCPKG_CRT_LINKAGE dynamic)   # 动态链接CRT<br>set(VCPKG_LIBRARY_LINKAGE dynamic) # 动态库<br></code></pre></td></tr></table></figure>
<hr />
<p>七、scripts/ - “工具脚本”</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">scripts/<br>├── buildsystems/              # 构建系统集成<br>│   └── vcpkg.cmake           # CMake工具链文件<br>├── cmake/                     # CMake辅助脚本<br>└── toolchains/               # 交叉编译工具链<br>关键文件：scripts/buildsystems/vcpkg.cmake<br>· CMake通过这个文件集成vcpkg<br>· 设置包含路径、库路径等<br></code></pre></td></tr></table></figure>
<hr />
<p>八、toolsrc/ - “vcpkg自身源码”</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">toolsrc/<br>├── src/                       # vcpkg C++源码<br>└── include/<br>作用：vcpkg工具自身的源代码<br> · 编译后生成 vcpkg.exe<br> · 通常不需要关注<br></code></pre></td></tr></table></figure>
<hr />
<p>九、packages/ 目录 - “打包中转站”</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">packages/<br>├── fmt_x64-windows/           # 打包好的fmt库<br>├── zlib_x64-windows/          # 打包好的zlib库<br>├── curl_x64-windows/          <br>├── detect_compiler_x64-windows/<br>├── vcpkg-cmake_x64-windows/<br>└── vcpkg-cmake-config_x64-windows/<br></code></pre></td></tr></table></figure>
<p>完整工作流程（结合所有目录）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">vcpkg install fmt:x64-windows<br>         ↓<br>1. ports/fmt/          ← 读取配方<br>         ↓<br>2. downloads/          ← 检查/下载源码<br>         ↓<br>3. buildtrees/fmt/     ← 解压、编译<br>         ↓<br>4. installed/x64-windows/ ← 安装成品<br>         ↓<br>5. 项目通过 scripts/buildsystems/vcpkg.cmake 自动使用<br></code></pre></td></tr></table></figure>
<h2 id="操作"><a href="#操作" class="headerlink" title="操作"></a><a class="markdownIt-Anchor" href="#操作"></a> 操作</h2>
<h3 id="配方ports"><a href="#配方ports" class="headerlink" title="配方ports"></a><a class="markdownIt-Anchor" href="#配方ports"></a> 配方：Ports</h3>
<p>📁 vcpkg ports目录结构详解</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">ports/库名/<br>├── vcpkg.json          # 🔸 库的元数据和依赖声明（必需）<br>├── portfile.cmake      # 🔸 构建脚本（必需）<br>├── patches/            # 🔸 补丁目录（可选）<br>│   ├── 0001-xxx.patch<br>│   └── 0002-yyy.patch<br>├── CMakeLists.txt      # 🔸 自定义CMake文件（可选）<br>├── usage               # 🔸 库使用说明（可选）<br>└── vcpkg-cmake-wrapper.cmake  # CMake包装器（可选）<br></code></pre></td></tr></table></figure>
<p>📄 vcpkg.json - 库的&quot;身份证&quot;</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;$schema&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&lt;https://raw.githubusercontent.com/microsoft/vcpkg/master/scripts/vcpkg.schema.json&gt;&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;库名称&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;version&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;版本号&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;port-version&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>           <span class="hljs-comment">// vcpkg内部版本（修复bug但不改上游版本时增加）</span><br>  <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;库的描述&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;homepage&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;官网或仓库URL&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;license&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;许可证类型&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;supports&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;支持的条件表达式&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;dependencies&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>           <span class="hljs-comment">// 依赖项列表</span><br>    <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;依赖库名&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;host&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span>           <span class="hljs-comment">// true=编译工具依赖，false=运行时库依赖</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;features&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span>               <span class="hljs-comment">// 可选功能</span><br>    <span class="hljs-attr">&quot;feature-name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;功能描述&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;dependencies&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span>      <span class="hljs-comment">// 启用此功能时需要额外依赖</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;default-features&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span>      <span class="hljs-comment">// 默认启用的功能</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>
<p>🛠️ portfile.cmake - 构建&quot;配方&quot;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs plaintext"># 1. 版本处理（如果需要）<br>string(REPLACE ...)  # 转换版本格式<br><br># 2. 下载源码<br>vcpkg_from_github(<br>    OUT_SOURCE_PATH SOURCE_PATH<br>    REPO 作者/仓库名<br>    REF 版本标签或commit<br>    SHA512 哈希值<br>    HEAD_REF 主分支名<br>    PATCHES 补丁列表<br>)<br><br># 3. 应用额外文件（如果需要）<br>file(COPY &quot;$&#123;CMAKE_CURRENT_LIST_DIR&#125;/CMakeLists.txt&quot; DESTINATION &quot;$&#123;SOURCE_PATH&#125;&quot;)<br><br># 4. 配置<br>vcpkg_cmake_configure(<br>    SOURCE_PATH &quot;$&#123;SOURCE_PATH&#125;&quot;<br>    OPTIONS<br>        -D选项1=值1<br>        -D选项2=值2<br>    OPTIONS_DEBUG   # 调试版特有选项<br>        -D调试选项=值<br>)<br><br># 5. 编译和安装<br>vcpkg_cmake_install()<br><br># 6. 复制PDB文件（Windows调试符号）<br>vcpkg_copy_pdbs()<br><br># 7. 整理配置<br>vcpkg_cmake_config_fixup()<br><br># 8. 安装版权文件<br>vcpkg_install_copyright(FILE_LIST &quot;$&#123;SOURCE_PATH&#125;/LICENSE&quot;)<br></code></pre></td></tr></table></figure>
<p>🩹 patches/ - &quot;创可贴&quot;目录</p>
<p>补丁文件命名规范：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">0001-简短描述.patch<br>0002-另一修复.patch<br>0003-平台适配.patch<br></code></pre></td></tr></table></figure>
<p>补丁内容格式（统一差异格式）：</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs diff"><span class="hljs-comment">--- original/文件路径     # 原始文件</span><br><span class="hljs-comment">+++ modified/文件路径     # 修改后文件</span><br>@@ -行号,行数 +行号,行数 @@ 上下文<br> 保留的行<br><span class="hljs-deletion">-删除的行</span><br><span class="hljs-addition">+添加的行</span><br> 更多的上下文<br></code></pre></td></tr></table></figure>
<p>示例补丁作用：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs plaintext"># portfile.cmake中引用：<br>PATCHES<br>    0001-fix-windows-build.patch      # 修复Windows编译<br>    0002-cmake-install-prefix.patch   # 修正安装路径<br>    0003-disable-examples.patch       # 禁用示例构建<br></code></pre></td></tr></table></figure>
<h3 id="拉取"><a href="#拉取" class="headerlink" title="拉取"></a><a class="markdownIt-Anchor" href="#拉取"></a> 拉取</h3>
<p>📁 操作目录结构</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">C:\\C++_depend\\vcpkg\\manual_learning\\<br>└── 库名_manual/<br>    ├── src/           # 源码（解压后）<br>    ├── build/         # 构建中间文件<br>    └── installed/     # 最终安装位置<br></code></pre></td></tr></table></figure>
<p>🔄 完整操作流程</p>
<p>第1步：选择目标库</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-comment"># 查看可用库</span><br><span class="hljs-built_in">cd</span> C:\\C++_depend\\vcpkg<br><span class="hljs-built_in">dir</span> ports | <span class="hljs-built_in">Select-Object</span> <span class="hljs-literal">-First</span> <span class="hljs-number">10</span><br><br><span class="hljs-comment"># 选择简单无依赖的库，如：zlib, fmt, stb</span><br></code></pre></td></tr></table></figure>
<p>第2步：分析库配方</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-comment"># 查看库的元数据</span><br><span class="hljs-built_in">Get-Content</span> ports\\zlib\\vcpkg.json<br><br><span class="hljs-comment"># 查看构建脚本</span><br><span class="hljs-built_in">Get-Content</span> ports\\zlib\\portfile.cmake<br><br><span class="hljs-comment"># 提取关键信息：</span><br><span class="hljs-comment"># 1. 版本号（version）</span><br><span class="hljs-comment"># 2. 下载方式（vcpkg_from_github/vcpkg_download_distfile）</span><br><span class="hljs-comment"># 3. 仓库/URL信息</span><br><span class="hljs-comment"># 4. 哈希值（SHA512）</span><br></code></pre></td></tr></table></figure>
<p>第3步：创建手动构建目录</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">cd</span> C:\\C++_depend\\vcpkg\\manual_learning<br><br><span class="hljs-comment"># 创建专属目录</span><br><span class="hljs-variable">$libName</span> = <span class="hljs-string">&quot;zlib&quot;</span><br>mkdir <span class="hljs-string">&quot;<span class="hljs-variable">$</span>&#123;libName&#125;_manual&quot;</span><br><span class="hljs-built_in">cd</span> <span class="hljs-string">&quot;<span class="hljs-variable">$</span>&#123;libName&#125;_manual&quot;</span><br><br><span class="hljs-comment"># 创建标准子目录</span><br><span class="hljs-built_in">New-Item</span> <span class="hljs-literal">-ItemType</span> Directory <span class="hljs-literal">-Path</span> src, build, installed <span class="hljs-literal">-Force</span><br><br><span class="hljs-comment"># 验证结构</span><br>tree /F<br></code></pre></td></tr></table></figure>
<p>第4步：提取下载URL并下载</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-comment"># 从portfile.cmake提取URL（手动分析）</span><br><span class="hljs-comment"># 常见格式：</span><br><span class="hljs-comment"># GitHub: &lt;https://github.com/作者/仓库/archive/refs/tags/v版本.zip&gt;</span><br><span class="hljs-comment"># 官网: &lt;http://example.com/库名-版本.tar.gz&gt;</span><br><br><span class="hljs-comment"># 下载示例（zlib 1.3.1）：</span><br><span class="hljs-variable">$url</span> = <span class="hljs-string">&quot;&lt;https://github.com/madler/zlib/archive/refs/tags/v1.3.1.zip&gt;&quot;</span><br><span class="hljs-variable">$output</span> = <span class="hljs-string">&quot;zlib-1.3.1.zip&quot;</span><br><br><span class="hljs-comment"># 方法1：Invoke-WebRequest</span><br><span class="hljs-built_in">Invoke-WebRequest</span> <span class="hljs-literal">-Uri</span> <span class="hljs-variable">$url</span> <span class="hljs-literal">-OutFile</span> <span class="hljs-variable">$output</span><br><br><span class="hljs-comment"># 方法2：如果方法1失败，用System.Net.WebClient</span><br><span class="hljs-variable">$webClient</span> = <span class="hljs-built_in">New-Object</span> System.Net.WebClient<br><span class="hljs-variable">$webClient</span>.DownloadFile(<span class="hljs-variable">$url</span>, <span class="hljs-variable">$output</span>)<br><span class="hljs-variable">$webClient</span>.Dispose()<br><br><span class="hljs-comment"># 检查下载文件</span><br><span class="hljs-built_in">Get-Item</span> <span class="hljs-variable">$output</span> | <span class="hljs-built_in">Select-Object</span> Name, Length, LastWriteTime<br></code></pre></td></tr></table></figure>
<p>第5步：解压源码</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-comment"># 方法A：使用7zip（如果有）</span><br><span class="hljs-number">7</span>z x <span class="hljs-string">&quot;zlib-1.3.1.zip&quot;</span> <span class="hljs-literal">-osrc</span><br><br><span class="hljs-comment"># 方法B：使用Expand-Archive（适用于.zip）</span><br><span class="hljs-built_in">Expand-Archive</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;zlib-1.3.1.zip&quot;</span> <span class="hljs-literal">-DestinationPath</span> src<br><br><span class="hljs-comment"># 方法C：手动解压到src目录</span><br><span class="hljs-comment"># 1. 用WinRAR/7-Zip GUI解压</span><br><span class="hljs-comment"># 2. 将解压出的文件夹内容复制到src/</span><br><br><span class="hljs-comment"># 验证解压结果</span><br><span class="hljs-built_in">dir</span> src <span class="hljs-literal">-Recurse</span> | <span class="hljs-built_in">Select-Object</span> <span class="hljs-literal">-First</span> <span class="hljs-number">15</span><br></code></pre></td></tr></table></figure>
<h3 id="编译链接"><a href="#编译链接" class="headerlink" title="编译链接"></a><a class="markdownIt-Anchor" href="#编译链接"></a> 编译&amp;链接</h3>
<p>🏗️ 库编译流程</p>
<p>📦 一、编译第三方库步骤</p>
<ol>
<li>编译源码 → .obj</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> 库源码目录<br>cl /c *.c                <span class="hljs-comment"># 编译所有.c文件生成.obj</span><br></code></pre></td></tr></table></figure>
<ol start="2">
<li>打包.obj → 静态库.lib</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">lib /OUT:库名.lib *.obj   <span class="hljs-comment"># 所有.obj打包成一个.lib</span><br></code></pre></td></tr></table></figure>
<p>📁 标准目录结构</p>
<p>创建发布目录：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">库名/<br>├── include/     <span class="hljs-comment"># 头文件(.h)</span><br>├── lib/         <span class="hljs-comment"># 静态库(.lib)</span><br>├── bin/         <span class="hljs-comment"># 动态库(.dll)</span><br>└── share/       <span class="hljs-comment"># 文档等</span><br></code></pre></td></tr></table></figure>
<p>🔧 完整示例（zlib）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 1. 进入源码目录</span><br><span class="hljs-built_in">cd</span> zlib-1.3.1<br><br><span class="hljs-comment"># 2. 编译所有源文件</span><br>cl /c *.c<br><br><span class="hljs-comment"># 3. 创建静态库</span><br>lib /OUT:zlib.lib *.obj<br><br><span class="hljs-comment"># 4. 创建发布目录</span><br><span class="hljs-built_in">mkdir</span> ..\\zlib_dist\\include<br><span class="hljs-built_in">mkdir</span> ..\\zlib_dist\\lib<br><br><span class="hljs-comment"># 5. 复制文件</span><br>copy *.h ..\\zlib_dist\\include\\<br>copy zlib.lib ..\\zlib_dist\\lib\\<br></code></pre></td></tr></table></figure>
<p>📝 使用已编译库</p>
<p>🚀 二、编译自己的代码（使用第三方库）</p>
<ol>
<li>编译你的代码 → .obj</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 指定头文件路径</span><br>cl /c /I库目录\\include 你的代码.cpp<br></code></pre></td></tr></table></figure>
<ol start="2">
<li>链接库文件 → .exe</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 指定库文件</span><br><span class="hljs-built_in">link</span> 你的代码.obj 库目录\\lib\\库名.lib /OUT:程序.exe<br></code></pre></td></tr></table></figure>
<p>📦 实际例子（使用zlib）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 1. 编译你的程序（需要zlib.h）</span><br>cl /c /Izlib_dist\\include test_zlib.cpp<br><br><span class="hljs-comment"># 2. 链接zlib库</span><br><span class="hljs-built_in">link</span> test_zlib.obj zlib_dist\\lib\\zlib.lib /OUT:test.exe<br></code></pre></td></tr></table></figure>
<p>🎯 一句话总结</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">编译：cl /c /I头文件路径 代码.cpp<br>链接：link 你的代码.obj 库路径\\库名.lib /OUT:程序名.exe<br></code></pre></td></tr></table></figure>
<p>🔄 三、完整工作流总结</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">1. 编译第三方库：<br>   源码.c → cl /c → .obj → lib → .lib<br><br>2. 组织文件：<br>   .h → include目录<br>   .lib → lib目录<br><br>3. 编译你的代码：<br>   你的代码.cpp + /Iinclude → cl /c → 你的代码.obj<br><br>4. 链接：<br>   你的代码.obj + lib\\库名.lib → link → 程序.exe<br></code></pre></td></tr></table></figure>
<h3 id="vs链接"><a href="#vs链接" class="headerlink" title="vs链接"></a><a class="markdownIt-Anchor" href="#vs链接"></a> VS链接</h3>
<ol>
<li>打开项目属性</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">方法1：右键项目 → 属性<br>方法2：菜单栏 → 项目 → TestZlibInVS属性<br></code></pre></td></tr></table></figure>
<ol start="2">
<li>配置头文件路径</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">左侧：配置属性 → C/C++ → 常规<br>右侧：附加包含目录 → 编辑<br>添加：C:\\C++_depend\\vcpkg\\manual_learning\\zlib_complete\\include<br></code></pre></td></tr></table></figure>
<ol start="3">
<li>配置库文件路径</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">左侧：配置属性 → 链接器 → 常规<br>右侧：附加库目录 → 编辑<br>添加：C:\\C++_depend\\vcpkg\\manual_learning\\zlib_complete\\lib<br></code></pre></td></tr></table></figure>
<ol start="4">
<li>添加要链接的库</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">左侧：配置属性 → 链接器 → 输入<br>右侧：附加依赖项 → 编辑<br>添加：zlib.lib<br></code></pre></td></tr></table></figure>
<h1 id="cmake"><a href="#cmake" class="headerlink" title="cmake"></a><a class="markdownIt-Anchor" href="#cmake"></a> CMake</h1>
<h2 id="cmake介绍"><a href="#cmake介绍" class="headerlink" title="cmake介绍"></a><a class="markdownIt-Anchor" href="#cmake介绍"></a> CMake介绍</h2>
<p>一、对象（文件夹）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">my_project/                         # 项目根目录<br>├── CMakeLists.txt                  # 主CMake文件（必须！）<br>├── README.md                       # 项目说明<br>├── LICENSE                         # 许可证<br>├── .gitignore                      # Git忽略文件<br>│<br>├── include/                        # 公共头文件（对外暴露的接口）<br>│   └── my_project/<br>│       ├── core.h<br>│       └── utils.h<br>│<br>├── src/                           # 源代码目录<br>│   ├── main.c                     # 主程序入口<br>│   ├── core.c                     # 核心实现<br>│   ├── utils.c                    # 工具函数<br>│   └── internal/                  # 内部头文件（不对外暴露）<br>│       └── internal_utils.h<br>│<br>├── libs/                          # 第三方库或子模块<br>│   ├── tinyxml2/                  # 第三方库1<br>│   └── my_math/                   # 自己的库模块<br>│       ├── CMakeLists.txt         # 子模块有自己的CMakeLists<br>│       ├── include/<br>│       └── src/<br>│<br>├── tests/                         # 测试代码<br>│   ├── CMakeLists.txt<br>│   ├── test_core.c<br>│   └── test_utils.c<br>│<br>├── examples/                      # 示例代码<br>│   ├── demo1.c<br>│   └── demo2.c<br>│<br>├── docs/                          # 文档<br>│   └── api.md<br>│<br>└── build/                         # 构建目录（通常.gitignore忽略）<br>    ├── bin/                       # 可执行文件输出目录<br>    │   ├── my_project             # Linux可执行文件<br>    │   └── my_project.exe         # Windows可执行文件<br>    ├── lib/                       # 库文件输出目录<br>    │   ├── libmy_math.a           # 静态库<br>    │   └── libmy_math.so          # 动态库<br>    └── ...CMake生成的各种文件<br></code></pre></td></tr></table></figure>
<p>二、Windows流程</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs powershell">REM <span class="hljs-number">1</span>. 进入项目目录<br><span class="hljs-built_in">cd</span> Desktop\hello_world<br><br>REM <span class="hljs-number">2</span>. 使用Visual Studio生成器<br>cmake <span class="hljs-literal">-B</span> build <span class="hljs-literal">-S</span> . <span class="hljs-literal">-G</span> <span class="hljs-string">&quot;Visual Studio 17 2022&quot;</span> <span class="hljs-literal">-A</span> x64<br><br>REM <span class="hljs-number">3</span>. 编译Release版本<br>cmake <span class="hljs-literal">--build</span> build <span class="hljs-literal">--config</span> Release<br><br>REM <span class="hljs-number">4</span>. 运行<br>build\Release\hello.exe<br></code></pre></td></tr></table></figure>
<p>Linux流程</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 1. 进入项目目录</span><br><span class="hljs-built_in">cd</span> ~/hello_world<br><br><span class="hljs-comment"># 2. 生成构建系统（默认Unix Makefiles）</span><br>cmake -B build -S .<br><br><span class="hljs-comment"># 3. 编译</span><br>cmake --build build<br><span class="hljs-comment"># 或者传统方式：</span><br><span class="hljs-built_in">cd</span> build<br>make -j4  <span class="hljs-comment"># 4线程并行编译</span><br><br><span class="hljs-comment"># 4. 运行</span><br>./build/hello<br><span class="hljs-comment"># 或如果设置了输出目录：</span><br>./build/bin/hello<br></code></pre></td></tr></table></figure>
<p>三、结果：生成文件夹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">calculator/build/             <br>├── CMakeCache.txt       #配置缓存    <br>├── CMakeFiles/              <br>├── calc.exe       #可执行文件             <br>├── calc_main.obj            <br>├── math_ops.obj             <br>└── Makefile 或 .sln       #cmake内部文件  <br></code></pre></td></tr></table></figure>
<h2 id="cmakeliststext"><a href="#cmakeliststext" class="headerlink" title="cmakeliststext"></a><a class="markdownIt-Anchor" href="#cmakeliststext"></a> CMakeLists.text</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><code class="hljs plaintext"># ==================== 第一部分：基础设置 ====================<br># 1. CMake版本要求（必须第一行）<br>cmake_minimum_required(VERSION 3.15)<br><br># 2. 项目定义<br>project(MyProject<br>    VERSION 1.0.0<br>    DESCRIPTION &quot;My C Project&quot;<br>    LANGUAGES C<br>    HOMEPAGE_URL &quot;https://github.com/me/myproject&quot;<br>)<br><br># ==================== 第二部分：目录设置 ====================<br># 3. 输出目录设置（可选但推荐）<br>set(CMAKE_RUNTIME_OUTPUT_DIRECTORY $&#123;CMAKE_BINARY_DIR&#125;/bin)<br>set(CMAKE_LIBRARY_OUTPUT_DIRECTORY $&#123;CMAKE_BINARY_DIR&#125;/lib)<br>set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY $&#123;CMAKE_BINARY_DIR&#125;/lib)<br><br># 4. 包含目录<br>include_directories($&#123;CMAKE_CURRENT_SOURCE_DIR&#125;/include)<br>include_directories($&#123;CMAKE_CURRENT_SOURCE_DIR&#125;/src)<br><br># ==================== 第三部分：编译器选项 ====================<br># 5. 全局编译选项<br>add_compile_options(<br>    -Wall<br>    -Wextra<br>    -Werror<br>    -O2<br>)<br><br># 6. 根据平台调整<br>if(MSVC)<br>    add_compile_options(/W4)<br>else()<br>    add_compile_options(-std=c11)<br>endif()<br><br># ==================== 第四部分：目标定义 ====================<br># 7. 添加库<br>add_library(math_utils STATIC src/math_utils.c)<br><br># 8. 库的特殊设置<br>target_include_directories(math_utils PUBLIC include)<br>target_compile_options(math_utils PRIVATE -O3)<br><br># 9. 添加可执行文件<br>add_executable(my_app src/main.c)<br><br># 10. 链接库<br>target_link_libraries(my_app PRIVATE math_utils)<br><br># ==================== 第五部分：安装配置 ====================<br># 11. 安装规则（make install时使用）<br>install(TARGETS my_app<br>    RUNTIME DESTINATION bin<br>    LIBRARY DESTINATION lib<br>    ARCHIVE DESTINATION lib<br>)<br><br># 12. 安装头文件<br>install(FILES include/math_utils.h DESTINATION include)<br><br># ==================== 第六部分：测试配置 ====================<br># 13. 启用测试<br>enable_testing()<br><br># 14. 添加测试<br>add_test(NAME basic_test COMMAND my_app)<br><br># ==================== 第七部分：查找依赖 ====================<br># 15. 查找系统库<br>find_package(Threads REQUIRED)<br>target_link_libraries(my_app PRIVATE Threads::Threads)<br><br># 16. 查找自定义包<br>find_path(MYLIB_INCLUDE_DIR mylib.h)<br>find_library(MYLIB_LIBRARY mylib)<br></code></pre></td></tr></table></figure>
<h1 id="cmake语法"><a href="#cmake语法" class="headerlink" title="cmake语法"></a><a class="markdownIt-Anchor" href="#cmake语法"></a> cmake语法</h1>
<p>🎯 项目定义</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">cmake_minimum_required(VERSION 3.10)  # 必须第一行<br>project(项目名 [VERSION 版本号] [LANGUAGES CXX])  # 定义项目<br></code></pre></td></tr></table></figure>
<p>🔧 变量操作</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">set(变量名 &quot;值&quot;)                    # 设置变量<br>$&#123;变量名&#125;                          # 使用变量<br>unset(变量名)                       # 删除变量<br>list(APPEND 列表 元素)              # 列表追加<br></code></pre></td></tr></table></figure>
<p>📁 文件与目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">add_executable(目标名 文件1.cpp 文件2.cpp)  # 创建可执行文件<br>add_library(库名 [STATIC|SHARED] 源文件)    # 创建库<br><br>target_include_directories(目标名<br>    PUBLIC|PRIVATE|INTERFACE 目录1 目录2)   # 添加包含目录<br>target_link_libraries(目标名 库1 库2)        # 链接库<br>link_directories(目录)                      # 添加库搜索目录<br></code></pre></td></tr></table></figure>
<p>🔍 查找包</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">find_package(包名 [REQUIRED] [CONFIG])      # 查找包<br>find_library(变量名 库名 [路径])            # 查找库文件<br>find_path(变量名 头文件名 [路径])           # 查找头文件路径<br>find_program(变量名 程序名 [路径])          # 查找可执行程序<br></code></pre></td></tr></table></figure>
<p>⚙️ 编译选项</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">add_compile_options(-Wall -Wextra)         # 添加编译选项<br>add_definitions(-D宏名)                    # 添加预定义宏<br>target_compile_definitions(目标名 PRIVATE 宏) # 目标特定宏<br>set(CMAKE_CXX_STANDARD 17)                 # C++标准版本<br></code></pre></td></tr></table></figure>
<p>🔄 流程控制</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">if(条件)<br>    # ...<br>elseif(其他条件)<br>    # ...<br>else()<br>    # ...<br>endif()<br><br>foreach(变量 IN [ITEMS|LISTS|RANGE])<br>    # ...<br>endforeach()<br><br>while(条件)<br>    # ...<br>endwhile()<br></code></pre></td></tr></table></figure>
<p>📦 函数与宏</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">function(函数名 参数1 参数2)<br>    # $&#123;ARGV&#125; 所有参数<br>    # $&#123;ARGN&#125; 额外参数<br>    # $&#123;参数1&#125; 命名参数<br>endfunction()<br><br>macro(宏名 参数)    # 宏与函数类似，但不同作用域<br>    # ...<br>endmacro()<br></code></pre></td></tr></table></figure>
<p>🎪 生成器表达式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">$&lt;条件:值&gt;          # 条件表达式<br>$&lt;CONFIG:Debug&gt;    # 当前配置是Debug<br>$&lt;PLATFORM_ID:Windows&gt;  # 平台判断<br>$&lt;TARGET_FILE:目标&gt;    # 目标文件路径<br>$&lt;TARGET_FILE_DIR:目标&gt; # 目标文件目录<br></code></pre></td></tr></table></figure>
<p>📤 输出与信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">message([STATUS|WARNING|ERROR|FATAL_ERROR] &quot;消息&quot;)<br></code></pre></td></tr></table></figure>
<p>🔗 常用条件判断</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">if(WIN32)          # Windows系统<br>if(APPLE)          # Mac系统<br>if(UNIX)           # Linux/Unix系统<br>if(MSVC)           # Visual Studio编译器<br>if(CMAKE_BUILD_TYPE STREQUAL &quot;Debug&quot;)  # 构建类型<br>if(DEFINED 变量名)  # 变量是否定义<br>if(EXISTS 文件路径) # 文件是否存在<br></code></pre></td></tr></table></figure>
<p>📊 特殊变量</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">$&#123;CMAKE_SOURCE_DIR&#125;      # CMakeLists.txt所在目录<br>$&#123;CMAKE_BINARY_DIR&#125;      # build目录<br>$&#123;CMAKE_CURRENT_SOURCE_DIR&#125;  # 当前处理的CMakeLists.txt目录<br>$&#123;CMAKE_CURRENT_BINARY_DIR&#125;  # 当前输出目录<br>$&#123;PROJECT_SOURCE_DIR&#125;    # 项目根目录<br>$&#123;PROJECT_BINARY_DIR&#125;    # 项目build目录<br>$&#123;CMAKE_BUILD_TYPE&#125;      # 构建类型(Debug/Release)<br><br>$&#123;CMAKE_CXX_COMPILER&#125;    # C++编译器（CMake自带）<br>$&#123;CMAKE_TOOLCHAIN_FILE&#125;  # 工具链文件（CMake自带）<br></code></pre></td></tr></table></figure>
<p>🛠️ 文件操作</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">file(GLOB 变量 &quot;模式&quot;)          # 通配符匹配文件<br>file(GLOB_RECURSE 变量 &quot;模式&quot;)   # 递归匹配<br>file(COPY 文件 DESTINATION 目录) # 复制文件<br>configure_file(输入文件 输出文件) # 配置时复制并替换变量<br></code></pre></td></tr></table></figure>
<p>🎨 目标属性</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">get_target_property(变量 目标 属性)    # 获取目标属性<br>set_target_properties(目标 PROPERTIES 属性 值) # 设置目标属性<br></code></pre></td></tr></table></figure>
<p>📝 一句话总结常用命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plaintext"># 创建程序：add_executable(名字 文件)<br># 添加头文件：target_include_directories(名字 PRIVATE 目录)<br># 链接库：target_link_libraries(名字 库名)<br># 设置选项：set(选项 值)<br># 条件判断：if() ... endif()<br># 循环：foreach() ... endforeach()<br></code></pre></td></tr></table></figure>
<h2 id="实际使用"><a href="#实际使用" class="headerlink" title="实际使用"></a><a class="markdownIt-Anchor" href="#实际使用"></a> 实际使用</h2>
<p>第一步：打开终端</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-comment"># 必须用这个！</span><br><span class="hljs-string">&quot;x64 Native Tools Command Prompt for VS 2022&quot;</span><br></code></pre></td></tr></table></figure>
<p>第二步：进入项目目录</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">cd</span> C:\Users\<span class="hljs-number">34035</span>\Graphics<br></code></pre></td></tr></table></figure>
<p>第三步：清理和配置（第一次或修改CMake后）</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-comment"># 1. 删除旧的构建目录</span><br><span class="hljs-built_in">rmdir</span> /s /q build<br><br><span class="hljs-comment"># 2. 创建新的构建目录</span><br>mkdir build<br><span class="hljs-built_in">cd</span> build<br><br><span class="hljs-comment"># 3. 配置CMake（关键！）</span><br>cmake .. <span class="hljs-literal">-DCMAKE_TOOLCHAIN_FILE</span>=C:\vcpkg\scripts\buildsystems\vcpkg.cmake<br></code></pre></td></tr></table></figure>
<p>第四步：编译项目</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-comment"># 4. 编译（在build目录中）</span><br>cmake <span class="hljs-literal">--build</span> .<br><br><span class="hljs-comment"># 或者简写</span><br>cmake <span class="hljs-literal">--build</span> . <span class="hljs-literal">--config</span> Debug<br></code></pre></td></tr></table></figure>
<p>第五步：运行程序</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-comment"># 5. 运行可执行文件</span><br>.\bin\ComputerGraphics.exe<br></code></pre></td></tr></table></figure>
<div id="paginator"></div></div><div id="post-footer"><div id="pages" style="justify-content: flex-end"><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2026/12/27/%E5%9B%BE%E5%BD%A2%E5%AD%A6%E7%BC%96%E7%A8%8B/">图形学编程 Prev →</a></div></div></div><details id="reward"><summary>reward</summary><div><span>微信 | Wechat</span><br><img src="/images/WeChat.png"></div><div><span>支付宝 | Alipay</span><br><img src="/images/Alipay.png"></div></details><div id="comments"><div id="giscus"></div></div></div><div class="bottom-btn"><div><a class="i-top" id="to-top" onClick="scrolls.scrolltop();" title="To Top" style="opacity: 0; display: none;">∧ </a><a class="i-index" id="to-index" onClick="tocControl.change()" title="To Catalog"><span class="tocBtnIconBar"></span><span class="tocBtnIconBar"></span><span class="tocBtnIconBar"></span></a><a class="i-color" id="color-mode" onClick="colorMode.change()" title="Change Theme"></a><a onclick="BgmControl()"><svg id="bgm-control" viewBox="0 0 30 34" fill="#18d1ff" style="width: 24px; transition: transform .3s;margin-top: 4px"><path d="M25.998 23.422V11.29h3.999v12.132h-3.999zM19.497 6.234h4.001v22.243h-4.001V6.234zM12.998.867h4v32.978h-4V.867zm-6.5 5.367h4.001v22.243H6.498V6.234zm-6.5 5.056h4v12.132h-4V11.29z"></path></svg><audio id="bgm" src="/audio/bgm.mp3" autoplay loop crossorigin="anonymous"> </audio></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="/images/1.jpg" alt="Logo" style="margin:0;border-radius:0;"></a><h1 id="Dr"><a href="/">Lnk</a></h1><div id="description"><p></p></div><div id="social-links"><a class="social" target="_blank" rel="noopener" href="https://github.com/Lnkqwq"><i class="fab fa-github" alt="GitHub"></i></a><a class="social" href="3403583728@qq.com"><i class="fa fa-envelope" alt="E-Mail"></i></a></div></div><div id="aside-block"><div id="toc-div"><h1>Catalog</h1><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#main%E5%87%BD%E6%95%B0"><span class="toc-number">1.</span> <span class="toc-text"> main函数</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E6%8E%A7%E5%88%B6"><span class="toc-number">2.</span> <span class="toc-text"> 条件控制</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-%E5%9F%BA%E7%A1%80%E9%80%89%E6%8B%A9%E7%BB%93%E6%9E%84"><span class="toc-number">2.1.</span> <span class="toc-text"> 一、基础选择结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-%E5%BE%AA%E7%8E%AF%E7%BB%93%E6%9E%84"><span class="toc-number">2.2.</span> <span class="toc-text"> 二、循环结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89-%E5%88%86%E6%94%AF%E7%BB%93%E6%9E%84"><span class="toc-number">2.3.</span> <span class="toc-text"> 三、分支结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B-%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toc-number">2.4.</span> <span class="toc-text"> 四、流程控制关键字</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94-%E6%9D%A1%E4%BB%B6%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%8A%80%E5%B7%A7"><span class="toc-number">2.5.</span> <span class="toc-text"> 五、条件表达式技巧</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD-bool"><span class="toc-number">2.6.</span> <span class="toc-text"> 六、bool</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AE%97%E6%B3%95"><span class="toc-number">3.</span> <span class="toc-text"> 算法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%92%E5%BA%8F"><span class="toc-number">3.1.</span> <span class="toc-text"> 排序</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%92%E6%B3%A1%E6%8E%92%E5%BA%8F"><span class="toc-number">3.1.1.</span> <span class="toc-text"> 冒泡排序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%89%E6%8B%A9%E6%8E%92%E5%BA%8F"><span class="toc-number">3.1.2.</span> <span class="toc-text"> 选择排序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F"><span class="toc-number">3.1.3.</span> <span class="toc-text"> 插入排序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F"><span class="toc-number">3.1.4.</span> <span class="toc-text"> 快速排序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F"><span class="toc-number">3.1.5.</span> <span class="toc-text"> 归并排序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A0%86%E6%8E%92%E5%BA%8F"><span class="toc-number">3.1.6.</span> <span class="toc-text"> 堆排序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A1%E6%95%B0%E6%8E%92%E5%BA%8F"><span class="toc-number">3.1.7.</span> <span class="toc-text"> 计数排序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%95%B0%E6%8E%92%E5%BA%8F"><span class="toc-number">3.1.8.</span> <span class="toc-text"> 基数排序</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%90%9C%E7%B4%A2"><span class="toc-number">3.2.</span> <span class="toc-text"> 搜索</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BA%BF%E6%80%A7%E6%90%9C%E7%B4%A2"><span class="toc-number">3.2.1.</span> <span class="toc-text"> 线性搜索</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E5%88%86%E6%90%9C%E7%B4%A2"><span class="toc-number">3.2.2.</span> <span class="toc-text"> 二分搜索</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%92%E5%80%BC%E6%90%9C%E7%B4%A2"><span class="toc-number">3.2.3.</span> <span class="toc-text"> 插值搜索</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%B3%E8%A1%A8"><span class="toc-number">3.2.4.</span> <span class="toc-text"> 跳表</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BC%82%E6%88%96%E6%93%8D%E4%BD%9Cxor"><span class="toc-number">4.</span> <span class="toc-text"> 异或操作（XOR）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BE%93%E5%85%A5%E4%B8%8E%E8%BE%93%E5%87%BA"><span class="toc-number">5.</span> <span class="toc-text"> 输入与输出</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BE%93%E5%85%A5"><span class="toc-number">5.1.</span> <span class="toc-text"> 输入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BE%93%E5%87%BA"><span class="toc-number">5.2.</span> <span class="toc-text"> 输出</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%86%85%E7%BD%AE%E5%87%BD%E6%95%B0"><span class="toc-number">6.</span> <span class="toc-text"> 内置函数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%A4%84%E7%90%86string"><span class="toc-number">6.1.</span> <span class="toc-text"> 一、字符串处理（）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-%E5%AD%97%E7%AC%A6%E5%A4%84%E7%90%86cctype"><span class="toc-number">6.2.</span> <span class="toc-text"> 二、字符处理（）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89-%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E5%A4%84%E7%90%86iostream"><span class="toc-number">6.3.</span> <span class="toc-text"> 三、输入输出处理（）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B-%E6%95%B0%E5%AD%A6%E5%87%BD%E6%95%B0cmath"><span class="toc-number">6.4.</span> <span class="toc-text"> 四、数学函数（）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94-%E7%AE%97%E6%B3%95%E5%87%BD%E6%95%B0algorithm"><span class="toc-number">6.5.</span> <span class="toc-text"> 五、算法函数（）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD-%E5%AE%9E%E7%94%A8%E5%B7%A5%E5%85%B7%E5%87%BD%E6%95%B0"><span class="toc-number">6.6.</span> <span class="toc-text"> 六、实用工具函数</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96%E6%96%87%E6%9C%AC%E6%96%87%E4%BB%B6"><span class="toc-number">7.</span> <span class="toc-text"> 读取文本文件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E5%9F%BA%E7%A1%80%E8%AF%BB%E5%8F%96%E6%95%B4%E4%B8%AA%E6%96%87%E4%BB%B6"><span class="toc-number">7.1.</span> <span class="toc-text"> 最基础：读取整个文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96%E6%95%B4%E4%B8%AA%E6%96%87%E4%BB%B6%E5%88%B0%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%80%E6%AC%A1%E6%80%A7"><span class="toc-number">7.2.</span> <span class="toc-text"> 读取整个文件到字符串（一次性）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96%E7%9D%80%E8%89%B2%E5%99%A8%E6%96%87%E4%BB%B6%E7%9A%84%E5%AE%8C%E6%95%B4%E7%A4%BA%E4%BE%8B"><span class="toc-number">7.3.</span> <span class="toc-text"> 读取着色器文件的完整示例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6"><span class="toc-number">7.4.</span> <span class="toc-text"> 读取二进制文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E7%94%A8%E5%B7%A5%E5%85%B7%E5%87%BD%E6%95%B0%E9%9B%86%E5%90%88"><span class="toc-number">7.5.</span> <span class="toc-text"> 实用工具函数集合</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%8C%87%E9%92%88"><span class="toc-number">8.</span> <span class="toc-text"> 指针</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-%E6%8C%87%E9%92%88%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5"><span class="toc-number">8.1.</span> <span class="toc-text"> 一、指针基础概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-%E6%8C%87%E9%92%88%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="toc-number">8.2.</span> <span class="toc-text"> 二、指针基本操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89-%E6%8C%87%E9%92%88%E4%B8%8E%E6%95%B0%E7%BB%84"><span class="toc-number">8.3.</span> <span class="toc-text"> 三、指针与数组</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B-%E6%8C%87%E9%92%88%E4%B8%8E%E5%87%BD%E6%95%B0"><span class="toc-number">8.4.</span> <span class="toc-text"> 四、指针与函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94-%E5%8A%A8%E6%80%81%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86"><span class="toc-number">8.5.</span> <span class="toc-text"> 五、动态内存管理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD-%E7%89%B9%E6%AE%8A%E6%8C%87%E9%92%88%E7%B1%BB%E5%9E%8B"><span class="toc-number">8.6.</span> <span class="toc-text"> 六、特殊指针类型</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BC%95%E7%94%A8"><span class="toc-number">9.</span> <span class="toc-text"> 引用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-%E5%BC%95%E7%94%A8%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5"><span class="toc-number">9.1.</span> <span class="toc-text"> 一、引用基础概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-%E5%BC%95%E7%94%A8%E5%A3%B0%E6%98%8E%E5%92%8C%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-number">9.2.</span> <span class="toc-text"> 二、引用声明和初始化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89-%E5%BC%95%E7%94%A8%E4%B8%8E%E5%87%BD%E6%95%B0"><span class="toc-number">9.3.</span> <span class="toc-text"> 三、引用与函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B-%E5%BC%95%E7%94%A8%E4%B8%8E%E6%8C%87%E9%92%88%E5%AF%B9%E6%AF%94"><span class="toc-number">9.4.</span> <span class="toc-text"> 四、引用与指针对比</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94-%E5%BC%95%E7%94%A8%E9%AB%98%E7%BA%A7%E7%94%A8%E6%B3%95"><span class="toc-number">9.5.</span> <span class="toc-text"> 五、引用高级用法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD-%E5%BC%95%E7%94%A8%E5%9C%A8%E7%B1%BB%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8"><span class="toc-number">9.6.</span> <span class="toc-text"> 六、引用在类中的应用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83-%E5%BC%95%E7%94%A8%E5%B8%B8%E8%A7%81%E9%99%B7%E9%98%B1"><span class="toc-number">9.7.</span> <span class="toc-text"> 七、引用常见陷阱</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%80%92%E5%BD%92"><span class="toc-number">10.</span> <span class="toc-text"> 递归</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-%E4%BB%80%E4%B9%88%E6%98%AF%E9%80%92%E5%BD%92"><span class="toc-number">10.1.</span> <span class="toc-text"> 一、什么是递归？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-%E9%80%92%E5%BD%92%E7%9A%84%E4%B8%A4%E4%B8%AA%E6%A0%B8%E5%BF%83%E8%A6%81%E7%B4%A0"><span class="toc-number">10.2.</span> <span class="toc-text"> 二、递归的两个核心要素</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89-%E9%80%92%E5%BD%92%E7%9A%84%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B"><span class="toc-number">10.3.</span> <span class="toc-text"> 三、递归的执行过程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B-%E9%80%92%E5%BD%92%E7%9A%84%E6%A0%B8%E5%BF%83%E8%AE%A4%E7%9F%A5%E6%9C%80%E9%9A%BE%E4%BD%86%E4%B9%9F%E6%9C%80%E9%87%8D%E8%A6%81"><span class="toc-number">10.4.</span> <span class="toc-text"> 四、递归的核心认知（最难但也最重要）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD-%E9%80%92%E5%BD%92-vs-%E5%BE%AA%E7%8E%AF"><span class="toc-number">10.5.</span> <span class="toc-text"> 六、递归 vs 循环</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83-%E5%B8%B8%E8%A7%81%E8%AF%AF%E5%8C%BA"><span class="toc-number">10.6.</span> <span class="toc-text"> 七、常见误区</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB-%E5%BF%AB%E6%8E%92%E4%B8%AD%E7%9A%84%E9%80%92%E5%BD%92%E5%AE%8C%E7%BE%8E%E6%A1%88%E4%BE%8B"><span class="toc-number">10.7.</span> <span class="toc-text"> 八、快排中的递归（完美案例）</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#struct-class"><span class="toc-number">11.</span> <span class="toc-text"> Struct、Class</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E4%B8%8E%E5%8C%BA%E5%88%AB"><span class="toc-number">11.1.</span> <span class="toc-text"> 一、基本概念与区别</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-%E7%BB%93%E6%9E%84%E4%BD%93struct%E7%9A%84%E5%8A%9F%E8%83%BD%E4%B8%8E%E4%BD%BF%E7%94%A8"><span class="toc-number">11.2.</span> <span class="toc-text"> 二、结构体(struct)的功能与使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89-%E7%B1%BBclass%E7%9A%84%E5%8A%9F%E8%83%BD%E4%B8%8E%E4%BD%BF%E7%94%A8"><span class="toc-number">11.3.</span> <span class="toc-text"> 三、类(class)的功能与使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B-%E5%AE%9E%E9%99%85%E9%80%89%E6%8B%A9%E6%8C%87%E5%8D%97"><span class="toc-number">11.4.</span> <span class="toc-text"> 四、实际选择指南</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#vector-array"><span class="toc-number">12.</span> <span class="toc-text"> vector、array</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-array%E6%95%B0%E7%BB%84%E5%9F%BA%E7%A1%80"><span class="toc-number">12.1.</span> <span class="toc-text"> 一、Array（数组）基础</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-vector%E5%90%91%E9%87%8F%E5%9F%BA%E7%A1%80"><span class="toc-number">12.2.</span> <span class="toc-text"> 二、Vector（向量）基础</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89-%E6%A0%B8%E5%BF%83%E5%8C%BA%E5%88%AB%E5%AF%B9%E6%AF%94"><span class="toc-number">12.3.</span> <span class="toc-text"> 三、核心区别对比</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B-%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C%E8%AF%A6%E8%A7%A3"><span class="toc-number">12.4.</span> <span class="toc-text"> 四、常用操作详解</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B7%A6%E5%80%BC%E5%92%8C%E5%8F%B3%E5%80%BC"><span class="toc-number">13.</span> <span class="toc-text"> 左值和右值</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">13.1.</span> <span class="toc-text"> 一、基本概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-%E5%88%86%E7%B1%BB%E8%AF%A6%E8%A7%A3"><span class="toc-number">13.2.</span> <span class="toc-text"> 二、分类详解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89-%E5%AE%9E%E9%99%85%E4%BB%A3%E7%A0%81%E5%88%A4%E6%96%AD"><span class="toc-number">13.3.</span> <span class="toc-text"> 三、实际代码判断</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B-%E5%B7%A6%E5%80%BC%E5%BC%95%E7%94%A8-vs-%E5%8F%B3%E5%80%BC%E5%BC%95%E7%94%A8"><span class="toc-number">13.4.</span> <span class="toc-text"> 四、左值引用 vs 右值引用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94-%E7%A7%BB%E5%8A%A8%E8%AF%AD%E4%B9%89%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E6%9C%89%E5%8F%B3%E5%80%BC%E5%BC%95%E7%94%A8"><span class="toc-number">13.5.</span> <span class="toc-text"> 五、移动语义（为什么要有右值引用？）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD-stdmove-%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-number">13.6.</span> <span class="toc-text"> 六、std::move 的作用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83-%E5%AE%9E%E9%99%85%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">13.7.</span> <span class="toc-text"> 七、实际应用场景</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB-%E5%BF%AB%E9%80%9F%E5%88%A4%E6%96%AD%E6%8A%80%E5%B7%A7"><span class="toc-number">13.8.</span> <span class="toc-text"> 八、快速判断技巧</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%80%80%E5%8C%96"><span class="toc-number">14.</span> <span class="toc-text"> 退化</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-%E4%BB%80%E4%B9%88%E6%98%AF%E7%B1%BB%E5%9E%8B%E9%80%80%E5%8C%96"><span class="toc-number">14.1.</span> <span class="toc-text"> 一、什么是类型退化？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-%E9%80%80%E5%8C%96%E7%9A%84%E4%B8%89%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%83%85%E5%86%B5"><span class="toc-number">14.2.</span> <span class="toc-text"> 二、退化的三种主要情况</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89-%E6%95%B0%E7%BB%84%E9%80%80%E5%8C%96%E7%9A%84%E8%AF%A6%E7%BB%86%E5%88%86%E6%9E%90"><span class="toc-number">14.3.</span> <span class="toc-text"> 三、数组退化的详细分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B-%E5%A6%82%E4%BD%95%E9%98%B2%E6%AD%A2%E9%80%80%E5%8C%96"><span class="toc-number">14.4.</span> <span class="toc-text"> 四、如何防止退化？</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BC%BA%E5%88%B6%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2"><span class="toc-number">15.</span> <span class="toc-text"> 强制类型转换</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E5%BC%BA%E5%88%B6%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2"><span class="toc-number">15.1.</span> <span class="toc-text"> 一、为什么需要强制类型转换？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-static_cast%E6%9C%80%E5%B8%B8%E7%94%A8%E7%9A%84%E8%BD%AC%E6%8D%A2"><span class="toc-number">15.2.</span> <span class="toc-text"> 二、static_cast：最常用的转换</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89-dynamic_cast%E5%AE%89%E5%85%A8%E7%9A%84%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2"><span class="toc-number">15.3.</span> <span class="toc-text"> 三、dynamic_cast：安全的类型转换</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B-const_cast%E4%BF%AE%E6%94%B9%E5%B8%B8%E9%87%8F%E6%80%A7"><span class="toc-number">15.4.</span> <span class="toc-text"> 四、const_cast：修改常量性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94-reinterpret_cast%E6%9C%80%E5%8D%B1%E9%99%A9%E7%9A%84%E8%BD%AC%E6%8D%A2"><span class="toc-number">15.5.</span> <span class="toc-text"> 五、reinterpret_cast：最危险的转换</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#new-delete"><span class="toc-number">16.</span> <span class="toc-text"> new、delete</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E5%8A%A8%E6%80%81%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86"><span class="toc-number">16.1.</span> <span class="toc-text"> 一、基本概念：动态内存管理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8E%E6%99%AE%E9%80%9A%E5%8F%98%E9%87%8F%E7%9A%84%E5%8C%BA%E5%88%AB%E6%A0%88%E5%86%85%E5%AD%98%E8%87%AA%E5%8A%A8-vs-%E5%A0%86%E5%86%85%E5%AD%98%E6%89%8B%E5%8A%A8"><span class="toc-number">16.2.</span> <span class="toc-text"> ​
与普通变量的区别
栈内存（自动）             vs   堆内存（手动）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-new-%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95"><span class="toc-number">16.3.</span> <span class="toc-text"> 二、new 的基本用法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89-delete-%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95"><span class="toc-number">16.4.</span> <span class="toc-text"> 三、delete 的基本用法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B-%E5%B8%B8%E8%A7%81%E9%94%99%E8%AF%AF%E4%B8%8E%E9%99%B7%E9%98%B1"><span class="toc-number">16.5.</span> <span class="toc-text"> 四、常见错误与陷阱</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%82%AC%E7%A9%BA%E6%8C%87%E9%92%88%E9%97%AE%E9%A2%98"><span class="toc-number">16.6.</span> <span class="toc-text"> 悬空指针问题</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#string%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">17.</span> <span class="toc-text"> string字符串</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-string-%E6%98%AF%E4%BB%80%E4%B9%88%E4%B8%BA%E4%BB%80%E4%B9%88%E9%87%8D%E8%A6%81"><span class="toc-number">17.1.</span> <span class="toc-text"> 一、string 是什么？为什么重要？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-string-%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="toc-number">17.2.</span> <span class="toc-text"> 二、string 基本操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89-%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%AE%BF%E9%97%AE%E5%92%8C%E4%BF%AE%E6%94%B9"><span class="toc-number">17.3.</span> <span class="toc-text"> 三、字符串访问和修改</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B-%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%9F%A5%E8%AF%A2%E6%93%8D%E4%BD%9C"><span class="toc-number">17.4.</span> <span class="toc-text"> 四、字符串查询操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94-%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%AE%B9%E9%87%8F%E5%92%8C%E5%86%85%E5%AD%98"><span class="toc-number">17.5.</span> <span class="toc-text"> 五、字符串容量和内存</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD-string-%E4%B8%8E%E6%95%B0%E5%80%BC%E8%BD%AC%E6%8D%A2"><span class="toc-number">17.6.</span> <span class="toc-text"> 六、string 与数值转换</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83-%E5%AE%9E%E7%94%A8%E5%87%BD%E6%95%B0%E5%92%8C%E7%AE%97%E6%B3%95"><span class="toc-number">17.7.</span> <span class="toc-text"> 七、实用函数和算法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB-string-%E4%B8%8E%E6%B5%81"><span class="toc-number">17.8.</span> <span class="toc-text"> 八、string 与流</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B9%9D-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%8A%80%E5%B7%A7"><span class="toc-number">17.9.</span> <span class="toc-text"> 九、性能优化技巧</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81-%E5%B8%B8%E8%A7%81%E9%99%B7%E9%98%B1"><span class="toc-number">17.10.</span> <span class="toc-text"> 十、常见陷阱</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E9%87%8D%E8%BD%BD"><span class="toc-number">18.</span> <span class="toc-text"> 函数重载</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-%E4%BB%80%E4%B9%88%E6%98%AF%E5%87%BD%E6%95%B0%E9%87%8D%E8%BD%BD"><span class="toc-number">18.1.</span> <span class="toc-text"> 一、什么是函数重载？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-%E9%87%8D%E8%BD%BD%E7%9A%84%E5%88%A4%E5%AE%9A%E8%A7%84%E5%88%99"><span class="toc-number">18.2.</span> <span class="toc-text"> 二、重载的判定规则</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89-%E9%87%8D%E8%BD%BD-vs-%E9%BB%98%E8%AE%A4%E5%8F%82%E6%95%B0"><span class="toc-number">18.3.</span> <span class="toc-text"> 三、重载 vs 默认参数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B-%E9%87%8D%E8%BD%BD%E7%9A%84%E5%8C%B9%E9%85%8D%E8%BF%87%E7%A8%8B"><span class="toc-number">18.4.</span> <span class="toc-text"> 四、重载的匹配过程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94-%E5%B8%B8%E8%A7%81%E7%94%A8%E9%80%94"><span class="toc-number">18.5.</span> <span class="toc-text"> 五、常见用途</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD-%E5%B8%B8%E8%A7%81%E9%99%B7%E9%98%B1"><span class="toc-number">18.6.</span> <span class="toc-text"> 六、常见陷阱</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83-%E5%BD%A2%E8%B1%A1%E7%90%86%E8%A7%A3"><span class="toc-number">18.7.</span> <span class="toc-text"> 七、形象理解</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#const"><span class="toc-number">19.</span> <span class="toc-text"> const</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-const-%E5%9F%BA%E7%A1%80%E5%88%9B%E5%BB%BA%E5%B8%B8%E9%87%8F"><span class="toc-number">19.1.</span> <span class="toc-text"> 一、const 基础：创建常量</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-const-%E4%B8%8E%E6%8C%87%E9%92%88%E9%87%8D%E8%A6%81"><span class="toc-number">19.2.</span> <span class="toc-text"> 二、const 与指针（重要！）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89-const-%E4%B8%8E%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0"><span class="toc-number">19.3.</span> <span class="toc-text"> 三、const 与函数参数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B-const-%E6%88%90%E5%91%98%E5%87%BD%E6%95%B0%E7%B1%BB%E7%9A%84%E6%A0%B8%E5%BF%83%E7%89%B9%E6%80%A7"><span class="toc-number">19.4.</span> <span class="toc-text"> 四、const 成员函数（类的核心特性）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94-const-%E4%B8%8E%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="toc-number">19.5.</span> <span class="toc-text"> 五、const 与返回值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD-constexprc11-%E7%BC%96%E8%AF%91%E6%97%B6%E5%B8%B8%E9%87%8F"><span class="toc-number">19.6.</span> <span class="toc-text"> 六、constexpr（C++11 编译时常量）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83-mutable-%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toc-number">19.7.</span> <span class="toc-text"> 七、mutable 关键字</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB-%E5%AE%9E%E9%99%85%E5%BA%94%E7%94%A8%E6%8C%87%E5%8D%97"><span class="toc-number">19.8.</span> <span class="toc-text"> 八、实际应用指南</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#static"><span class="toc-number">20.</span> <span class="toc-text"> Static</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E7%A7%8D%E4%B8%8D%E5%90%8C%E7%94%A8%E6%B3%95"><span class="toc-number">20.1.</span> <span class="toc-text"> 三种不同用法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%9F%E5%8A%A8%E8%AE%B0%E5%BF%86%E6%B3%95"><span class="toc-number">20.2.</span> <span class="toc-text"> 生动记忆法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E9%94%AE%E7%90%86%E8%A7%A3%E7%82%B9"><span class="toc-number">20.3.</span> <span class="toc-text"> 关键理解点</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%8F"><span class="toc-number">21.</span> <span class="toc-text"> 宏</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-%E4%BB%80%E4%B9%88%E6%98%AF%E5%AE%8F"><span class="toc-number">21.1.</span> <span class="toc-text"> 一、什么是宏？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95"><span class="toc-number">21.2.</span> <span class="toc-text"> 二、基本用法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89-%E7%89%B9%E6%AE%8A%E7%AC%A6%E5%8F%B7"><span class="toc-number">21.3.</span> <span class="toc-text"> 三、特殊符号</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B-%E9%A2%84%E5%AE%9A%E4%B9%89%E5%AE%8F"><span class="toc-number">21.4.</span> <span class="toc-text"> 四、预定义宏</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%86%85%E8%81%94%E5%87%BD%E6%95%B0"><span class="toc-number">22.</span> <span class="toc-text"> 内联函数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-%E4%BB%80%E4%B9%88%E6%98%AF%E5%86%85%E8%81%94%E5%87%BD%E6%95%B0"><span class="toc-number">22.1.</span> <span class="toc-text"> 一、什么是内联函数？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-%E4%B8%89%E7%A7%8D%E5%86%99%E6%B3%95"><span class="toc-number">22.2.</span> <span class="toc-text"> 二、三种写法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89-%E7%8E%B0%E4%BB%A3-c-%E7%9A%84%E6%89%A9%E5%B1%95"><span class="toc-number">22.3.</span> <span class="toc-text"> 三、现代 C++ 的扩展</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9E%90%E6%9E%84%E5%87%BD%E6%95%B0"><span class="toc-number">23.</span> <span class="toc-text"> 析构函数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-%E4%BB%80%E4%B9%88%E6%98%AF%E6%9E%90%E6%9E%84%E5%87%BD%E6%95%B0"><span class="toc-number">23.1.</span> <span class="toc-text"> 一、什么是析构函数？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95%E5%92%8C%E7%89%B9%E6%80%A7"><span class="toc-number">23.2.</span> <span class="toc-text"> 二、基本语法和特性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89-%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E8%B0%83%E7%94%A8%E6%9E%90%E6%9E%84%E5%87%BD%E6%95%B0"><span class="toc-number">23.3.</span> <span class="toc-text"> 三、什么时候调用析构函数？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B-%E6%9E%90%E6%9E%84%E5%87%BD%E6%95%B0%E7%9A%84%E5%AE%9E%E9%99%85%E5%BA%94%E7%94%A8"><span class="toc-number">23.4.</span> <span class="toc-text"> 四、析构函数的实际应用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94-raii%E6%A8%A1%E5%BC%8F%E6%9E%90%E6%9E%84%E5%87%BD%E6%95%B0%E7%9A%84%E5%93%B2%E5%AD%A6"><span class="toc-number">23.5.</span> <span class="toc-text"> 五、RAII模式（析构函数的哲学）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD-%E7%BB%A7%E6%89%BF%E4%B8%AD%E7%9A%84%E6%9E%90%E6%9E%84%E5%87%BD%E6%95%B0"><span class="toc-number">23.6.</span> <span class="toc-text"> 六、继承中的析构函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB-%E6%9E%90%E6%9E%84%E5%87%BD%E6%95%B0%E7%9A%84%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F"><span class="toc-number">23.7.</span> <span class="toc-text"> 八、析构函数的执行顺序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B9%9D-%E5%B8%B8%E8%A7%81%E9%94%99%E8%AF%AF%E5%92%8C%E9%99%B7%E9%98%B1"><span class="toc-number">23.8.</span> <span class="toc-text"> 九、常见错误和陷阱</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#lambda"><span class="toc-number">24.</span> <span class="toc-text"> Lambda</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-%E4%BB%80%E4%B9%88%E6%98%AFlambda"><span class="toc-number">24.1.</span> <span class="toc-text"> 一、什么是Lambda？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-lambda%E7%9A%84%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95"><span class="toc-number">24.2.</span> <span class="toc-text"> 二、Lambda的基本语法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89-%E6%8D%95%E8%8E%B7%E5%88%97%E8%A1%A8%E8%AF%A6%E8%A7%A3"><span class="toc-number">24.3.</span> <span class="toc-text"> 三、捕获列表详解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94-lambda%E7%9A%84%E7%B1%BB%E5%9E%8B%E5%92%8C%E5%AD%98%E5%82%A8"><span class="toc-number">24.4.</span> <span class="toc-text"> 五、Lambda的类型和存储</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD-lambda%E4%B8%8E%E5%87%BD%E6%95%B0%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AF%B9%E6%AF%94"><span class="toc-number">24.5.</span> <span class="toc-text"> 六、Lambda与函数对象的对比</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83-lambda%E7%9A%84%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7"><span class="toc-number">24.6.</span> <span class="toc-text"> 七、Lambda的高级特性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB-%E5%B8%B8%E8%A7%81%E9%99%B7%E9%98%B1%E5%92%8C%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc-number">24.7.</span> <span class="toc-text"> 八、常见陷阱和最佳实践</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88"><span class="toc-number">25.</span> <span class="toc-text"> 智能指针</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88"><span class="toc-number">25.1.</span> <span class="toc-text"> 一、为什么需要智能指针？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-%E4%B8%89%E7%A7%8D%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88%E5%AF%B9%E6%AF%94"><span class="toc-number">25.2.</span> <span class="toc-text"> 二、三种智能指针对比</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89-unique_ptr%E7%8B%AC%E5%8D%A0%E6%8C%87%E9%92%88"><span class="toc-number">25.3.</span> <span class="toc-text"> 三、unique_ptr（独占指针）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B-shared_ptr%E5%85%B1%E4%BA%AB%E6%8C%87%E9%92%88"><span class="toc-number">25.4.</span> <span class="toc-text"> 四、shared_ptr（共享指针）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94-weak_ptr%E5%BC%B1%E6%8C%87%E9%92%88"><span class="toc-number">25.5.</span> <span class="toc-text"> 五、weak_ptr（弱指针）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD-%E6%80%A7%E8%83%BD%E8%80%83%E8%99%91"><span class="toc-number">25.6.</span> <span class="toc-text"> 六、性能考虑</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB-%E5%B8%B8%E8%A7%81%E9%94%99%E8%AF%AF%E5%92%8C%E9%99%B7%E9%98%B1"><span class="toc-number">25.7.</span> <span class="toc-text"> 八、常见错误和陷阱</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B9%9D-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E6%80%BB%E7%BB%93"><span class="toc-number">25.8.</span> <span class="toc-text"> 九、最佳实践总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%93%BE%E8%A1%A8"><span class="toc-number">26.</span> <span class="toc-text"> 链表</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5%E4%BB%80%E4%B9%88%E6%98%AF%E9%93%BE%E8%A1%A8"><span class="toc-number">26.1.</span> <span class="toc-text"> 一、核心概念：什么是链表？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-stl%E4%B8%AD%E7%9A%84%E9%93%BE%E8%A1%A8%E5%B7%A5%E4%BD%9C%E4%B8%AD%E5%AE%9E%E9%99%85%E7%94%A8%E7%9A%84"><span class="toc-number">26.2.</span> <span class="toc-text"> 二、STL中的链表（工作中实际用的）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89-%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0%E9%93%BE%E8%A1%A8"><span class="toc-number">26.3.</span> <span class="toc-text"> 三、手动实现链表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B-%E9%93%BE%E8%A1%A8%E7%BB%8F%E5%85%B8%E9%A2%98%E5%BF%85%E9%A1%BB%E6%8E%8C%E6%8F%A1"><span class="toc-number">26.4.</span> <span class="toc-text"> 四、链表经典题（必须掌握）</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BB%A7%E6%89%BF%E5%A4%9A%E6%80%81"><span class="toc-number">27.</span> <span class="toc-text"> 继承&amp;多态</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-%E7%BB%A7%E6%89%BF%E5%9F%BA%E7%A1%80"><span class="toc-number">27.1.</span> <span class="toc-text"> 一、继承基础</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-%E5%87%BD%E6%95%B0%E9%87%8D%E5%86%99%E4%B8%8E%E9%9A%90%E8%97%8F"><span class="toc-number">27.2.</span> <span class="toc-text"> 二、函数重写与隐藏</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89-%E5%A4%9A%E6%80%81%E5%9F%BA%E7%A1%80"><span class="toc-number">27.3.</span> <span class="toc-text"> 三、多态基础</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B-%E8%99%9A%E5%87%BD%E6%95%B0%E8%A1%A8vtable%E6%9C%BA%E5%88%B6"><span class="toc-number">27.4.</span> <span class="toc-text"> 四、虚函数表（vtable）机制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94-%E5%A4%9A%E9%87%8D%E7%BB%A7%E6%89%BF%E4%B8%8E%E8%99%9A%E7%BB%A7%E6%89%BF"><span class="toc-number">27.5.</span> <span class="toc-text"> 五、多重继承与虚继承</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD-dynamic_cast%E4%B8%8Ertti"><span class="toc-number">27.6.</span> <span class="toc-text"> 六、dynamic_cast与RTTI</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B8%AD%E7%9A%84%E5%A4%9A%E6%80%81%E5%BA%94%E7%94%A8"><span class="toc-number">27.7.</span> <span class="toc-text"> 七、设计模式中的多态应用</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%A7%BB%E5%8A%A8%E8%AF%AD%E4%B9%89"><span class="toc-number">28.</span> <span class="toc-text"> 移动语义</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%8C%E7%BE%8E%E8%BD%AC%E5%8F%91"><span class="toc-number">29.</span> <span class="toc-text"> 完美转发</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B%E6%8E%A8%E5%AF%BC"><span class="toc-number">30.</span> <span class="toc-text"> 类型推导</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E5%8C%96%E7%BB%91%E5%AE%9A"><span class="toc-number">31.</span> <span class="toc-text"> 结构化绑定</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#vcpkg"><span class="toc-number">32.</span> <span class="toc-text"> vcpkg</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84"><span class="toc-number">32.1.</span> <span class="toc-text"> 目录结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84"><span class="toc-number">32.1.1.</span> <span class="toc-text"> 📚  核心目录结构</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C"><span class="toc-number">32.2.</span> <span class="toc-text"> 操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E6%96%B9ports"><span class="toc-number">32.2.1.</span> <span class="toc-text"> 配方：Ports</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8B%89%E5%8F%96"><span class="toc-number">32.2.2.</span> <span class="toc-text"> 拉取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%AF%91%E9%93%BE%E6%8E%A5"><span class="toc-number">32.2.3.</span> <span class="toc-text"> 编译&amp;链接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#vs%E9%93%BE%E6%8E%A5"><span class="toc-number">32.2.4.</span> <span class="toc-text"> VS链接</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#cmake"><span class="toc-number">33.</span> <span class="toc-text"> CMake</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#cmake%E4%BB%8B%E7%BB%8D"><span class="toc-number">33.1.</span> <span class="toc-text"> CMake介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cmakeliststext"><span class="toc-number">33.2.</span> <span class="toc-text"> CMakeLists.text</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#cmake%E8%AF%AD%E6%B3%95"><span class="toc-number">34.</span> <span class="toc-text"> cmake语法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%99%85%E4%BD%BF%E7%94%A8"><span class="toc-number">34.1.</span> <span class="toc-text"> 实际使用</span></a></li></ol></li></ol></div></div><footer><nobr>Published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr> by <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside></main><canvas id="canvas-dust"></canvas></body></html>
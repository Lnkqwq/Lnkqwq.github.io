<!DOCTYPE html><html lang="en" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>网络通信 | Hexo</title><meta name="description" content="应用层  一、应用层是干什么的？ 核心职责：让计算机理解人类意图 1234567应用层 &#x3D; 网络应用的&quot;大脑&quot;你的需求：看网页、发邮件、传文件↓应用层翻译成：HTTP请求、SMTP命令、FTP操作↓网络传输  二、应用层协议家族 2.1 Web通信：HTTP&#x2F;HTTPS 12345678910111213# HTTP就像&quot;明信片&quot; - 所有人都能看到内容G">
<meta property="og:type" content="article">
<meta property="og:title" content="网络通信">
<meta property="og:url" content="http://example.com/2026/02/27/%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="应用层  一、应用层是干什么的？ 核心职责：让计算机理解人类意图 1234567应用层 &#x3D; 网络应用的&quot;大脑&quot;你的需求：看网页、发邮件、传文件↓应用层翻译成：HTTP请求、SMTP命令、FTP操作↓网络传输  二、应用层协议家族 2.1 Web通信：HTTP&#x2F;HTTPS 12345678910111213# HTTP就像&quot;明信片&quot; - 所有人都能看到内容G">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2026-02-27T05:01:04.000Z">
<meta property="article:modified_time" content="2026-02-27T05:13:36.064Z">
<meta property="article:author" content="Lnk">
<meta name="twitter:card" content="summary"><link rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="preload" as="font" crossorigin="anonymous" href="/font/Bender.ttf"><link rel="preload" as="font" crossorigin="anonymous" href="/font/BenderLight.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="/font/JetBrainsMono-Regular.woff2"><link rel="stylesheet" href="/css/arknights.css"><style>@font-face {
  font-family: Bender;
  src: local('Bender'), url("/font/Bender.ttf"), url("/font/Bender.otf");
}
@font-face {
  font-family: BenderLight;
  src: local('BenderLight'), url("/font/BenderLight.woff2") format('woff2');
}
@font-face {
  font-family: 'JetBrains Mono';
  src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}
</style><meta name="page-config" content="{&quot;code_fold&quot;:null}"><script class="pjax-js">var config = {"root":"/","code_fold":15,"search":{"preload":false,"activeHolder":"Enter here","blurHolder":"Search","noResult":"Data \"$0\" not found"},"code":{"codeInfo":"$0 - $1 lines","copy":"copy"}};
var page_config = {
  code_fold: null
};
function updatePageConfig() {
  var newPageConfig = document.querySelector('meta[name="page-config"]');
  if (newPageConfig) {
    page_config = JSON.parse(newPageConfig.content);
  }
}
document.addEventListener('pjax:complete', function() { updatePageConfig(); });
updatePageConfig();</script><link type="text/css" rel="stylesheet" href="/lib/encrypt/hbe.style.css"><script src="//unpkg.com/mermaid@11.12.2/dist/mermaid.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/MathJax.js"></script><script>MathJax.Hub.Config({
 menuSettings: {
   zoom: "None"
 },
 showMathMenu: false,
 jax: ["input/TeX","output/CommonHTML"],
 extensions: ["tex2jax.js"],
 TeX: {
   extensions: ["AMSmath.js","AMSsymbols.js"],
   equationNumbers: {
     autoNumber: "AMS"
   }
 },
 tex2jax: {
   inlineMath: [["\\(", "\\)"]],
   displayMath: [["\\[", "\\]"]]
 }
});</script><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/css/all.min.css"><script>if (window.localStorage.getItem('theme-mode') === 'light')
 document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark')
 document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.woff2") format('woff2');
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><style>:root {
 --dark-background: url('/images/BK.PNG');
 --light-background: url('/images/BK.PNG');
 --theme-encrypt-confirm: 'confirm'
}</style><script defer src="/js/arknights.js"></script><script defer src="/js/search.js"></script><script defer type="module">import mermaid from '//unpkg.com/mermaid@11.12.2/dist/mermaid.esm.min.mjs';
window.mermaid = mermaid;
code.paintMermaid();
</script><script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/MathJax.js"></script><script>MathJax.Hub.Config({
  menuSettings: {
    zoom: "None"
  },
  showMathMenu: false,
  jax: ["input/TeX","output/CommonHTML"],
  extensions: ["tex2jax.js"],
  TeX: {
    extensions: ["AMSmath.js","AMSsymbols.js"],
    equationNumbers: {
      autoNumber: "AMS"
    }
  },
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]]
  }
});
</script><script async src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script async src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script async src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script async src="/lib/encrypt/hbe.js"></script><script async src="/js/pjax.js"></script><script class="pjax-js">reset= () => {document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js','data-pjax','.vercount','meta[name=page-config]'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script><script class="pjax-js">reset= () => {window.giscusSettings = {
 repo: 'Lnkqwq/Lnkqwq.github.io',
 repoId: 'R_kgDORZSSAA',
 category: '',
 categoryId: '',
 mapping: 'pathname',
 strict: '0',
 reactionsEnabled: '1',
 emitMetadata: '0',
 inputPosition: 'bottom',
 lang: 'zh-CN',
 crossorigin: 'anonymous' , loading: 'lazy'};window.giscusThemeConfig = { theme: 'preferred_color_scheme' };MathJax.Hub.Queue(["Typeset", MathJax.Hub]);document.querySelector('.lg-container')?.remove()
const postBg = document.querySelector('#post-bg');
if (postBg) lightGallery(postBg, {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js','data-pjax','.vercount','meta[name=page-config]'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body><div class="loading" style="opacity: 0;"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><div class="navBtn"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><nav><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="Search" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup" tabindex="0"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li></ol></nav></header><article><div id="post-bg"><div id="post-title"><h1>网络通信</h1><div id="post-info"><span>First Post: <div class="control"><time datetime="2026-02-27T05:01:04.000Z" id="date"> 2026-02-27</time></div></span><br><span>Last Update: <div class="control"><time datetime="2026-02-27T05:13:36.064Z" id="updated"> 2026-02-27</time></div></span></div></div><hr><div id="post-content"><h1 id="应用层"><a href="#应用层" class="headerlink" title="应用层"></a><a class="markdownIt-Anchor" href="#应用层"></a> 应用层</h1>
<h2 id="一-应用层是干什么的"><a href="#一-应用层是干什么的" class="headerlink" title="一-应用层是干什么的"></a><a class="markdownIt-Anchor" href="#一-应用层是干什么的"></a> 一、应用层是干什么的？</h2>
<p>核心职责：让计算机理解人类意图</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">应用层 = 网络应用的&quot;大脑&quot;<br><br>你的需求：看网页、发邮件、传文件<br>↓<br>应用层翻译成：HTTP请求、SMTP命令、FTP操作<br>↓<br>网络传输<br></code></pre></td></tr></table></figure>
<h2 id="二-应用层协议家族"><a href="#二-应用层协议家族" class="headerlink" title="二-应用层协议家族"></a><a class="markdownIt-Anchor" href="#二-应用层协议家族"></a> 二、应用层协议家族</h2>
<p>2.1 Web通信：HTTP/HTTPS</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs plaintext"># HTTP就像&quot;明信片&quot; - 所有人都能看到内容<br>GET /index.html HTTP/1.1      ← 你要什么<br>Host: www.example.com          ← 找谁要<br>User-Agent: Chrome             ← 谁在要<br>Accept: text/html              ← 要什么格式<br><br># HTTPS = HTTP + 加密信封<br># 把明信片装进加密信封再寄<br><br># 关键特点：<br>1. 无状态：服务器不记得你<br>2. 请求-响应：一问一答<br>3. 可扩展：各种Header自定义<br></code></pre></td></tr></table></figure>
<p>2.2 电子邮件：SMTP/POP3/IMAP</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs plaintext"># SMTP发送邮件（像邮局寄信）<br>HELO client.example.com        ← 打招呼<br>MAIL FROM:&lt;alice@example.com&gt;  ← 谁寄的<br>RCPT TO:&lt;bob@example.org&gt;      ← 寄给谁<br>DATA                           ← 开始写信<br>From: Alice &lt;alice@example.com&gt;<br>To: Bob &lt;bob@example.org&gt;<br>Subject: Hello!<br>This is the email body.<br>.                              ← 结束（一个点）<br>QUIT                           ← 再见<br><br># POP3收邮件（像从邮箱取信）<br># IMAP更高级（像在邮局看信，信还在服务器）<br></code></pre></td></tr></table></figure>
<p>2.3 文件传输：FTP/SFTP</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># FTP命令（像远程文件管理器）</span><br>$ ftp example.com<br>Connected to example.com.<br>Name: alice<br>Password: *****<br>ftp&gt; <span class="hljs-built_in">ls</span>                         <span class="hljs-comment"># 列出文件</span><br>ftp&gt; get file.txt              <span class="hljs-comment"># 下载文件</span><br>ftp&gt; put newfile.txt           <span class="hljs-comment"># 上传文件</span><br>ftp&gt; quit<br><br><span class="hljs-comment"># SFTP = FTP + SSH加密</span><br><span class="hljs-comment"># 更安全，但用法类似</span><br></code></pre></td></tr></table></figure>
<p>2.4 域名解析：DNS</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs plaintext"># DNS查询（像电话簿查询）<br>你：www.google.com的IP是多少？<br>↓<br>DNS客户端：查询本地缓存 → 没有<br>↓<br>DNS递归解析器：问根服务器 → &quot;.com&quot;服务器在哪？<br>↓<br>根服务器：.com服务器是这些IP<br>↓<br>递归解析器：问.com服务器 → google.com服务器在哪？<br>↓<br>.com服务器：在这里<br>↓<br>递归解析器：问google.com服务器 → www的IP？<br>↓<br>google.com服务器：是 142.250.190.78<br>↓<br>你：知道了！连接142.250.190.78<br><br># 实际上用dig命令：<br>$ dig www.google.com<br>; ANSWER SECTION:<br>www.google.com.    300    IN    A    142.250.190.78<br></code></pre></td></tr></table></figure>
<p>2.5 远程登录：SSH</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># SSH（像带加密的远程控制）</span><br>$ ssh user@server.example.com<br>Password: *****<br><br><span class="hljs-comment"># 连接后：</span><br>1. 客户端和服务器协商加密算法<br>2. 验证服务器身份（防止中间人攻击）<br>3. 用户认证（密码或密钥）<br>4. 建立加密通道<br><br><span class="hljs-comment"># 你可以：</span><br>$ <span class="hljs-built_in">ls</span>                          <span class="hljs-comment"># 执行命令</span><br>$ vim file.txt                <span class="hljs-comment"># 编辑文件</span><br>$ scp local.txt user@server:~/  <span class="hljs-comment"># 安全复制文件</span><br></code></pre></td></tr></table></figure>
<h2 id="三-现代应用层不仅仅是协议"><a href="#三-现代应用层不仅仅是协议" class="headerlink" title="三-现代应用层不仅仅是协议"></a><a class="markdownIt-Anchor" href="#三-现代应用层不仅仅是协议"></a> 三、现代应用层：不仅仅是协议</h2>
<p>3.1 RESTful API（现在最流行）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs plaintext"># REST把网络资源当成&quot;物体&quot;来操作<br># 统一接口：HTTP方法对应CRUD操作<br><br>GET    /api/users           # 获取用户列表<br>GET    /api/users/123       # 获取用户123<br>POST   /api/users           # 创建新用户<br>PUT    /api/users/123       # 更新用户123<br>DELETE /api/users/123       # 删除用户123<br><br># 请求示例：<br>POST /api/users HTTP/1.1<br>Content-Type: application/json<br><br>&#123;&quot;name&quot;: &quot;Alice&quot;, &quot;email&quot;: &quot;alice@example.com&quot;&#125;<br><br># 响应示例：<br>HTTP/1.1 201 Created<br>Content-Type: application/json<br>Location: /api/users/456<br><br>&#123;&quot;id&quot;: 456, &quot;name&quot;: &quot;Alice&quot;, &quot;email&quot;: &quot;alice@example.com&quot;&#125;<br><br></code></pre></td></tr></table></figure>
<p>3.2 WebSocket（双向实时通信）</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs jsx"><span class="hljs-comment">// 传统HTTP：客户端问，服务器答（像对讲机）</span><br><span class="hljs-comment">// WebSocket：双向随时通信（像电话）</span><br><br><span class="hljs-comment">// 客户端JavaScript</span><br><span class="hljs-keyword">const</span> socket = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocket</span>(<span class="hljs-string">&#x27;ws://example.com/chat&#x27;</span>);<br><br>socket.<span class="hljs-property">onopen</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">// 连接建立，可以随时发消息</span><br>    socket.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Hello Server!&#x27;</span>);<br>&#125;;<br><br>socket.<span class="hljs-property">onmessage</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) &#123;<br>    <span class="hljs-comment">// 随时接收服务器消息</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Received:&#x27;</span>, event.<span class="hljs-property">data</span>);<br>&#125;;<br><br><span class="hljs-comment">// 服务器可以主动推消息，不用等客户端请求</span><br><br></code></pre></td></tr></table></figure>
<p>3.3 GraphQL（灵活的数据查询）</p>
<figure class="highlight graphql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs graphql"><span class="hljs-comment"># 传统REST：多个端点，固定返回格式</span><br><span class="hljs-comment"># GraphQL：一个端点，客户端指定要什么</span><br><br><span class="hljs-comment"># 客户端查询（只要id和name）</span><br><span class="hljs-keyword">query</span> <span class="hljs-punctuation">&#123;</span><br>  user<span class="hljs-punctuation">(</span><span class="hljs-symbol">id</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;123&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>    id<br>    name<br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br><br><span class="hljs-comment"># 响应（只返回请求的字段）</span><br><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-string">&quot;data&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-string">&quot;user&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-string">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;123&quot;</span>,<br>      <span class="hljs-string">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Alice&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br><br><span class="hljs-comment"># 可以复杂查询：</span><br><span class="hljs-keyword">query</span> <span class="hljs-punctuation">&#123;</span><br>  user<span class="hljs-punctuation">(</span><span class="hljs-symbol">id</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;123&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>    name<br>    posts <span class="hljs-punctuation">&#123;</span><br>      title<br>      comments <span class="hljs-punctuation">&#123;</span><br>        text<br>        author <span class="hljs-punctuation">&#123;</span><br>          name<br>        <span class="hljs-punctuation">&#125;</span><br>      <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br><br></code></pre></td></tr></table></figure>
<h2 id="四-应用层的安全考虑"><a href="#四-应用层的安全考虑" class="headerlink" title="四-应用层的安全考虑"></a><a class="markdownIt-Anchor" href="#四-应用层的安全考虑"></a> 四、应用层的安全考虑</h2>
<p>4.1 HTTPS：HTTP的加密版本</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># HTTPS = HTTP + TLS加密</span><br><span class="hljs-comment"># 建立连接过程：</span><br><br><span class="hljs-comment"># 1. 客户端打招呼</span><br>ClientHello<br>  - 支持的TLS版本<br>  - 支持的加密算法<br>  - 客户端随机数<br><br><span class="hljs-comment"># 2. 服务器回应</span><br>ServerHello<br>  - 选择的TLS版本和算法<br>  - 服务器随机数<br>  - 服务器证书（证明身份）<br><br><span class="hljs-comment"># 3. 密钥交换</span><br>客户端验证证书，生成预主密钥<br>用服务器公钥加密发送<br><br><span class="hljs-comment"># 4. 生成会话密钥</span><br>双方用随机数+预主密钥计算相同密钥<br><br><span class="hljs-comment"># 5. 加密通信开始</span><br>之后所有HTTP数据用会话密钥加密<br><br></code></pre></td></tr></table></figure>
<p>4.2 OAuth 2.0（授权框架）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 你不用把密码给第三方应用，而是授权它访问</span><br><br><span class="hljs-comment"># 流程：</span><br>1. 用户点击<span class="hljs-string">&quot;用Google登录&quot;</span><br>2. 跳转到Google授权页面<br>3. 用户登录Google并同意授权<br>4. Google返回授权码给应用<br>5. 应用用授权码换访问令牌<br>6. 应用用令牌访问用户数据<br><br><span class="hljs-comment"># 请求示例：</span><br>GET /oauth/authorize?<br>  response_type=code&amp;<br>  client_id=CLIENT_ID&amp;<br>  redirect_uri=REDIRECT_URI&amp;<br>  scope=email<br><br></code></pre></td></tr></table></figure>
<h1 id="传输层"><a href="#传输层" class="headerlink" title="传输层"></a><a class="markdownIt-Anchor" href="#传输层"></a> 传输层</h1>
<h2 id="一-传输层是干什么的"><a href="#一-传输层是干什么的" class="headerlink" title="一-传输层是干什么的"></a><a class="markdownIt-Anchor" href="#一-传输层是干什么的"></a> 一、传输层是干什么的？</h2>
<p>1.1 核心职责：进程到进程的通信</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">应用层：浏览器 ↔ 网站<br>传输层：Chrome进程(端口443) ↔ Nginx进程(端口443)<br><br>关键概念：端口号（Port）<br>- IP地址：找到哪台计算机<br>- 端口号：找到哪个程序<br>- 范围：0-65535<br>  - 0-1023：知名端口（HTTP:80, HTTPS:443, SSH:22）<br>  - 1024-49151：注册端口<br>  - 49152-65535：动态/私有端口<br><br></code></pre></td></tr></table></figure>
<p>1.2 传输层的两大选择</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">TCP（传输控制协议）：可靠的&quot;快递员&quot;<br>  - 保证送达，保证顺序<br>  - 速度较慢，开销较大<br>  - 用于：网页、邮件、文件传输<br><br>UDP（用户数据报协议）：快速的&quot;邮筒&quot;<br>  - 不保证送达，不保证顺序<br>  - 速度极快，开销极小<br>  - 用于：视频流、游戏、DNS查询<br><br></code></pre></td></tr></table></figure>
<h2 id="二-tcp深度解析可靠的连接"><a href="#二-tcp深度解析可靠的连接" class="headerlink" title="二-tcp深度解析可靠的连接"></a><a class="markdownIt-Anchor" href="#二-tcp深度解析可靠的连接"></a> 二、TCP深度解析：可靠的连接</h2>
<p>2.1 TCP三次握手（建立连接）</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// 想象打电话的过程：</span><br><span class="hljs-comment">// 客户端：喂，能听到吗？ (SYN)</span><br><span class="hljs-comment">// 服务器：能听到，你能听到我吗？ (SYN+ACK)</span><br><span class="hljs-comment">// 客户端：能听到，开始说吧！ (ACK)</span><br><br><span class="hljs-comment">// 实际TCP数据包：</span><br><span class="hljs-comment">// 包1：SYN, seq=1000</span><br><span class="hljs-comment">// 包2：SYN, seq=2000, ACK=1001</span><br><span class="hljs-comment">// 包3：ACK, seq=1001, ACK=2001</span><br><br><span class="hljs-comment">// 为什么三次？不是两次或四次？</span><br><span class="hljs-comment">// 两次：无法确认客户端收到服务器的SYN+ACK</span><br><span class="hljs-comment">// 四次：冗余，第三次ACK已经足够</span><br><br></code></pre></td></tr></table></figure>
<p>2.2 TCP数据传输机制</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// TCP把数据分成&quot;段&quot;（segment）发送</span><br><span class="hljs-comment">// 每个段有序列号，接收方按序重组</span><br><br><span class="hljs-comment">// 发送方视角：</span><br><span class="hljs-number">1.</span> 应用数据：<span class="hljs-string">&quot;Hello World&quot;</span> (<span class="hljs-number">11</span>字节)<br><span class="hljs-number">2.</span> TCP分成：seq=<span class="hljs-number">1000</span>, data=<span class="hljs-string">&quot;Hello &quot;</span><br>           seq=<span class="hljs-number">1006</span>, data=<span class="hljs-string">&quot;World&quot;</span><br><span class="hljs-number">3.</span> 等待ACK：收到ACK=<span class="hljs-number">1011</span>表示对方收到了<br><br><span class="hljs-comment">// 接收方视角：</span><br>收到seq=<span class="hljs-number">1000</span>, data=<span class="hljs-string">&quot;Hello &quot;</span> → 缓存<br>收到seq=<span class="hljs-number">1006</span>, data=<span class="hljs-string">&quot;World&quot;</span>  → 拼成<span class="hljs-string">&quot;Hello World&quot;</span><br>发送ACK=<span class="hljs-number">1011</span> (<span class="hljs-string">&quot;我收到了0-1010字节&quot;</span>)<br><br><span class="hljs-comment">// 如果乱序到达：</span><br>收到seq=<span class="hljs-number">1006</span>先到 → 等待seq=<span class="hljs-number">1000</span><br>收到seq=<span class="hljs-number">1000</span>后 → 一起交给应用层<br><br></code></pre></td></tr></table></figure>
<p>2.3 TCP可靠性保证的四大机制</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// 1. 确认应答（ACK）</span><br><span class="hljs-comment">// 每收到数据，必须回复ACK</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">tcp_ack</span> &#123;</span><br>    <span class="hljs-type">uint32_t</span> ack_number;  <span class="hljs-comment">// &quot;我期望收到的下一个字节号&quot;</span><br>    <span class="hljs-comment">// 可以累积确认：ACK=5000 表示收到了0-4999</span><br>&#125;;<br><br><span class="hljs-comment">// 2. 超时重传</span><br><span class="hljs-comment">// 发送数据后启动定时器（RTO - 重传超时）</span><br><span class="hljs-comment">// 如果超时未收到ACK，重发数据</span><br><span class="hljs-comment">// RTO动态调整：基于RTT（往返时间）</span><br><br><span class="hljs-comment">// 3. 流量控制（滑动窗口）</span><br><span class="hljs-comment">// 接收方：&quot;我缓冲区只剩1460字节了&quot;</span><br><span class="hljs-comment">// 发送方：&quot;那我先发1460字节，等你腾出空间&quot;</span><br><span class="hljs-type">uint16_t</span> window_size;  <span class="hljs-comment">// 窗口大小字段，告诉对方能收多少</span><br><br><span class="hljs-comment">// 4. 拥塞控制（保护网络）</span><br><span class="hljs-comment">// 四个阶段：</span><br><span class="hljs-comment">// - 慢启动：指数增长，试探网络容量</span><br><span class="hljs-comment">// - 拥塞避免：线性增长，接近阈值</span><br><span class="hljs-comment">// - 快速重传：收到3个重复ACK立即重传</span><br><span class="hljs-comment">// - 快速恢复：拥塞后不回到慢启动</span><br><br></code></pre></td></tr></table></figure>
<p>2.4 TCP四次挥手（断开连接）</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// 想象挂电话：</span><br><span class="hljs-comment">// 客户端：我说完了 (FIN)</span><br><span class="hljs-comment">// 服务器：好的，我也说完了 (ACK + FIN)</span><br><span class="hljs-comment">// 客户端：收到，再见 (ACK)</span><br><br><span class="hljs-comment">// 实际过程：</span><br><span class="hljs-comment">// 客户端 → FIN → 服务器 (我要关闭了)</span><br><span class="hljs-comment">// 服务器 → ACK → 客户端 (知道了)</span><br><span class="hljs-comment">// (这里可能有数据传输延迟)</span><br><span class="hljs-comment">// 服务器 → FIN → 客户端 (我也要关了)</span><br><span class="hljs-comment">// 客户端 → ACK → 服务器 (好的，再见)</span><br><br><span class="hljs-comment">// 为什么需要TIME_WAIT状态？</span><br><span class="hljs-comment">// 客户端发送最后一个ACK后等待2MSL（最大段生存期）</span><br><span class="hljs-comment">// 原因：</span><br><span class="hljs-comment">// 1. 确保对方收到ACK（如果没收到会重传FIN）</span><br><span class="hljs-comment">// 2. 让旧连接的数据包在网络中消失，避免混淆新连接</span><br><br></code></pre></td></tr></table></figure>
<h3 id="三-udp深度解析简单的数据报"><a href="#三-udp深度解析简单的数据报" class="headerlink" title="三-udp深度解析简单的数据报"></a><a class="markdownIt-Anchor" href="#三-udp深度解析简单的数据报"></a> 三、UDP深度解析：简单的数据报</h3>
<p>3.1 UDP协议特点</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// UDP头只有8字节（TCP至少20字节）</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">udphdr</span> &#123;</span><br>    <span class="hljs-type">uint16_t</span> source_port;    <span class="hljs-comment">// 源端口</span><br>    <span class="hljs-type">uint16_t</span> dest_port;      <span class="hljs-comment">// 目标端口</span><br>    <span class="hljs-type">uint16_t</span> length;         <span class="hljs-comment">// UDP头+数据总长度</span><br>    <span class="hljs-type">uint16_t</span> checksum;       <span class="hljs-comment">// 校验和（可选）</span><br>&#125;;<br><br><span class="hljs-comment">// UDP的特点：</span><br><span class="hljs-comment">// 1. 无连接：直接发送，不需要握手</span><br><span class="hljs-comment">// 2. 不可靠：不保证到达，不保证顺序</span><br><span class="hljs-comment">// 3. 无状态：不维护连接状态</span><br><span class="hljs-comment">// 4. 无流量控制：能发多快发多快</span><br><span class="hljs-comment">// 5. 无拥塞控制：可能淹没网络</span><br><br><span class="hljs-comment">// 但正是这种&quot;简单&quot;在某些场景是优势</span><br><br></code></pre></td></tr></table></figure>
<p>3.2 UDP使用场景</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// 场景1：DNS查询</span><br><span class="hljs-comment">// 请求：&quot;www.google.com的IP？&quot;</span><br><span class="hljs-comment">// 响应：&quot;142.250.190.78&quot;</span><br><span class="hljs-comment">// 特点：小数据包，快速响应，一次查询一次响应</span><br><br><span class="hljs-comment">// 场景2：音视频流</span><br><span class="hljs-comment">// 视频帧1 → 视频帧2 → 视频帧3</span><br><span class="hljs-comment">// 丢了一帧？继续播下一帧！</span><br><span class="hljs-comment">// 重传旧帧反而会导致卡顿</span><br><br><span class="hljs-comment">// 场景3：在线游戏</span><br><span class="hljs-comment">// 玩家位置更新：新位置比旧位置更重要</span><br><span class="hljs-comment">// 如果位置包延迟，直接发最新位置</span><br><br><span class="hljs-comment">// 场景4：DHCP（动态主机配置）</span><br><span class="hljs-comment">// 广播请求IP配置，快速获取网络参数</span><br><br></code></pre></td></tr></table></figure>
<p>3.3 UDP的可靠性实现（可选）</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// 应用层可以在UDP基础上实现可靠性</span><br><span class="hljs-comment">// 比如QUIC协议（HTTP/3的基础）</span><br><br><span class="hljs-comment">// 简单可靠UDP实现思路：</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">reliable_udp_header</span> &#123;</span><br>    <span class="hljs-type">uint32_t</span> sequence;       <span class="hljs-comment">// 序列号（应用层实现）</span><br>    <span class="hljs-type">uint32_t</span> ack;            <span class="hljs-comment">// 确认号（应用层实现）</span><br>    <span class="hljs-type">uint16_t</span> flags;          <span class="hljs-comment">// 标志位</span><br>    <span class="hljs-type">uint8_t</span> data[];          <span class="hljs-comment">// 数据</span><br>&#125;;<br><br><span class="hljs-comment">// 应用层实现：</span><br><span class="hljs-comment">// - 序列号保证顺序</span><br><span class="hljs-comment">// - 确认和重传保证可靠</span><br><span class="hljs-comment">// - 但比TCP更灵活：可以自定义重传策略</span><br></code></pre></td></tr></table></figure>
<h1 id="网络层"><a href="#网络层" class="headerlink" title="网络层"></a><a class="markdownIt-Anchor" href="#网络层"></a> 网络层</h1>
<h2 id="一-网络层是干什么的"><a href="#一-网络层是干什么的" class="headerlink" title="一-网络层是干什么的"></a><a class="markdownIt-Anchor" href="#一-网络层是干什么的"></a> 一、网络层是干什么的？</h2>
<p>1.1 核心职责：跨网络的数据包路由</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">传输层：从进程到进程（港口到港口）<br>网络层：从主机到主机（城市到城市）<br><br>你的电脑（北京） → 路由器1 → 路由器2 → ... → 目标服务器（上海）<br><br>网络层解决两个问题：<br>1. 寻址：每台设备有唯一IP地址<br>2. 路由：找到最佳路径送到目的地<br><br></code></pre></td></tr></table></figure>
<p>1.2 关键概念：IP地址</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// IPv4地址：32位，点分十进制表示</span><br><span class="hljs-number">192.168</span>.<span class="hljs-number">1.100</span> = <span class="hljs-number">11000000.10101000</span>.<span class="hljs-number">00000001.01100100</span><br><br><span class="hljs-comment">// 网络部分 + 主机部分</span><br><span class="hljs-number">192.168</span>.<span class="hljs-number">1.0</span>/<span class="hljs-number">24</span>  <span class="hljs-comment">// 前24位是网络，后8位是主机</span><br>                <span class="hljs-comment">// 这个网络可以有254台主机（1-254）</span><br><br><span class="hljs-comment">// IPv6地址：128位，冒号分隔十六进制</span><br><span class="hljs-number">2001</span>:<span class="hljs-number">0</span>db8:<span class="hljs-number">85</span>a3:<span class="hljs-number">0000</span>:<span class="hljs-number">0000</span>:<span class="hljs-number">8</span>a2e:<span class="hljs-number">0370</span>:<span class="hljs-number">7334</span><br><span class="hljs-comment">// 简写：2001:db8:85a3::8a2e:370:7334</span><br><br><span class="hljs-comment">// 特殊地址：</span><br><span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>     本地环回（自己）<br><span class="hljs-number">192.168</span>.x.x   私有地址（内网用）<br><span class="hljs-number">10.</span>x.x.x      私有地址（大型内网）<br><span class="hljs-number">172.16</span>.x.x    私有地址<br><br></code></pre></td></tr></table></figure>
<h2 id="二-ip协议详解"><a href="#二-ip协议详解" class="headerlink" title="二-ip协议详解"></a><a class="markdownIt-Anchor" href="#二-ip协议详解"></a> 二、IP协议详解</h2>
<p>2.1 IP包头结构</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// IPv4包头（20-60字节）</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">iphdr</span> &#123;</span><br><span class="hljs-meta">#<span class="hljs-keyword">if</span> defined(__LITTLE_ENDIAN_BITFIELD)</span><br>    __u8    ihl:<span class="hljs-number">4</span>,      <span class="hljs-comment">// 头部长度（以4字节为单位，最小5）</span><br>            version:<span class="hljs-number">4</span>;  <span class="hljs-comment">// 版本（4=IPv4）</span><br><span class="hljs-meta">#<span class="hljs-keyword">elif</span> defined(__BIG_ENDIAN_BITFIELD)</span><br>    __u8    version:<span class="hljs-number">4</span>,<br>            ihl:<span class="hljs-number">4</span>;<br><span class="hljs-meta">#<span class="hljs-keyword">endif</span></span><br>    __u8    tos;        <span class="hljs-comment">// 服务类型（优先级、延迟、吞吐量要求）</span><br>    __be16  tot_len;    <span class="hljs-comment">// 总长度（头+数据，最大65535）</span><br>    __be16  id;         <span class="hljs-comment">// 标识（用于分片重组）</span><br>    __be16  frag_off;   <span class="hljs-comment">// 分片偏移和标志</span><br>    __u8    ttl;        <span class="hljs-comment">// 生存时间（每过一跳减1，到0丢弃）</span><br>    __u8    protocol;   <span class="hljs-comment">// 上层协议（6=TCP, 17=UDP, 1=ICMP）</span><br>    __sum16 check;      <span class="hljs-comment">// 头部校验和</span><br>    __be32  saddr;      <span class="hljs-comment">// 源IP地址</span><br>    __be32  daddr;      <span class="hljs-comment">// 目标IP地址</span><br>    <span class="hljs-comment">// 可选项（如果有）</span><br>&#125;;<br><br><span class="hljs-comment">// 关键字段解释：</span><br><span class="hljs-comment">// TTL：防止数据包永远循环</span><br><span class="hljs-comment">//   你 traceroute 时看到的就是TTL递减过程</span><br><span class="hljs-comment">// Protocol：告诉接收方&quot;这是TCP包，交给TCP处理&quot;</span><br><br></code></pre></td></tr></table></figure>
<p>2.2 IP分片与重组</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// 问题：网络链路有MTU（最大传输单元）</span><br><span class="hljs-comment">// 以太网MTU=1500字节，IP头20字节，所以数据最多1480字节</span><br><span class="hljs-comment">// 如果数据更大怎么办？分片！</span><br><br><span class="hljs-comment">// 分片过程：</span><br>原始IP包：总长度<span class="hljs-number">3000</span>字节<br>↓ 分成<span class="hljs-number">3</span>片：<br>片<span class="hljs-number">1</span>：偏移<span class="hljs-number">0</span>，长度<span class="hljs-number">1500</span>，更多分片标志=<span class="hljs-number">1</span><br>片<span class="hljs-number">2</span>：偏移<span class="hljs-number">1480</span>，长度<span class="hljs-number">1500</span>，更多分片标志=<span class="hljs-number">1</span><br>片<span class="hljs-number">3</span>：偏移<span class="hljs-number">2960</span>，长度<span class="hljs-number">40</span>，更多分片标志=<span class="hljs-number">0</span><br><br><span class="hljs-comment">// 接收方重组：</span><br>收到片<span class="hljs-number">2</span> → 等片<span class="hljs-number">1</span>和片<span class="hljs-number">3</span><br>收到片<span class="hljs-number">1</span> → 等片<span class="hljs-number">3</span><br>收到片<span class="hljs-number">3</span> → 重组完成，交给上层<br><br><span class="hljs-comment">// 现代网络避免分片：TCP有MSS（最大段大小）</span><br><span class="hljs-comment">// TCP握手时协商MSS，保证数据小于MTU</span><br><br></code></pre></td></tr></table></figure>
<p>2.3 IP地址分类和子网划分</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># IP地址分类（传统）</span><br>A类：0.0.0.0 - 127.255.255.255    <span class="hljs-comment"># 前8位网络，后24位主机</span><br>B类：128.0.0.0 - 191.255.255.255  <span class="hljs-comment"># 前16位网络，后16位主机</span><br>C类：192.0.0.0 - 223.255.255.255  <span class="hljs-comment"># 前24位网络，后8位主机</span><br><br><span class="hljs-comment"># CIDR（无类别域间路由）现代方法</span><br>192.168.1.0/24      <span class="hljs-comment"># 前24位是网络，后8位是主机</span><br>10.0.0.0/8          <span class="hljs-comment"># 前8位是网络，后24位是主机</span><br>172.16.0.0/12       <span class="hljs-comment"># 前12位是网络，后20位是主机</span><br><br><span class="hljs-comment"># 子网划分：把一个大网络分成小网络</span><br>192.168.1.0/24 分成4个子网：<br>192.168.1.0/26   <span class="hljs-comment"># 主机范围：1-62</span><br>192.168.1.64/26  <span class="hljs-comment"># 主机范围：65-126</span><br>192.168.1.128/26 <span class="hljs-comment"># 主机范围：129-190</span><br>192.168.1.192/26 <span class="hljs-comment"># 主机范围：193-254</span><br><br></code></pre></td></tr></table></figure>
<h2 id="三-路由互联网的导航系统"><a href="#三-路由互联网的导航系统" class="headerlink" title="三-路由互联网的导航系统"></a><a class="markdownIt-Anchor" href="#三-路由互联网的导航系统"></a> 三、路由：互联网的导航系统</h2>
<p>3.1 路由表：网络的&quot;地图&quot;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 查看Linux路由表</span><br>$ ip route show<br>default via 192.168.1.1 dev eth0      <span class="hljs-comment"># 默认路由：不知道去哪的都发给网关</span><br>192.168.1.0/24 dev eth0 proto kernel  <span class="hljs-comment"># 本地网络：直接发送</span><br>10.0.0.0/8 via 192.168.1.2 dev eth0   <span class="hljs-comment"># 特定网络：通过特定网关</span><br><br><span class="hljs-comment"># 路由表结构：</span><br><span class="hljs-comment"># 目标网络 → 下一跳地址 → 出口网卡</span><br><br><span class="hljs-comment"># 路由查找过程（最长前缀匹配）：</span><br>目标IP：192.168.1.100<br>匹配项：<br>1. 192.168.1.0/24 dev eth0        ✓ 匹配24位，直接发送<br>2. 192.168.0.0/16 via 10.0.0.1    ✗ 只匹配16位，不是最具体<br><br>目标IP：8.8.8.8<br>匹配项：<br>1. 192.168.1.0/24 dev eth0        ✗ 不匹配<br>2. default via 192.168.1.1 dev eth0 ✓ 默认路由匹配<br><br></code></pre></td></tr></table></figure>
<p>3.2 路由协议：路由器之间的&quot;语言&quot;</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// 路由器如何知道网络拓扑？</span><br><span class="hljs-comment">// 通过路由协议交换信息</span><br><br><span class="hljs-comment">// 1. RIP（路由信息协议） - 距离向量</span><br><span class="hljs-comment">//    告诉邻居：&quot;我到网络A的距离是3跳&quot;</span><br><span class="hljs-comment">//    问题：收敛慢，最大15跳</span><br><br><span class="hljs-comment">// 2. OSPF（开放最短路径优先） - 链路状态</span><br><span class="hljs-comment">//    每个路由器知道整个网络拓扑</span><br><span class="hljs-comment">//    自己计算最短路径（Dijkstra算法）</span><br><br><span class="hljs-comment">// 3. BGP（边界网关协议） - 路径向量</span><br><span class="hljs-comment">//    互联网骨干路由器使用</span><br><span class="hljs-comment">//    &quot;AS100：我能到网络A，路径是AS200→AS300&quot;</span><br><span class="hljs-comment">//    AS：自治系统（一个运营商或大公司）</span><br><br></code></pre></td></tr></table></figure>
<p>3.3 路由过程详解</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// 数据包在路由器中的旅程</span><br><br><span class="hljs-comment">// 路由器收到数据包：</span><br><span class="hljs-number">1.</span> 检查目标IP地址<br><span class="hljs-number">2.</span> 查找路由表<br><span class="hljs-number">3.</span> 确定下一跳和出口接口<br><span class="hljs-number">4.</span> 减少TTL（如果为<span class="hljs-number">0</span>则丢弃）<br><span class="hljs-number">5.</span> 重新计算校验和<br><span class="hljs-number">6.</span> 转发到出口接口<br><br><span class="hljs-comment">// 实际路由表示例（简化）：</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">fib_table</span> &#123;</span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">trie</span> *<span class="hljs-title">trie</span>;</span>  <span class="hljs-comment">// 路由表用trie树组织</span><br>    <span class="hljs-comment">// ...</span><br>&#125;;<br><br><span class="hljs-comment">// 路由查找函数：</span><br><span class="hljs-keyword">struct</span> fib_result <span class="hljs-title function_">fib_lookup</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> net *net, <span class="hljs-keyword">struct</span> flowi *flp)</span> &#123;<br>    <span class="hljs-comment">// 根据目标IP查找路由</span><br>    <span class="hljs-comment">// 返回下一跳地址、出口设备等</span><br>&#125;<br><br></code></pre></td></tr></table></figure>
<h2 id="四-相关协议"><a href="#四-相关协议" class="headerlink" title="四-相关协议"></a><a class="markdownIt-Anchor" href="#四-相关协议"></a> 四、相关协议</h2>
<p>4.1 ARP：地址解析协议</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// 问题：网络层用IP地址，但链路层用MAC地址</span><br><span class="hljs-comment">// ARP解决：&quot;这个IP地址对应的MAC地址是什么？&quot;</span><br><br><span class="hljs-comment">// ARP请求（广播）：</span><br>发送者：<span class="hljs-string">&quot;谁的IP是192.168.1.1？请告诉192.168.1.100&quot;</span><br>以太网目标MAC：FF:FF:FF:FF:FF:FF（广播）<br><br><span class="hljs-comment">// ARP响应（单播）：</span><br><span class="hljs-number">192.168</span>.<span class="hljs-number">1.1</span>：<span class="hljs-string">&quot;我是192.168.1.1，我的MAC是00:11:22:33:44:55&quot;</span><br><br><span class="hljs-comment">// Linux ARP缓存：</span><br>$ arp -a<br>? (<span class="hljs-number">192.168</span>.<span class="hljs-number">1.1</span>) at <span class="hljs-number">00</span>:<span class="hljs-number">11</span>:<span class="hljs-number">22</span>:<span class="hljs-number">33</span>:<span class="hljs-number">44</span>:<span class="hljs-number">55</span> [ether] on eth0<br>? (<span class="hljs-number">192.168</span>.<span class="hljs-number">1.100</span>) at aa:bb:cc:dd:ee:ff [ether] on eth0<br><br></code></pre></td></tr></table></figure>
<p>4.2 ICMP：互联网控制消息协议</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// IP协议的&quot;辅助协议&quot;，用于错误报告和诊断</span><br><br><span class="hljs-comment">// ICMP类型：</span><br><span class="hljs-comment">// 0: Echo Reply (ping响应)</span><br><span class="hljs-comment">// 3: Destination Unreachable (目标不可达)</span><br><span class="hljs-comment">// 5: Redirect (重定向)</span><br><span class="hljs-comment">// 8: Echo Request (ping请求)</span><br><span class="hljs-comment">// 11: Time Exceeded (超时，traceroute用)</span><br><br><span class="hljs-comment">// 常见用途：</span><br><span class="hljs-comment">// 1. ping：发送ICMP Echo Request，等待Reply</span><br><span class="hljs-comment">// 2. traceroute：发送TTL=1的包，收到Time Exceeded，知道第一跳</span><br><span class="hljs-comment">// 3. 网络错误：收到Destination Unreachable</span><br><br><span class="hljs-comment">// ICMP头：</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">icmphdr</span> &#123;</span><br>    __u8    type;       <span class="hljs-comment">// 类型</span><br>    __u8    code;       <span class="hljs-comment">// 代码（更具体信息）</span><br>    __sum16 checksum;   <span class="hljs-comment">// 校验和</span><br>    <span class="hljs-comment">// 其他字段根据类型不同</span><br>&#125;;<br><br></code></pre></td></tr></table></figure>
<p>4.3 NAT：网络地址转换</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// 问题：IPv4地址不够用</span><br><span class="hljs-comment">// 解决方案：多个设备共享一个公网IP</span><br><br><span class="hljs-comment">// NAT工作原理：</span><br>内网设备：<span class="hljs-number">192.168</span>.<span class="hljs-number">1.100</span>:<span class="hljs-number">54321</span> → NAT路由器<br>NAT路由器：转换源地址为 <span class="hljs-number">203.0</span>.<span class="hljs-number">113.1</span>:<span class="hljs-number">12345</span> → 互联网<br>互联网响应：<span class="hljs-number">203.0</span>.<span class="hljs-number">113.1</span>:<span class="hljs-number">12345</span> → NAT路由器<br>NAT路由器：转换目标地址为 <span class="hljs-number">192.168</span>.<span class="hljs-number">1.100</span>:<span class="hljs-number">54321</span> → 内网<br><br><span class="hljs-comment">// NAT表记录：</span><br><span class="hljs-comment">// 内网IP:端口 ↔ 公网IP:端口 映射关系</span><br><br><span class="hljs-comment">// 类型：</span><br><span class="hljs-comment">// 1. 静态NAT：固定映射（服务器用）</span><br><span class="hljs-comment">// 2. 动态NAT：临时映射（普通用户用）</span><br><span class="hljs-comment">// 3. PAT（端口地址转换）：多个内网IP用一个公网IP，不同端口区分</span><br><br></code></pre></td></tr></table></figure>
<h2 id="五-ipv6下一代ip协议"><a href="#五-ipv6下一代ip协议" class="headerlink" title="五-ipv6下一代ip协议"></a><a class="markdownIt-Anchor" href="#五-ipv6下一代ip协议"></a> 五、IPv6：下一代IP协议</h2>
<p>5.1 IPv6的优势</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// IPv6包头（固定40字节）</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">ipv6hdr</span> &#123;</span><br><span class="hljs-meta">#<span class="hljs-keyword">if</span> defined(__LITTLE_ENDIAN_BITFIELD)</span><br>    __u8    priority:<span class="hljs-number">4</span>,    <span class="hljs-comment">// 流量类别</span><br>            version:<span class="hljs-number">4</span>;     <span class="hljs-comment">// 版本（6）</span><br><span class="hljs-meta">#<span class="hljs-keyword">elif</span> defined(__BIG_ENDIAN_BITFIELD)</span><br>    __u8    version:<span class="hljs-number">4</span>,<br>            priority:<span class="hljs-number">4</span>;<br><span class="hljs-meta">#<span class="hljs-keyword">endif</span></span><br>    __u8    flow_lbl[<span class="hljs-number">3</span>];   <span class="hljs-comment">// 流标签</span><br>    __be16  payload_len;   <span class="hljs-comment">// 负载长度</span><br>    __u8    nexthdr;       <span class="hljs-comment">// 下一个头（类似IPv4的protocol）</span><br>    __u8    hop_limit;     <span class="hljs-comment">// 跳数限制（类似TTL）</span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">in6_addr</span> <span class="hljs-title">saddr</span>;</span> <span class="hljs-comment">// 源地址（128位）</span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">in6_addr</span> <span class="hljs-title">daddr</span>;</span> <span class="hljs-comment">// 目标地址（128位）</span><br>&#125;;<br><br><span class="hljs-comment">// IPv6改进：</span><br><span class="hljs-comment">// 1. 地址空间巨大：2^128个地址（地球每平方米10^23个地址）</span><br><span class="hljs-comment">// 2. 简化头部：固定40字节，无分片（路径MTU发现）</span><br><span class="hljs-comment">// 3. 更好的安全性：IPsec内置</span><br><span class="hljs-comment">// 4. 无NAT：每个设备都有公网地址</span><br><span class="hljs-comment">// 5. 更好的QoS支持：流标签</span><br><br></code></pre></td></tr></table></figure>
<p>5.2 IPv6地址类型</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs c"># IPv6地址表示<br><span class="hljs-number">2001</span>:<span class="hljs-number">0</span>db8:<span class="hljs-number">85</span>a3:<span class="hljs-number">0000</span>:<span class="hljs-number">0000</span>:<span class="hljs-number">8</span>a2e:<span class="hljs-number">0370</span>:<span class="hljs-number">7334</span><br># 简写：<span class="hljs-number">2001</span>:db8:<span class="hljs-number">85</span>a3::<span class="hljs-number">8</span>a2e:<span class="hljs-number">370</span>:<span class="hljs-number">7334</span><br><br># 特殊地址：<br>::<span class="hljs-number">1</span>                          # 环回地址（类似<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>）<br>fe80::/<span class="hljs-number">10</span>                    # 链路本地地址（类似<span class="hljs-number">169.254</span>.x.x）<br><span class="hljs-number">2000</span>::/<span class="hljs-number">3</span>                     # 全球单播地址（公网地址）<br>ff00::/<span class="hljs-number">8</span>                     # 多播地址<br><br># IPv4映射的IPv6地址：<br>::ffff:<span class="hljs-number">192.0</span>.<span class="hljs-number">2.1</span>             # 表示IPv4地址<span class="hljs-number">192.0</span>.<span class="hljs-number">2.1</span><br></code></pre></td></tr></table></figure>
<h1 id="链路层"><a href="#链路层" class="headerlink" title="链路层"></a><a class="markdownIt-Anchor" href="#链路层"></a> 链路层</h1>
<h2 id="一-链路层是干什么的"><a href="#一-链路层是干什么的" class="headerlink" title="一-链路层是干什么的"></a><a class="markdownIt-Anchor" href="#一-链路层是干什么的"></a> 一、链路层是干什么的？</h2>
<p>1.1 核心职责：同一网络内设备间的直接通信</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">网络层：北京 → 上海（跨城市）<br>链路层：你家 → 邻居家（同一条街）<br><br>链路层只关心：<br>1. 这个数据包在本地网络发给谁？<br>2. 用什么样的&quot;信封&quot;（帧格式）包装？<br>3. 如何避免邻居同时说话（冲突避免）？<br><br></code></pre></td></tr></table></figure>
<p>1.2 工作范围：一跳之内</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">你的电脑 → 交换机/路由器 → 下一跳设备<br>      ↑ 这一跳由链路层负责<br><br>链路层不关心：<br>- 数据包最终要去哪（那是网络层的事）<br>- 数据内容是什么（那是上层的事）<br>- 如何跨多个网络（那是路由的事）<br><br></code></pre></td></tr></table></figure>
<h2 id="二-以太网最主流的链路层协议"><a href="#二-以太网最主流的链路层协议" class="headerlink" title="二-以太网最主流的链路层协议"></a><a class="markdownIt-Anchor" href="#二-以太网最主流的链路层协议"></a> 二、以太网：最主流的链路层协议</h2>
<p>2.1 以太网帧结构</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// 以太网帧（最小64字节，最大1518字节）</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">ethhdr</span> &#123;</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> h_dest[ETH_ALEN];   <span class="hljs-comment">// 目标MAC地址 (6字节)</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> h_source[ETH_ALEN]; <span class="hljs-comment">// 源MAC地址 (6字节)</span><br>    __be16 h_proto;                   <span class="hljs-comment">// 上层协议类型 (2字节)</span><br>    <span class="hljs-comment">// 后面是数据（46-1500字节）</span><br>    <span class="hljs-comment">// 最后是CRC校验（4字节）</span><br>&#125; __attribute__((packed));<br><br><span class="hljs-comment">// 关键字段解释：</span><br><span class="hljs-comment">// MAC地址：00:11:22:33:44:55</span><br><span class="hljs-comment">//   - 前3字节：厂商标识（OUI）</span><br><span class="hljs-comment">//   - 后3字节：设备序列号</span><br><span class="hljs-comment">//   - 全球唯一（理论上）</span><br><br><span class="hljs-comment">// 协议类型：</span><br><span class="hljs-comment">// 0x0800: IPv4</span><br><span class="hljs-comment">// 0x0806: ARP</span><br><span class="hljs-comment">// 0x86DD: IPv6</span><br><span class="hljs-comment">// 0x8100: VLAN标签</span><br><br></code></pre></td></tr></table></figure>
<p>2.2 MAC地址详解</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 查看本机MAC地址</span><br>$ ip <span class="hljs-built_in">link</span> show eth0<br>2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP mode DEFAULT group default qlen 1000<br>    <span class="hljs-built_in">link</span>/ether 00:11:22:33:44:55 brd ff:ff:ff:ff:ff:ff<br><br><span class="hljs-comment"># MAC地址类型：</span><br>00:11:22:33:44:55    <span class="hljs-comment"># 单播地址（发给特定设备）</span><br>ff:ff:ff:ff:ff:ff    <span class="hljs-comment"># 广播地址（发给所有设备）</span><br>01:00:5e:xx:xx:xx    <span class="hljs-comment"># 多播地址（发给一组设备）</span><br><br><span class="hljs-comment"># MAC地址由IEEE分配：</span><br>00:11:22              <span class="hljs-comment"># 可能是Intel网卡</span><br>00:50:56              <span class="hljs-comment"># VMware虚拟网卡</span><br>08:00:27              <span class="hljs-comment"># VirtualBox虚拟网卡</span><br><br></code></pre></td></tr></table></figure>
<h2 id="三-交换机链路层的智能中枢"><a href="#三-交换机链路层的智能中枢" class="headerlink" title="三-交换机链路层的智能中枢"></a><a class="markdownIt-Anchor" href="#三-交换机链路层的智能中枢"></a> 三、交换机：链路层的智能中枢</h2>
<p>3.1 交换机如何工作</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// 交换机维护一个MAC地址表</span><br><span class="hljs-comment">// 记录：哪个MAC地址在哪个端口</span><br><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">mac_table_entry</span> &#123;</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> mac[ETH_ALEN];  <span class="hljs-comment">// MAC地址</span><br>    <span class="hljs-type">int</span> port;                     <span class="hljs-comment">// 端口号</span><br>    <span class="hljs-type">time_t</span> timestamp;             <span class="hljs-comment">// 上次看到的时间</span><br>&#125;;<br><br><span class="hljs-comment">// 交换机工作流程：</span><br><span class="hljs-number">1.</span> 学习：收到帧时，记录源MAC和入口端口<br><span class="hljs-number">2.</span> 转发：查看目标MAC，查表决定出口端口<br><span class="hljs-number">3.</span> 广播：如果MAC不在表中，向所有端口转发（除入口）<br><br><span class="hljs-comment">// 示例：</span><br>端口<span class="hljs-number">1</span>收到：源MAC=AA:BB:CC:DD:EE:FF，目标MAC=<span class="hljs-number">00</span>:<span class="hljs-number">11</span>:<span class="hljs-number">22</span>:<span class="hljs-number">33</span>:<span class="hljs-number">44</span>:<span class="hljs-number">55</span><br><span class="hljs-number">1.</span> 学习：AA:BB:CC:DD:EE:FF在端口<span class="hljs-number">1</span><br><span class="hljs-number">2.</span> 查表：<span class="hljs-number">00</span>:<span class="hljs-number">11</span>:<span class="hljs-number">22</span>:<span class="hljs-number">33</span>:<span class="hljs-number">44</span>:<span class="hljs-number">55</span>在端口<span class="hljs-number">3</span><br><span class="hljs-number">3.</span> 转发：只从端口<span class="hljs-number">3</span>转发出去<br><br><span class="hljs-comment">// 如果目标MAC是广播地址ff:ff:ff:ff:ff:ff</span><br><span class="hljs-comment">// 则向所有端口转发（泛洪）</span><br><br></code></pre></td></tr></table></figure>
<p>3.2 交换机的三种转发方式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">1. 存储转发（最常用）<br>   - 接收完整帧<br>   - 检查CRC错误<br>   - 查表转发<br>   - 延迟较大，但可靠<br><br>2. 直通交换<br>   - 收到目标MAC就开始转发<br>   - 延迟小，但可能转发错误帧<br><br>3. 无碎片交换<br>   - 收到前64字节（避免冲突碎片）后转发<br>   - 平衡了延迟和可靠性<br><br></code></pre></td></tr></table></figure>
<h2 id="四-无线网络wi-fi的链路层"><a href="#四-无线网络wi-fi的链路层" class="headerlink" title="四-无线网络wi-fi的链路层"></a><a class="markdownIt-Anchor" href="#四-无线网络wi-fi的链路层"></a> 四、无线网络（Wi-Fi）的链路层</h2>
<p>4.1 802.11帧结构</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// 无线帧比以太网帧复杂很多</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">ieee80211_hdr</span> &#123;</span><br>    __le16 frame_control;     <span class="hljs-comment">// 帧控制字段</span><br>    __le16 duration_id;       <span class="hljs-comment">// 持续时间/ID</span><br>    u8 addr1[<span class="hljs-number">6</span>];             <span class="hljs-comment">// 接收方地址</span><br>    u8 addr2[<span class="hljs-number">6</span>];             <span class="hljs-comment">// 发送方地址</span><br>    u8 addr3[<span class="hljs-number">6</span>];             <span class="hljs-comment">// 过滤地址（通常BSSID）</span><br>    __le16 seq_ctrl;          <span class="hljs-comment">// 序列控制</span><br>    <span class="hljs-comment">// 可选：地址4、QoS控制等</span><br>    <span class="hljs-comment">// 然后是帧主体</span><br>&#125;;<br><br><span class="hljs-comment">// 无线网络的特殊问题：</span><br><span class="hljs-comment">// 1. 共享介质：大家用同一频率，会冲突</span><br><span class="hljs-comment">// 2. 隐藏节点：A和C都能和B通信，但彼此听不到</span><br><span class="hljs-comment">// 3. 信号衰减：距离远了信号弱</span><br><br></code></pre></td></tr></table></figure>
<p>4.2 CSMA/CA：避免冲突的机制</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// 有线以太网用CSMA/CD：冲突检测</span><br><span class="hljs-comment">// 无线用CSMA/CA：冲突避免（因为难以检测冲突）</span><br><br><span class="hljs-comment">// CSMA/CA流程：</span><br><span class="hljs-number">1.</span> 监听信道：如果忙，等待随机时间再试<br><span class="hljs-number">2.</span> 发送RTS：请求发送（可选）<br><span class="hljs-number">3.</span> 等待CTS：清除发送（可选）<br><span class="hljs-number">4.</span> 发送数据<br><span class="hljs-number">5.</span> 等待ACK：接收方确认收到<br><br><span class="hljs-comment">// RTS/CTS解决隐藏节点问题：</span><br><span class="hljs-comment">// A想发给B，但C在附近也在发</span><br><span class="hljs-comment">// A发RTS，B回CTS，C听到CTS就知道信道被占用了</span><br><br></code></pre></td></tr></table></figure>
<h2 id="五-arp协议再深入"><a href="#五-arp协议再深入" class="headerlink" title="五-arp协议再深入"></a><a class="markdownIt-Anchor" href="#五-arp协议再深入"></a> 五、ARP协议再深入</h2>
<p>5.1 ARP完整流程</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// 情景：你的电脑(192.168.1.100)想访问路由器(192.168.1.1)</span><br><br><span class="hljs-comment">// 步骤1：查ARP缓存</span><br>$ arp -a<br>? (<span class="hljs-number">192.168</span>.<span class="hljs-number">1.1</span>) at <span class="hljs-number">00</span>:<span class="hljs-number">11</span>:<span class="hljs-number">22</span>:<span class="hljs-number">33</span>:<span class="hljs-number">44</span>:<span class="hljs-number">55</span> [ether] on eth0<br><span class="hljs-comment">// 如果有，直接使用MAC地址</span><br><br><span class="hljs-comment">// 步骤2：如果没有，发送ARP请求</span><br><span class="hljs-comment">// 以太网帧：</span><br>目标MAC: ff:ff:ff:ff:ff:ff (广播)<br>源MAC: aa:bb:cc:dd:ee:ff<br>协议类型: <span class="hljs-number">0x0806</span> (ARP)<br>数据: <span class="hljs-string">&quot;谁的IP是192.168.1.1？告诉192.168.1.100&quot;</span><br><br><span class="hljs-comment">// 步骤3：路由器回复</span><br>目标MAC: aa:bb:cc:dd:ee:ff (你的电脑)<br>源MAC: <span class="hljs-number">00</span>:<span class="hljs-number">11</span>:<span class="hljs-number">22</span>:<span class="hljs-number">33</span>:<span class="hljs-number">44</span>:<span class="hljs-number">55</span> (路由器)<br>数据: <span class="hljs-string">&quot;我是192.168.1.1，MAC是00:11:22:33:44:55&quot;</span><br><br><span class="hljs-comment">// 步骤4：更新ARP缓存</span><br><span class="hljs-comment">// 现在知道192.168.1.1的MAC了</span><br><br></code></pre></td></tr></table></figure>
<p>5.2 ARP攻击与防御</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// ARP欺骗（中间人攻击）：</span><br><span class="hljs-comment">// 攻击者发送虚假ARP响应：</span><br><span class="hljs-comment">// &quot;我是192.168.1.1，MAC是攻击者的MAC&quot;</span><br><span class="hljs-comment">// 结果：你的流量都经过攻击者</span><br><br><span class="hljs-comment">// 防御：</span><br><span class="hljs-comment">// 1. 静态ARP条目（手动绑定）</span><br>$ arp -s <span class="hljs-number">192.168</span>.<span class="hljs-number">1.1</span> <span class="hljs-number">00</span>:<span class="hljs-number">11</span>:<span class="hljs-number">22</span>:<span class="hljs-number">33</span>:<span class="hljs-number">44</span>:<span class="hljs-number">55</span><br><br><span class="hljs-comment">// 2. ARP监控软件</span><br><span class="hljs-comment">// 检测异常的ARP活动</span><br><br><span class="hljs-comment">// 3. 交换机安全特性</span><br><span class="hljs-comment">// 端口安全：每个端口只允许特定MAC</span><br><span class="hljs-comment">// DHCP监听：防止虚假DHCP服务器</span><br><br></code></pre></td></tr></table></figure>
<h2 id="六-vlan虚拟局域网"><a href="#六-vlan虚拟局域网" class="headerlink" title="六-vlan虚拟局域网"></a><a class="markdownIt-Anchor" href="#六-vlan虚拟局域网"></a> 六、VLAN：虚拟局域网</h2>
<p>6.1 VLAN的作用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">问题：大型公司有多个部门，都在一个物理网络<br>      - 财务部数据能被工程部看到<br>      - 广播风暴影响所有部门<br><br>解决方案：VLAN<br>物理上一个交换机，逻辑上分成多个虚拟交换机<br><br></code></pre></td></tr></table></figure>
<p>6.2 VLAN帧格式</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// 带VLAN标签的以太网帧</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">vlan_ethhdr</span> &#123;</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> h_dest[ETH_ALEN];<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> h_source[ETH_ALEN];<br>    __be16 h_vlan_proto;      <span class="hljs-comment">// 固定0x8100</span><br>    __be16 h_vlan_TCI;        <span class="hljs-comment">// VLAN标签信息</span><br>    __be16 h_vlan_encapsulated_proto;  <span class="hljs-comment">// 上层协议</span><br>    <span class="hljs-comment">// 数据...</span><br>&#125;;<br><br><span class="hljs-comment">// VLAN TCI字段：</span><br><span class="hljs-comment">// - PCP (3位): 优先级</span><br><span class="hljs-comment">// - DEI (1位): 丢弃资格指示</span><br><span class="hljs-comment">// - VID (12位): VLAN ID (1-4094)</span><br><br><span class="hljs-comment">// 示例：</span><br>VLAN <span class="hljs-number">10</span>：财务部 (<span class="hljs-number">192.168</span>.<span class="hljs-number">10.0</span>/<span class="hljs-number">24</span>)<br>VLAN <span class="hljs-number">20</span>：工程部 (<span class="hljs-number">192.168</span>.<span class="hljs-number">20.0</span>/<span class="hljs-number">24</span>)<br>VLAN <span class="hljs-number">30</span>：访客网络 (<span class="hljs-number">192.168</span>.<span class="hljs-number">30.0</span>/<span class="hljs-number">24</span>)<br><br><span class="hljs-comment">// 即使物理连接同一交换机，不同VLAN不能直接通信</span><br><span class="hljs-comment">// 需要路由器（或三层交换机）在VLAN间转发</span><br></code></pre></td></tr></table></figure>
<h1 id="物理层"><a href="#物理层" class="headerlink" title="物理层"></a><a class="markdownIt-Anchor" href="#物理层"></a> 物理层</h1>
<h2 id="一-物理层是干什么的"><a href="#一-物理层是干什么的" class="headerlink" title="一-物理层是干什么的"></a><a class="markdownIt-Anchor" href="#一-物理层是干什么的"></a> 一、物理层是干什么的？</h2>
<p>1.1 核心职责：把0和1变成物理信号</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">上层看到的是：0 1 0 1 0 1<br>物理层看到的是：<br>- 网线：高电压(1) 低电压(0) 高电压(1)<br>- 光纤：亮(1) 灭(0) 亮(1)<br>- 无线电：特定频率(1) 另一频率(0)<br><br>物理层不关心：<br>- 数据是什么意思<br>- 数据要发给谁<br>- 数据是否正确<br><br>它只关心：怎么可靠地传输比特<br><br></code></pre></td></tr></table></figure>
<p>1.2 物理层的两大任务</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">1. 编码：把比特变成信号<br>   计算机：0101<br>   物理层：高高低高高高低高（电压变化）<br><br>2. 传输：把信号送到对面<br>   通过：铜线、光纤、空气（无线）<br><br></code></pre></td></tr></table></figure>
<h2 id="二-有线传输看得见的物理层"><a href="#二-有线传输看得见的物理层" class="headerlink" title="二-有线传输看得见的物理层"></a><a class="markdownIt-Anchor" href="#二-有线传输看得见的物理层"></a> 二、有线传输：看得见的物理层</h2>
<p>2.1 以太网电缆（双绞线）</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// 常见的网线：Cat5e、Cat6、Cat7</span><br><span class="hljs-comment">// 8根线分成4对，每对双绞（减少干扰）</span><br><br><span class="hljs-comment">// 引脚定义（T568B标准）：</span><br>引脚  颜色      用途<br><span class="hljs-number">1</span>    白橙       TX+ (发送正)<br><span class="hljs-number">2</span>    橙         TX- (发送负)<br><span class="hljs-number">3</span>    白绿       RX+ (接收正)<br><span class="hljs-number">6</span>    绿         RX- (接收负)<br><span class="hljs-number">4</span>    蓝         (有时用于电话)<br><span class="hljs-number">5</span>    白蓝<br><span class="hljs-number">7</span>    白棕<br><span class="hljs-number">8</span>    棕<br><br><span class="hljs-comment">// 为什么双绞？</span><br><span class="hljs-comment">// 每对线互相缠绕，外部干扰会同时影响两根线</span><br><span class="hljs-comment">// 接收方比较两根线的差值，抵消干扰</span><br><br><span class="hljs-comment">// 水晶头（RJ45）连接：</span><br><span class="hljs-number">1.</span> 剥开外皮，理直<span class="hljs-number">8</span>根线<br><span class="hljs-number">2.</span> 按顺序排好：白橙、橙、白绿、蓝、白蓝、绿、白棕、棕<br><span class="hljs-number">3.</span> 剪齐，插入水晶头<br><span class="hljs-number">4.</span> 用压线钳压紧<br><br></code></pre></td></tr></table></figure>
<p>2.2 编码技术：如何表示0和1</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// 曼彻斯特编码（旧以太网用）</span><br><span class="hljs-comment">// 每个比特中间都有跳变</span><br><span class="hljs-comment">// 0：高→低跳变</span><br><span class="hljs-comment">// 1：低→高跳变</span><br><br><span class="hljs-comment">// 示例：</span><br>数据： <span class="hljs-number">0</span>   <span class="hljs-number">1</span>   <span class="hljs-number">0</span>   <span class="hljs-number">1</span>   <span class="hljs-number">0</span><br>信号：高→低 低→高 高→低 低→高 高→低<br>      |___| |___| |___| |___| |___|<br><br><span class="hljs-comment">// 优点：自带时钟，接收方容易同步</span><br><span class="hljs-comment">// 缺点：效率只有50%（每个比特都有跳变）</span><br><br><span class="hljs-comment">// 4B/5B编码（更快以太网用）</span><br><span class="hljs-comment">// 每4个数据比特映射为5个传输比特</span><br><span class="hljs-comment">// 保证至少有2次跳变，保持同步</span><br><span class="hljs-comment">// 效率：80%</span><br><br><span class="hljs-comment">// 8B/10B编码（千兆以太网）</span><br><span class="hljs-comment">// 每8比特映射为10比特</span><br><span class="hljs-comment">// 平衡0和1的数量（直流平衡）</span><br><br></code></pre></td></tr></table></figure>
<p>2.3 物理层设备：中继器和集线器</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// 中继器（Repeater）：</span><br><span class="hljs-comment">// 功能：放大信号，延长传输距离</span><br><span class="hljs-comment">// 问题：也放大噪声</span><br><span class="hljs-comment">// 现代基本不用，被交换机取代</span><br><br><span class="hljs-comment">// 集线器（Hub）：</span><br><span class="hljs-comment">// 多端口中继器</span><br><span class="hljs-comment">// 收到信号 → 放大 → 转发给所有其他端口</span><br><span class="hljs-comment">// 工作在物理层，没有智能</span><br><br><span class="hljs-comment">// 集线器的问题：</span><br><span class="hljs-comment">// 1. 所有设备共享带宽（10Mbps集线器，4个设备，每个最多2.5Mbps）</span><br><span class="hljs-comment">// 2. 冲突域大：一个设备发数据，其他都要等</span><br><span class="hljs-comment">// 3. 不安全：所有设备看到所有数据</span><br><br></code></pre></td></tr></table></figure>
<h2 id="三-无线传输看不见的物理层"><a href="#三-无线传输看不见的物理层" class="headerlink" title="三-无线传输看不见的物理层"></a><a class="markdownIt-Anchor" href="#三-无线传输看不见的物理层"></a> 三、无线传输：看不见的物理层</h2>
<p>3.1 Wi-Fi无线电基础</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// 无线网络在特定频率工作</span><br><span class="hljs-comment">// 2.4GHz频段：</span><br><span class="hljs-comment">// 信道1：2.412 GHz</span><br><span class="hljs-comment">// 信道6：2.437 GHz</span><br><span class="hljs-comment">// 信道11：2.462 GHz</span><br><span class="hljs-comment">// （中国有13个信道，美国11个）</span><br><br><span class="hljs-comment">// 5GHz频段：</span><br><span class="hljs-comment">// 更多信道，更少干扰，但穿透力差</span><br><br><span class="hljs-comment">// 调制技术：把数据加载到无线电波上</span><br><span class="hljs-comment">// 1. BPSK：1比特/符号（最慢，最可靠）</span><br><span class="hljs-comment">// 2. QPSK：2比特/符号</span><br><span class="hljs-comment">// 3. 16-QAM：4比特/符号</span><br><span class="hljs-comment">// 4. 64-QAM：6比特/符号（最快，需要好信号）</span><br><span class="hljs-comment">// 5. 256-QAM：8比特/符号（Wi-Fi 6）</span><br><br><span class="hljs-comment">// MIMO（多输入多输出）：</span><br><span class="hljs-comment">// 多个天线同时收发，提高速度和可靠性</span><br><br></code></pre></td></tr></table></figure>
<p>3.2 无线信号特性</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 无线信号随距离衰减（自由空间路径损耗）</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">path_loss</span>(<span class="hljs-params">distance, frequency</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    distance: 距离（米）</span><br><span class="hljs-string">    frequency: 频率（Hz）</span><br><span class="hljs-string">    返回：路径损耗（dB）</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-comment"># 公式：PL = 20*log10(d) + 20*log10(f) + 20*log10(4π/c) - Gt - Gr</span><br>    <span class="hljs-comment"># 简化：每倍距离增加6dB损耗</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">20</span> * math.log10(distance) + <span class="hljs-number">20</span> * math.log10(frequency) + <span class="hljs-number">147.55</span><br><br><span class="hljs-comment"># 示例：2.4GHz Wi-Fi，10米距离</span><br>loss = path_loss(<span class="hljs-number">10</span>, <span class="hljs-number">2.4e9</span>)  <span class="hljs-comment"># 约60dB损耗</span><br><br><span class="hljs-comment"># 障碍物影响：</span><br><span class="hljs-comment"># 墙壁：3-10dB损耗</span><br><span class="hljs-comment"># 地板：10-20dB损耗</span><br><span class="hljs-comment"># 金属：完全阻挡</span><br><br></code></pre></td></tr></table></figure>
<h2 id="四-光纤传输光速的物理层"><a href="#四-光纤传输光速的物理层" class="headerlink" title="四-光纤传输光速的物理层"></a><a class="markdownIt-Anchor" href="#四-光纤传输光速的物理层"></a> 四、光纤传输：光速的物理层</h2>
<p>4.1 光纤原理</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// 光纤结构：</span><br><span class="hljs-comment">// 核心：高折射率玻璃（直径9-62.5微米）</span><br><span class="hljs-comment">// 包层：低折射率玻璃</span><br><span class="hljs-comment">// 涂覆层：保护层</span><br><br><span class="hljs-comment">// 工作原理：全内反射</span><br><span class="hljs-comment">// 光在核心内反射前进，不会漏出</span><br><br><span class="hljs-comment">// 两种类型：</span><br><span class="hljs-comment">// 1. 多模光纤（MMF）：</span><br><span class="hljs-comment">//    - 核心较粗（50或62.5微米）</span><br><span class="hljs-comment">//    - 光有多种路径（模式）</span><br><span class="hljs-comment">//    - 距离短（500米以内）</span><br><span class="hljs-comment">//    - 便宜，用于局域网</span><br><br><span class="hljs-comment">// 2. 单模光纤（SMF）：</span><br><span class="hljs-comment">//    - 核心很细（9微米）</span><br><span class="hljs-comment">//    - 光只有一种路径</span><br><span class="hljs-comment">//    - 距离长（数十公里）</span><br><span class="hljs-comment">//    - 贵，用于长途通信</span><br><br></code></pre></td></tr></table></figure>
<p>4.2 光传输系统</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// 光通信组件：</span><br><span class="hljs-comment">// 1. 光源：激光二极管或LED</span><br><span class="hljs-comment">//    - 激光：相干光，适合单模长距离</span><br><span class="hljs-comment">//    - LED：非相干光，适合多模短距离</span><br><br><span class="hljs-comment">// 2. 调制：直接调制或外调制</span><br><span class="hljs-comment">//    - 直接：改变驱动电流改变光强</span><br><span class="hljs-comment">//    - 外调制：恒定光源+外部调制器（更高速）</span><br><br><span class="hljs-comment">// 3. 光纤：传输介质</span><br><br><span class="hljs-comment">// 4. 探测器：光电二极管</span><br><span class="hljs-comment">//    - PIN光电二极管：普通速度</span><br><span class="hljs-comment">//    - 雪崩光电二极管（APD）：高灵敏度</span><br><br><span class="hljs-comment">// 波分复用（WDM）：</span><br><span class="hljs-comment">// 一根光纤传输多个波长（颜色）的光</span><br><span class="hljs-comment">// 提高容量：160个波长 × 100Gbps = 16Tbps</span><br><br></code></pre></td></tr></table></figure>
<h2 id="五-物理层标准与速率"><a href="#五-物理层标准与速率" class="headerlink" title="五-物理层标准与速率"></a><a class="markdownIt-Anchor" href="#五-物理层标准与速率"></a> 五、物理层标准与速率</h2>
<p>5.1 以太网物理层标准</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 常见以太网标准：</span><br>10BASE-T:   10 Mbps, 双绞线, 100米<br>100BASE-TX: 100 Mbps, Cat5双绞线, 100米   <span class="hljs-comment"># 快速以太网</span><br>1000BASE-T: 1 Gbps, Cat5e双绞线, 100米    <span class="hljs-comment"># 千兆以太网</span><br>10GBASE-T:  10 Gbps, Cat6a双绞线, 100米   <span class="hljs-comment"># 万兆以太网</span><br><br><span class="hljs-comment"># 光纤标准：</span><br>1000BASE-SX: 1 Gbps, 多模光纤, 550米（850nm波长）<br>1000BASE-LX: 1 Gbps, 单模光纤, 5公里（1310nm波长）<br>10GBASE-SR:  10 Gbps, 多模光纤, 300米<br>10GBASE-LR:  10 Gbps, 单模光纤, 10公里<br>100GBASE-SR4: 100 Gbps, 多模光纤, 100米（并行4光纤）<br><br><span class="hljs-comment"># 命名规则：</span><br>- 10/100/1000：速率 Mbps<br>- BASE：基带传输（数字信号）<br>- T：双绞线，S：短波，L：长波，X：特殊编码<br><br></code></pre></td></tr></table></figure>
<p>5.2 Wi-Fi物理层标准</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># IEEE 802.11系列：</span><br>802.11b: 2.4GHz, 最大11 Mbps (1999)<br>802.11a: 5GHz, 最大54 Mbps (1999)<br>802.11g: 2.4GHz, 最大54 Mbps (2003)<br>802.11n: 2.4/5GHz, 最大600 Mbps (2009)  <span class="hljs-comment"># Wi-Fi 4</span><br>802.11ac: 5GHz, 最大6.9 Gbps (2014)      <span class="hljs-comment"># Wi-Fi 5</span><br>802.11ax: 2.4/5/6GHz, 最大9.6 Gbps (2019) <span class="hljs-comment"># Wi-Fi 6</span><br>802.11be: 即将发布，Wi-Fi 7，最大30 Gbps<br><br><span class="hljs-comment"># 实际速度：</span><br>标称速度 ≠ 实际速度<br>- 802.11ac 1300Mbps → 实际约500-800Mbps<br>- 802.11ax 2400Mbps → 实际约800-1200Mbps<br><span class="hljs-comment"># 原因：协议开销、信号干扰、共享介质</span><br><br></code></pre></td></tr></table></figure>
<h2 id="六-物理层的关键问题与解决方案"><a href="#六-物理层的关键问题与解决方案" class="headerlink" title="六-物理层的关键问题与解决方案"></a><a class="markdownIt-Anchor" href="#六-物理层的关键问题与解决方案"></a> 六、物理层的关键问题与解决方案</h2>
<p>6.1 信号衰减与失真</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// 问题1：信号随距离衰减</span><br><span class="hljs-comment">// 解决方案：中继器/放大器</span><br><br><span class="hljs-comment">// 问题2：码间干扰（ISI）</span><br><span class="hljs-comment">// 一个信号位影响下一个位</span><br><span class="hljs-comment">// 原因：带宽有限，信号展宽</span><br><span class="hljs-comment">// 解决方案：</span><br><span class="hljs-comment">// 1. 均衡器：补偿频率响应</span><br><span class="hljs-comment">// 2. 更好的编码：减少高频分量</span><br><br><span class="hljs-comment">// 问题3：时钟同步</span><br><span class="hljs-comment">// 发送方和接收方时钟有微小差异</span><br><span class="hljs-comment">// 解决方案：</span><br><span class="hljs-comment">// 1. 曼彻斯特编码：自带时钟</span><br><span class="hljs-comment">// 2. 锁相环（PLL）：从数据流提取时钟</span><br><span class="hljs-comment">// 3. 弹性缓冲区：容忍微小差异</span><br><br></code></pre></td></tr></table></figure>
<p>6.2 错误检测与纠正</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// 物理层不纠正错误（那是上层的事）</span><br><span class="hljs-comment">// 但可以检测错误并标记</span><br><br><span class="hljs-comment">// 常见技术：</span><br><span class="hljs-comment">// 1. 奇偶校验：1位错误检测，不能纠正</span><br><span class="hljs-comment">//    偶校验：数据中1的个数为偶数，校验位=0</span><br><span class="hljs-comment">//    奇校验：数据中1的个数为奇数，校验位=1</span><br><br><span class="hljs-comment">// 2. CRC（循环冗余校验）：以太网用</span><br><span class="hljs-comment">//    发送方：数据 ÷ 生成多项式 = 余数，附加余数</span><br><span class="hljs-comment">//    接收方：（数据+余数）÷ 生成多项式，应该余0</span><br><span class="hljs-comment">//    能检测多位错误</span><br><br><span class="hljs-comment">// 物理层发现错误 → 丢弃帧 → 上层重传</span><br></code></pre></td></tr></table></figure>
<div id="paginator"></div></div><div id="post-footer"><div id="pages"><div class="footer-link" style="width: 50%;text-align:right;border-right:1px #fe2 solid"><a href="/2026/02/27/Database/">← Next DB-notes</a></div><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2026/02/27/linux%E6%8C%87%E4%BB%A4-shell%E8%84%9A%E6%9C%AC/">linux指令&amp;shell脚本 Prev →</a></div></div></div><details id="reward"><summary>reward</summary><div><span>微信 | Wechat</span><br><img src="/images/WeChat.png"></div><div><span>支付宝 | Alipay</span><br><img src="/images/Alipay.png"></div></details><div id="comments"><div id="giscus"></div></div></div><div class="bottom-btn"><div><a class="i-top" id="to-top" onClick="scrolls.scrolltop();" title="To Top" style="opacity: 0; display: none;">∧ </a><a class="i-index" id="to-index" onClick="tocControl.change()" title="To Catalog"><span class="tocBtnIconBar"></span><span class="tocBtnIconBar"></span><span class="tocBtnIconBar"></span></a><a class="i-color" id="color-mode" onClick="colorMode.change()" title="Change Theme"></a><a onclick="BgmControl()"><svg id="bgm-control" viewBox="0 0 30 34" fill="#18d1ff" style="width: 24px; transition: transform .3s;margin-top: 4px"><path d="M25.998 23.422V11.29h3.999v12.132h-3.999zM19.497 6.234h4.001v22.243h-4.001V6.234zM12.998.867h4v32.978h-4V.867zm-6.5 5.367h4.001v22.243H6.498V6.234zm-6.5 5.056h4v12.132h-4V11.29z"></path></svg><audio id="bgm" src="/audio/bgm.mp3" autoplay loop crossorigin="anonymous"> </audio></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="/images/1.jpg" alt="Logo" style="margin:0;border-radius:0;"></a><h1 id="Dr"><a href="/">Lnk</a></h1><div id="description"><p></p></div><div id="social-links"><a class="social" target="_blank" rel="noopener" href="https://github.com/Lnkqwq"><i class="fab fa-github" alt="GitHub"></i></a><a class="social" href="3403583728@qq.com"><i class="fa fa-envelope" alt="E-Mail"></i></a></div></div><div id="aside-block"><div id="toc-div"><h1>Catalog</h1><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%B1%82"><span class="toc-number">1.</span> <span class="toc-text"> 应用层</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-%E5%BA%94%E7%94%A8%E5%B1%82%E6%98%AF%E5%B9%B2%E4%BB%80%E4%B9%88%E7%9A%84"><span class="toc-number">1.1.</span> <span class="toc-text"> 一、应用层是干什么的？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-%E5%BA%94%E7%94%A8%E5%B1%82%E5%8D%8F%E8%AE%AE%E5%AE%B6%E6%97%8F"><span class="toc-number">1.2.</span> <span class="toc-text"> 二、应用层协议家族</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89-%E7%8E%B0%E4%BB%A3%E5%BA%94%E7%94%A8%E5%B1%82%E4%B8%8D%E4%BB%85%E4%BB%85%E6%98%AF%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.3.</span> <span class="toc-text"> 三、现代应用层：不仅仅是协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B-%E5%BA%94%E7%94%A8%E5%B1%82%E7%9A%84%E5%AE%89%E5%85%A8%E8%80%83%E8%99%91"><span class="toc-number">1.4.</span> <span class="toc-text"> 四、应用层的安全考虑</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BC%A0%E8%BE%93%E5%B1%82"><span class="toc-number">2.</span> <span class="toc-text"> 传输层</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-%E4%BC%A0%E8%BE%93%E5%B1%82%E6%98%AF%E5%B9%B2%E4%BB%80%E4%B9%88%E7%9A%84"><span class="toc-number">2.1.</span> <span class="toc-text"> 一、传输层是干什么的？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-tcp%E6%B7%B1%E5%BA%A6%E8%A7%A3%E6%9E%90%E5%8F%AF%E9%9D%A0%E7%9A%84%E8%BF%9E%E6%8E%A5"><span class="toc-number">2.2.</span> <span class="toc-text"> 二、TCP深度解析：可靠的连接</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89-udp%E6%B7%B1%E5%BA%A6%E8%A7%A3%E6%9E%90%E7%AE%80%E5%8D%95%E7%9A%84%E6%95%B0%E6%8D%AE%E6%8A%A5"><span class="toc-number">2.2.1.</span> <span class="toc-text"> 三、UDP深度解析：简单的数据报</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%B1%82"><span class="toc-number">3.</span> <span class="toc-text"> 网络层</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-%E7%BD%91%E7%BB%9C%E5%B1%82%E6%98%AF%E5%B9%B2%E4%BB%80%E4%B9%88%E7%9A%84"><span class="toc-number">3.1.</span> <span class="toc-text"> 一、网络层是干什么的？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-ip%E5%8D%8F%E8%AE%AE%E8%AF%A6%E8%A7%A3"><span class="toc-number">3.2.</span> <span class="toc-text"> 二、IP协议详解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89-%E8%B7%AF%E7%94%B1%E4%BA%92%E8%81%94%E7%BD%91%E7%9A%84%E5%AF%BC%E8%88%AA%E7%B3%BB%E7%BB%9F"><span class="toc-number">3.3.</span> <span class="toc-text"> 三、路由：互联网的导航系统</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B-%E7%9B%B8%E5%85%B3%E5%8D%8F%E8%AE%AE"><span class="toc-number">3.4.</span> <span class="toc-text"> 四、相关协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94-ipv6%E4%B8%8B%E4%B8%80%E4%BB%A3ip%E5%8D%8F%E8%AE%AE"><span class="toc-number">3.5.</span> <span class="toc-text"> 五、IPv6：下一代IP协议</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%93%BE%E8%B7%AF%E5%B1%82"><span class="toc-number">4.</span> <span class="toc-text"> 链路层</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-%E9%93%BE%E8%B7%AF%E5%B1%82%E6%98%AF%E5%B9%B2%E4%BB%80%E4%B9%88%E7%9A%84"><span class="toc-number">4.1.</span> <span class="toc-text"> 一、链路层是干什么的？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-%E4%BB%A5%E5%A4%AA%E7%BD%91%E6%9C%80%E4%B8%BB%E6%B5%81%E7%9A%84%E9%93%BE%E8%B7%AF%E5%B1%82%E5%8D%8F%E8%AE%AE"><span class="toc-number">4.2.</span> <span class="toc-text"> 二、以太网：最主流的链路层协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E9%93%BE%E8%B7%AF%E5%B1%82%E7%9A%84%E6%99%BA%E8%83%BD%E4%B8%AD%E6%9E%A2"><span class="toc-number">4.3.</span> <span class="toc-text"> 三、交换机：链路层的智能中枢</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B-%E6%97%A0%E7%BA%BF%E7%BD%91%E7%BB%9Cwi-fi%E7%9A%84%E9%93%BE%E8%B7%AF%E5%B1%82"><span class="toc-number">4.4.</span> <span class="toc-text"> 四、无线网络（Wi-Fi）的链路层</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94-arp%E5%8D%8F%E8%AE%AE%E5%86%8D%E6%B7%B1%E5%85%A5"><span class="toc-number">4.5.</span> <span class="toc-text"> 五、ARP协议再深入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD-vlan%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91"><span class="toc-number">4.6.</span> <span class="toc-text"> 六、VLAN：虚拟局域网</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%89%A9%E7%90%86%E5%B1%82"><span class="toc-number">5.</span> <span class="toc-text"> 物理层</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-%E7%89%A9%E7%90%86%E5%B1%82%E6%98%AF%E5%B9%B2%E4%BB%80%E4%B9%88%E7%9A%84"><span class="toc-number">5.1.</span> <span class="toc-text"> 一、物理层是干什么的？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-%E6%9C%89%E7%BA%BF%E4%BC%A0%E8%BE%93%E7%9C%8B%E5%BE%97%E8%A7%81%E7%9A%84%E7%89%A9%E7%90%86%E5%B1%82"><span class="toc-number">5.2.</span> <span class="toc-text"> 二、有线传输：看得见的物理层</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89-%E6%97%A0%E7%BA%BF%E4%BC%A0%E8%BE%93%E7%9C%8B%E4%B8%8D%E8%A7%81%E7%9A%84%E7%89%A9%E7%90%86%E5%B1%82"><span class="toc-number">5.3.</span> <span class="toc-text"> 三、无线传输：看不见的物理层</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B-%E5%85%89%E7%BA%A4%E4%BC%A0%E8%BE%93%E5%85%89%E9%80%9F%E7%9A%84%E7%89%A9%E7%90%86%E5%B1%82"><span class="toc-number">5.4.</span> <span class="toc-text"> 四、光纤传输：光速的物理层</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94-%E7%89%A9%E7%90%86%E5%B1%82%E6%A0%87%E5%87%86%E4%B8%8E%E9%80%9F%E7%8E%87"><span class="toc-number">5.5.</span> <span class="toc-text"> 五、物理层标准与速率</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD-%E7%89%A9%E7%90%86%E5%B1%82%E7%9A%84%E5%85%B3%E9%94%AE%E9%97%AE%E9%A2%98%E4%B8%8E%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="toc-number">5.6.</span> <span class="toc-text"> 六、物理层的关键问题与解决方案</span></a></li></ol></li></ol></div></div><footer><nobr>Published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr> by <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside></main><canvas id="canvas-dust"></canvas></body></html>